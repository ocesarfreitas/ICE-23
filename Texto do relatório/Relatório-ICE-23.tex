% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames,x11names}{xcolor}
%
\documentclass[
  12,
  dvipsnames]{article}
\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\usepackage{xcolor}
\usepackage[left=3cm, right=2cm, top=3cm, bottom=2cm]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
\usepackage[utf8]{inputenc}
\usepackage{dcolumn}
\usepackage{csquotes}
\usepackage{indentfirst}
\renewcommand{\abstractname}{Resumo}
\renewcommand{\tablename}{Tabela}
\renewcommand{\figurename}{Figura}
\usepackage{microtype}
\usepackage{bookmark}
\usepackage[onehalfspacing]{setspace}
\usepackage{float}
\floatplacement{figure}{H}
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  pdftitle={Relatório Índice das Cidades Empreendedoras 2023},
  pdfauthor={César Freitas; Vítor Borges; Arnaldo},
  colorlinks=true,
  linkcolor={blue},
  filecolor={Maroon},
  citecolor={Blue},
  urlcolor={Blue},
  pdfcreator={LaTeX via pandoc}}

\title{Relatório Índice das Cidades Empreendedoras 2023}
\author{César Freitas \and Vítor Borges \and Arnaldo}
\date{setembro 07, 2022}

\begin{document}
\maketitle
\begin{abstract}
A
\end{abstract}

\renewcommand*\contentsname{Sumário}
{
\hypersetup{linkcolor=}
\setcounter{tocdepth}{3}
\tableofcontents
}
\newpage

\hypertarget{introducao}{%
\section{Introducao}\label{introducao}}

Para a construção do Índice das Cidades Empreendedoras (ICE) de 2023, a
manipulação e tratamento dos dados, bem como o cálculo dos indicadores,
foram feitos em Python, R e SQL. Optou por utilizar diferentes
linguagens de programação a fim de otimizar o trabalho com a base de
dados. Os scripts realizados estão disponíveis tanto no Apêndice deste
relatório quanto em um repositório criado pelos bolsistas, disponível em
\href{https://github.com/ocesarfreitas/ICE-23}{link}.

\hypertarget{determinantes}{%
\section{Determinantes}\label{determinantes}}

\hypertarget{det_amb_regulatorio}{%
\subsection{Determinante Ambiente
Regulatório}\label{det_amb_regulatorio}}

\begin{itemize}
\tightlist
\item
  \protect\hyperlink{script_2.1}{Clique aqui} para ver o script do
  Determinante Ambiente Regulatório.
\end{itemize}

\hypertarget{subdet_tempo_processo}{%
\subsubsection{Subdeterminante Tempo de
Processos}\label{subdet_tempo_processo}}

\begin{itemize}
\tightlist
\item
  \protect\hyperlink{script_2.1.1}{Clique aqui} para ver o script do
  Subdeterminante Tempo de Processos.
\end{itemize}

\hypertarget{indicador_tempo_viabilidade}{%
\paragraph{Indicador Tempo de Viabilidade de
Localização}\label{indicador_tempo_viabilidade}}

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 2\tabcolsep) * \real{0.2700}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 2\tabcolsep) * \real{0.7300}}@{}}
\toprule()
\begin{minipage}[b]{\linewidth}\raggedright
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\textbf{Informações}
\end{minipage} \\
\midrule()
\endhead
\textbf{Fonte} &
\url{https://estatistica.redesim.gov.br/tempos-abertura} \\
\textbf{Período} & 01/2021 \textasciitilde{} 12/2021 \\
\textbf{Cidades faltantes} & São José do Rio Preto (SP), Maringá (PR),
Jundiaí (SP), Anápolis (GO) \\
\textbf{Variável de Interesse} & QTDE. HH VIABILIDADE END \\
\textbf{Efeito} & Negativo \\
\textbf{Problemas com a coleta} & Não \\
\bottomrule()
\end{longtable}

Para o cálculo do indicador foi realizado a partir da média simples das
variável de interesse, \texttt{QTDE.\ HH\ VIABILIDADE\ END}.

\begin{equation}
Tempo\ de\ Viabilidade\ de\ Localização = \frac{\displaystyle\sum_{12}Qtnd.\ Horas\ Viabilidade}{12}
\end{equation}

Em relação à importação dos dados no site da REDESIM, para nenhum dos 12
meses analisados houve problemas quanto aos arquivos importados e a
qualidade dos dados coletados.

\hypertarget{indicador_tempo_registro}{%
\paragraph{Indicador Tempo de Registro, Cadastro e Viabilidade de
Nome}\label{indicador_tempo_registro}}

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 2\tabcolsep) * \real{0.2700}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 2\tabcolsep) * \real{0.7300}}@{}}
\toprule()
\begin{minipage}[b]{\linewidth}\raggedright
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\textbf{Informações}
\end{minipage} \\
\midrule()
\endhead
\textbf{Fonte} &
\url{https://estatistica.redesim.gov.br/tempos-abertura} \\
\textbf{Período} & 01/2021 \textasciitilde{} 12/2021 \\
\textbf{Cidades faltantes} & São José do Rio Preto (SP), Maringá (PR),
Jundiaí (SP), Anápolis (GO) \\
\textbf{Variável de Interesse} & QTDE. HH LIBERAÇÃO DBE \\
\textbf{Efeito} & Negativo \\
\textbf{Problemas com a coleta} & Não \\
\bottomrule()
\end{longtable}

Assim como o anterior, o cálculo do indicador foi realizado a partir da
média simples das variável de interesse,
\texttt{QTDE.\ HH\ LIBERAÇÃO\ DBE}.

\begin{equation}
Tempo\ de\ Registro,\ Cadastro\ e\ Viabilidade\ de\ Nome = \frac{\displaystyle\sum_{12}Qtnd.\ Horas\ Liberação}{12}
\end{equation}

Como a base de dados é a mesma do indicador anterior, os mesmo
comentários são válidos quanto a qualidade e coleta dos dados.

\hypertarget{indicador_congestionamento}{%
\paragraph{Indicador Taxa de Congestionamento em
Tribunais}\label{indicador_congestionamento}}

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 2\tabcolsep) * \real{0.2700}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 2\tabcolsep) * \real{0.7300}}@{}}
\toprule()
\begin{minipage}[b]{\linewidth}\raggedright
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\textbf{Informações}
\end{minipage} \\
\midrule()
\endhead
\textbf{Fonte} &
\url{https://paineis.cnj.jus.br/QvAJAXZfc/opendoc.htm?document=qvw_l\%2FPainelCNJ.qvw\&host=QVS\%40neodimio03\&anonymous=true\&sheet=shPDPrincipal} \\
\textbf{Período} & 01/2021 \textasciitilde{} 12/2021 \\
\textbf{Cidades faltantes} & - \\
\textbf{Efeito} & Negativo \\
\textbf{Problemas com a coleta} & Não \\
\bottomrule()
\end{longtable}

Para a coleta dos dados, ao acessar o painel de Produtividade Mensal da
CNJ, foi selecionado o tópico de \textit{Gráficos Customizados}. Os
parâmetros de pesquisa selecionados foram:

\begin{itemize}
\tightlist
\item
  Justiça: Justiça Estadual
\item
  Campos Agrupados: Sede Município
\item
  Tipo de variável: Novos, Pendentes e Baixados.
\end{itemize}

Com a taxa líquida de congestionamento sendo definida como:

\begin{equation}
  Tx.\ líquida\ de\ congestionamento = \frac{1 - baixados}{novos + pendentes}
\end{equation}

\hypertarget{subdet_tributacao}{%
\subsubsection{Subdeterminante Tributação}\label{subdet_tributacao}}

\begin{itemize}
\tightlist
\item
  \protect\hyperlink{script_2.1.2}{Clique aqui} para ver o script do
  Subdeterminante Tributação.
\end{itemize}

\hypertarget{indicador-aluxedquota-interna-do-icms}{%
\paragraph{Indicador Alíquota Interna do
ICMS}\label{indicador-aluxedquota-interna-do-icms}}

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 2\tabcolsep) * \real{0.3506}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 2\tabcolsep) * \real{0.6494}}@{}}
\toprule()
\begin{minipage}[b]{\linewidth}\raggedright
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\textbf{Informações}
\end{minipage} \\
\midrule()
\endhead
\textbf{Fonte} &
\url{https://siconfi.tesouro.gov.br/siconfi/index.jsf} \\
\textbf{Período} & 01/2021 \textasciitilde{} 12/2021 (Sinconfi), 2018
(PIB) \\
\textbf{Cidades faltantes} & - \\
\textbf{Efeito} & Negativo \\
\textbf{Variável de interesse} & ICMS (Siconfi), PIB Municipal (IBGE) \\
\textbf{Problemas com a coleta} & Não \\
\bottomrule()
\end{longtable}

Foi utilizada a tabela Receitas Orçamentárias (Anexo I-C). Restringindo
o montante das receitas filtrando-as para as `Receitas Brutas
Realizadas'. Com o indicador sendo a razão entre esse montante e o PIB
Municipal\footnote{Utilizamos o \textit{data lake} público 'Base dos dados', disponível em https://basedosdados.org, para importar esse dado.}
de 2018, o mais recente que foi disponibilizado. Além disso, pela
natureza especial da cidade de Brasília (DF), ao invés de usar os dados
municípais, tivemos que utilizar os por estado.

\begin{equation}
  Alíquota\ ICMS = \frac{Receitas\ Brutas\ Realizadas_{ICMS}}{PIB\ Municipal}
\end{equation}

\hypertarget{indicador-aluxedquota-interna-do-iptu}{%
\paragraph{Indicador Alíquota Interna do
IPTU}\label{indicador-aluxedquota-interna-do-iptu}}

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 2\tabcolsep) * \real{0.3506}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 2\tabcolsep) * \real{0.6494}}@{}}
\toprule()
\begin{minipage}[b]{\linewidth}\raggedright
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\textbf{Informações}
\end{minipage} \\
\midrule()
\endhead
\textbf{Fonte} &
\url{https://siconfi.tesouro.gov.br/siconfi/index.jsf} \\
\textbf{Período} & 01/2021 \textasciitilde{} 12/2021 (Sinconfi), 2018
(PIB) \\
\textbf{Cidades faltantes} & - \\
\textbf{Efeito} & Negativo \\
\textbf{Variável de interesse} & IPTU (Siconfi), PIB Municipal (IBGE) \\
\textbf{Problemas com a coleta} & Não \\
\bottomrule()
\end{longtable}

Processo de coleta e tramento análogo ao Indicador Alíquota Interna do
ICMS.

\begin{equation}
  Alíquota\ IPTU = \frac{Receitas\ Brutas\ Realizadas_{IPTU}}{PIB\ Municipal}
\end{equation}

\hypertarget{indicador-aluxedquota-interna-do-iss}{%
\paragraph{Indicador Alíquota Interna do
ISS}\label{indicador-aluxedquota-interna-do-iss}}

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 2\tabcolsep) * \real{0.3506}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 2\tabcolsep) * \real{0.6494}}@{}}
\toprule()
\begin{minipage}[b]{\linewidth}\raggedright
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\textbf{Informações}
\end{minipage} \\
\midrule()
\endhead
\textbf{Fonte} &
\url{https://siconfi.tesouro.gov.br/siconfi/index.jsf} \\
\textbf{Período} & 01/2021 \textasciitilde{} 12/2021 (Sinconfi), 2018
(PIB) \\
\textbf{Cidades faltantes} & Carapicuíba (SP) \\
\textbf{Efeito} & Negativo \\
\textbf{Variável de interesse} & ISS (Siconfi), PIB Municipal (IBGE) \\
\textbf{Problemas com a coleta} & Não \\
\bottomrule()
\end{longtable}

Processo de coleta e tramento análogo ao Indicador Alíquota Interna do
ICMS.

\begin{equation}
  Alíquota\ ISS = \frac{Receitas\ Brutas\ Realizadas_{ISS}}{PIB\ Municipal}
\end{equation}

\hypertarget{indicador-qualidade-da-gestuxe3o-fiscal}{%
\paragraph{Indicador Qualidade da Gestão
Fiscal}\label{indicador-qualidade-da-gestuxe3o-fiscal}}

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 2\tabcolsep) * \real{0.3506}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 2\tabcolsep) * \real{0.6494}}@{}}
\toprule()
\begin{minipage}[b]{\linewidth}\raggedright
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\textbf{Informações}
\end{minipage} \\
\midrule()
\endhead
\textbf{Fonte} & \url{https://www.firjan.com.br/ifgf/} \\
\textbf{Período} & 2021 \\
\textbf{Cidades faltantes} & Brasília (DF), Belém (PA), São João de
Meriti (RJ), Carapicuíba (SP) \\
\textbf{Efeito} & Positivo \\
\textbf{Variável de interesse} & IFGF \\
\textbf{Problemas com a coleta} & Não \\
\bottomrule()
\end{longtable}

O indicador não necessita de manipulação de dados.

\hypertarget{subdet_complexidade}{%
\subsubsection{Subdeterminante Complexidade
Burocrática}\label{subdet_complexidade}}

\begin{itemize}
\tightlist
\item
  \protect\hyperlink{script_2.1.3}{Clique aqui} para ver o script do
  Subdeterminante Complexidade Burocrática.
\end{itemize}

\hypertarget{indicador-simplicidade-tributuxe1ria}{%
\paragraph{Indicador Simplicidade
Tributária}\label{indicador-simplicidade-tributuxe1ria}}

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 2\tabcolsep) * \real{0.3506}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 2\tabcolsep) * \real{0.6494}}@{}}
\toprule()
\begin{minipage}[b]{\linewidth}\raggedright
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\textbf{Informações}
\end{minipage} \\
\midrule()
\endhead
\textbf{Fonte} &
\url{https://siconfi.tesouro.gov.br/siconfi/index.jsf} \\
\textbf{Período} & 2021 \\
\textbf{Cidades faltantes} & Brasília (DF) \\
\textbf{Efeito} & Positivo \\
\textbf{Variável de interesse} & - \\
\textbf{Problemas com a coleta} & Não \\
\bottomrule()
\end{longtable}

\hypertarget{indicador-cnds-municipais}{%
\paragraph{Indicador CNDs Municipais}\label{indicador-cnds-municipais}}

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 2\tabcolsep) * \real{0.3506}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 2\tabcolsep) * \real{0.6494}}@{}}
\toprule()
\begin{minipage}[b]{\linewidth}\raggedright
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\textbf{Informações}
\end{minipage} \\
\midrule()
\endhead
\textbf{Fonte} & Análise dos site das prefeituras \\
\textbf{Período} & 2021 \\
\textbf{Cidades faltantes} & - \\
\textbf{Efeito} & Positivo \\
\textbf{Variável de interesse} & CNDs Municipais \\
\textbf{Problemas com a coleta} & Não \\
\bottomrule()
\end{longtable}

Tabela com a justificativa dos CNDs = 0

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.2277}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.0792}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.6931}}@{}}
\toprule()
\begin{minipage}[b]{\linewidth}\raggedright
\textbf{Município}
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\textbf{UF}
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\textbf{Motivo}
\end{minipage} \\
\midrule()
\endhead
Ananindeua & PA & Não foi encontrada nenhuma referência ao termo no
site \\
Anápolis & GO & Não foi encontrada nenhuma referência ao termo no
site \\
Aracaju & SE & Não foi encontrada nenhuma referência ao termo no site \\
Betim & MG & Não foi encontrada nenhuma referência ao termo no site \\
Campina Grande & PB & Não foi encontrada nenhuma referência ao termo no
site \\
Campos dos Goytacazes & RJ & Não foi encontrada nenhuma referência ao
termo no site \\
Carapicuíba & SP & Não foi encontrada nenhuma referência ao termo no
site \\
Juiz de Fora & MG & Não foi encontrada nenhuma referência ao termo no
site \\
Mossoró & RN & Não foi encontrada nenhuma referência ao termo no site \\
Natal & RN & Não foi encontrada nenhuma referência ao termo no site \\
Ribeirão das Neves & MG & Não foi encontrada nenhuma referência ao termo
no site \\
São Gonçalo & RJ & Não foi encontrada nenhuma referência ao termo no
site \\
São João de Meriti & RJ & Não foi encontrada nenhuma referência ao termo
no site \\
São Vicente & SP & Não foi encontrada nenhuma referência ao termo no
site \\
Sumaré & SP & Não foi encontrada nenhuma referência ao termo no site \\
Taubaté & SP & Não foi encontrada nenhuma referência ao termo no site \\
Rio Branco & AC & Seção de serviços online fora do ar durante todo o
período da coleta \\
Brasília & DF & 0 Site encaminha para atendimento presencial ou via
e-mail \\
Guarulhos & SP & 0 Site encaminha para atendimento presencial ou via
e-mail \\
Itaquaquecetuba & SP & 0 Site encaminha para atendimento presencial ou
via e-mail \\
Camaçari & BA & 0 Site encaminha para um pdf com todos os serviços da
prefeitura, mas não indica forma de atendimento online \\
Rio de Janeiro & RJ & 0 Site foi hackeado dia 15/08/2022 e desde então
não foi possível ver com clareza os serviços, porém pelas informações
disponíveis foi entendido que para esse tipo de serviço o atendimento
somente é presencial \\
Belford Roxo & RJ & 0 site tem emição de quitação mas não de CND \\
São José dos Pinhais & PR & 0 site tem uma seção no site referente a
emissão de certidões, porém ao clicar nela o site da erro não abre nada.
Foram feitas algumas tentativas durante a construção desse relatório e
coleta dos dados. \\
\bottomrule()
\end{longtable}

\hypertarget{indicador-atualizauxe7uxe3o-de-zoneamento}{%
\paragraph{Indicador Atualização de
Zoneamento}\label{indicador-atualizauxe7uxe3o-de-zoneamento}}

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 2\tabcolsep) * \real{0.3506}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 2\tabcolsep) * \real{0.6494}}@{}}
\toprule()
\begin{minipage}[b]{\linewidth}\raggedright
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\textbf{Informações}
\end{minipage} \\
\midrule()
\endhead
\textbf{Fonte} &
\url{https://www.ibge.gov.br/estatisticas/sociais/protecao-social/10586-pesquisa-de-informacoes-basicas-municipais.html?=\&t=downloads} \\
\textbf{Período} & 2021 \\
\textbf{Cidades faltantes} & - \\
\textbf{Efeito} & Negativo \\
\textbf{Variável de interesse} & MLEG061 \\
\textbf{Problemas com a coleta} & Não \\
\bottomrule()
\end{longtable}

\hypertarget{determinante-infraestrutura}{%
\subsection{Determinante
Infraestrutura}\label{determinante-infraestrutura}}

\hypertarget{subdeterminante-transporte-interurbano}{%
\subsubsection{Subdeterminante Transporte
Interurbano}\label{subdeterminante-transporte-interurbano}}

\hypertarget{indicador-conectividade-via-rodovias}{%
\paragraph{Indicador Conectividade via
Rodovias}\label{indicador-conectividade-via-rodovias}}

\hypertarget{indicador-nuxfamero-de-decolagens-por-ano}{%
\paragraph{Indicador Número de Decolagens por
Ano}\label{indicador-nuxfamero-de-decolagens-por-ano}}

\hypertarget{indicador-distuxe2ncia-ao-porto-mais-pruxf3ximo}{%
\paragraph{Indicador Distância ao Porto Mais
Próximo}\label{indicador-distuxe2ncia-ao-porto-mais-pruxf3ximo}}

\hypertarget{subdeterminante-condiuxe7uxf5es-urbanas}{%
\subsubsection{Subdeterminante Condições
Urbanas}\label{subdeterminante-condiuxe7uxf5es-urbanas}}

\hypertarget{indicador-acesso-uxe0-internet-ruxe1pida}{%
\paragraph{Indicador Acesso à Internet
Rápida}\label{indicador-acesso-uxe0-internet-ruxe1pida}}

\hypertarget{indicador-preuxe7o-muxe9dio-do-muxb2}{%
\paragraph{Indicador Preço Médio do
m²}\label{indicador-preuxe7o-muxe9dio-do-muxb2}}

\hypertarget{indicador-custo-da-energia-eluxe9trica}{%
\paragraph{Indicador Custo da Energia
Elétrica}\label{indicador-custo-da-energia-eluxe9trica}}

\hypertarget{indicador-taxa-de-homicuxeddios}{%
\paragraph{Indicador Taxa de
Homicídios}\label{indicador-taxa-de-homicuxeddios}}

\hypertarget{determinante-mercado}{%
\subsection{Determinante Mercado}\label{determinante-mercado}}

\hypertarget{subdeterminante-desenvolvimento-econuxf4mico}{%
\subsubsection{Subdeterminante Desenvolvimento
Econômico}\label{subdeterminante-desenvolvimento-econuxf4mico}}

\hypertarget{indicador-uxedndice-de-desenvolvimento-humano}{%
\paragraph{Indicador Índice de Desenvolvimento
Humano}\label{indicador-uxedndice-de-desenvolvimento-humano}}

\hypertarget{indicador-crescimento-muxe9dio-real-do-pib}{%
\paragraph{Indicador Crescimento Médio Real do
PIB}\label{indicador-crescimento-muxe9dio-real-do-pib}}

\hypertarget{indicador-nuxfamero-de-empresas-exportadoras-com-sede-na-cidade}{%
\paragraph{Indicador Número de Empresas Exportadoras com Sede na
Cidade}\label{indicador-nuxfamero-de-empresas-exportadoras-com-sede-na-cidade}}

\hypertarget{subdeterminante-clientes-potenciais}{%
\subsubsection{Subdeterminante Clientes
Potenciais}\label{subdeterminante-clientes-potenciais}}

\hypertarget{indicador-pib-per-capita}{%
\paragraph{Indicador PIB per capita}\label{indicador-pib-per-capita}}

\hypertarget{indicador-proporuxe7uxe3o-entre-grandesmuxe9dias-e-muxe9diaspequenas-empresas}{%
\paragraph{Indicador Proporção entre Grandes/Médias e Médias/Pequenas
Empresas}\label{indicador-proporuxe7uxe3o-entre-grandesmuxe9dias-e-muxe9diaspequenas-empresas}}

\hypertarget{indicador-compras-puxfablicas}{%
\paragraph{Indicador Compras
Públicas}\label{indicador-compras-puxfablicas}}

\hypertarget{det_acesso_capital}{%
\subsection{Determinante Acesso a Capital}\label{det_acesso_capital}}

\begin{itemize}
\tightlist
\item
  \protect\hyperlink{script_2.4}{Clique aqui} para ver o script do
  Determinante Acesso a Capital.
\end{itemize}

\hypertarget{subdet_cap_disp}{%
\subsubsection{Subdeterminante Capital
Disponível}\label{subdet_cap_disp}}

\begin{itemize}
\tightlist
\item
  \protect\hyperlink{script_2.4.1}{Clique aqui} para ver o script do
  Subdeterminante Capital Disponível.
\end{itemize}

\hypertarget{indicador-operauxe7uxf5es-de-cruxe9dito-por-municuxedpio}{%
\paragraph{Indicador Operações de Crédito por
Município}\label{indicador-operauxe7uxf5es-de-cruxe9dito-por-municuxedpio}}

\hypertarget{indicador-proporuxe7uxe3o-relativa-de-capital-de-risco}{%
\paragraph{Indicador Proporção Relativa de Capital de
Risco}\label{indicador-proporuxe7uxe3o-relativa-de-capital-de-risco}}

\hypertarget{indicador-capital-poupado-per-capita}{%
\paragraph{Indicador Capital Poupado per
capita}\label{indicador-capital-poupado-per-capita}}

\hypertarget{det_inovacao}{%
\subsection{Determinante Inovação}\label{det_inovacao}}

\begin{itemize}
\tightlist
\item
  \protect\hyperlink{script_2.5}{Clique aqui} para ver o script do
  Determinante Inovação.
\end{itemize}

\hypertarget{subdet_input}{%
\subsubsection{Subdeterminante Inputs}\label{subdet_input}}

\begin{itemize}
\tightlist
\item
  \protect\hyperlink{script_2.5.1}{Clique aqui} para ver o script do
  Subdeterminante Inputs.
\end{itemize}

\hypertarget{indicador-proporuxe7uxe3o-de-mestres-e-doutores-em-ct}{%
\paragraph{Indicador Proporção de Mestres e Doutores em
C\&T}\label{indicador-proporuxe7uxe3o-de-mestres-e-doutores-em-ct}}

\hypertarget{indicador-proporuxe7uxe3o-de-funcionuxe1rios-em-ct}{%
\paragraph{Indicador Proporção de Funcionários em
C\&T}\label{indicador-proporuxe7uxe3o-de-funcionuxe1rios-em-ct}}

\hypertarget{indicador-muxe9dia-de-investimentos-do-bndes-e-da-finep}{%
\paragraph{Indicador Média de Investimentos do BNDES e da
FINEP}\label{indicador-muxe9dia-de-investimentos-do-bndes-e-da-finep}}

\hypertarget{indicador-infraestrutura-tecnoluxf3gica}{%
\paragraph{Indicador Infraestrutura
Tecnológica}\label{indicador-infraestrutura-tecnoluxf3gica}}

\hypertarget{indicador-contratos-de-concessuxe3o}{%
\paragraph{Indicador Contratos de
Concessão}\label{indicador-contratos-de-concessuxe3o}}

\hypertarget{subdet_output}{%
\subsubsection{Subdeterminante Outputs}\label{subdet_output}}

\begin{itemize}
\tightlist
\item
  \protect\hyperlink{script_2.5.2}{Clique aqui} para ver o script do
  Subdeterminante Outputs.
\end{itemize}

\hypertarget{indicador-patentes}{%
\paragraph{Indicador Patentes}\label{indicador-patentes}}

\hypertarget{indicador-tamanho-da-induxfastria-inovadora}{%
\paragraph{Indicador Tamanho da Indústria
Inovadora}\label{indicador-tamanho-da-induxfastria-inovadora}}

\hypertarget{indicador-tamanho-da-economia-criativa}{%
\paragraph{Indicador Tamanho da Economia
Criativa}\label{indicador-tamanho-da-economia-criativa}}

\hypertarget{indicador-tamanho-das-empresas-tic}{%
\paragraph{Indicador Tamanho das Empresas
TIC}\label{indicador-tamanho-das-empresas-tic}}

\hypertarget{det_capital_humano}{%
\subsection{Determinante Capital Humano}\label{det_capital_humano}}

\hypertarget{subdet_obra_basica}{%
\subsubsection{Subdeterminante Acesso e Qualidade da Mão de Obra
Básica}\label{subdet_obra_basica}}

\hypertarget{indicador-nota-do-ideb}{%
\paragraph{Indicador Nota do Ideb}\label{indicador-nota-do-ideb}}

\hypertarget{indicador-proporuxe7uxe3o-de-adultos-com-pelo-menos-o-ensino-muxe9dio-completo}{%
\paragraph{Indicador Proporção de Adultos com Pelo Menos o Ensino Médio
Completo}\label{indicador-proporuxe7uxe3o-de-adultos-com-pelo-menos-o-ensino-muxe9dio-completo}}

\hypertarget{indicador-taxa-luxedquida-de-matruxedcula-no-ensino-muxe9dio}{%
\paragraph{Indicador Taxa Líquida de Matrícula no Ensino
Médio}\label{indicador-taxa-luxedquida-de-matruxedcula-no-ensino-muxe9dio}}

\hypertarget{indicador-nota-muxe9dia-no-enem}{%
\paragraph{Indicador Nota Média no
Enem}\label{indicador-nota-muxe9dia-no-enem}}

\hypertarget{indicador-proporuxe7uxe3o-de-matriculados-no-ensino-tuxe9cnico-e-profissionalizante}{%
\paragraph{Indicador Proporção de Matriculados no Ensino Técnico e
Profissionalizante}\label{indicador-proporuxe7uxe3o-de-matriculados-no-ensino-tuxe9cnico-e-profissionalizante}}

\hypertarget{subdet_obra_qualificada}{%
\subsubsection{Subdeterminante Acesso e Qualidade da Mão de Obra
Qualificada}\label{subdet_obra_qualificada}}

\hypertarget{indicador-proporuxe7uxe3o-de-adultos-com-pelo-menos-o-ensino-superior-completo}{%
\paragraph{Indicador Proporção de Adultos com Pelo Menos o Ensino
Superior
Completo}\label{indicador-proporuxe7uxe3o-de-adultos-com-pelo-menos-o-ensino-superior-completo}}

\hypertarget{indicador-proporuxe7uxe3o-de-alunos-concluintes-em-cursos-de-alta-qualidade}{%
\paragraph{Indicador Proporção de Alunos Concluintes em Cursos de Alta
Qualidade}\label{indicador-proporuxe7uxe3o-de-alunos-concluintes-em-cursos-de-alta-qualidade}}

\hypertarget{indicador-custo-muxe9dio-de-saluxe1rios-de-dirigentes}{%
\paragraph{Indicador Custo Médio de Salários de
Dirigentes}\label{indicador-custo-muxe9dio-de-saluxe1rios-de-dirigentes}}

\hypertarget{determinante-cultura}{%
\subsection{Determinante Cultura}\label{determinante-cultura}}

\hypertarget{subdeterminante-iniciativa}{%
\subsubsection{Subdeterminante
Iniciativa}\label{subdeterminante-iniciativa}}

\hypertarget{indicador-pesquisas-empreendedora}{%
\paragraph{Indicador Pesquisas
Empreendedora}\label{indicador-pesquisas-empreendedora}}

\hypertarget{indicador-pesquisas-empreendedorismo}{%
\paragraph{Indicador Pesquisas
Empreendedorismo}\label{indicador-pesquisas-empreendedorismo}}

\hypertarget{indicador-pesquisas-mei}{%
\paragraph{Indicador Pesquisas MEI}\label{indicador-pesquisas-mei}}

\hypertarget{subdeterminante-instituiuxe7uxf5es}{%
\subsubsection{Subdeterminante
Instituições}\label{subdeterminante-instituiuxe7uxf5es}}

\hypertarget{indicador-pesquisas-sebrae}{%
\paragraph{Indicador Pesquisas
SEBRAE}\label{indicador-pesquisas-sebrae}}

\hypertarget{indicador-pesquisas-franquia}{%
\paragraph{Indicador Pesquisas
Franquia}\label{indicador-pesquisas-franquia}}

\hypertarget{indicador-pesquisas-simples-nacional}{%
\paragraph{Indicador Pesquisas Simples
Nacional}\label{indicador-pesquisas-simples-nacional}}

\hypertarget{indicador-pesquisas-senac}{%
\paragraph{Indicador Pesquisas SENAC}\label{indicador-pesquisas-senac}}

\hypertarget{anuxe1lise-de-componentes-principais}{%
\section{Análise de Componentes
Principais}\label{anuxe1lise-de-componentes-principais}}

\hypertarget{correlauxe7uxe3o-com-o-ice2022}{%
\section{Correlação com o
ICE2022}\label{correlauxe7uxe3o-com-o-ice2022}}

\hypertarget{efeito-parcial-da-cultura}{%
\section{Efeito Parcial da Cultura}\label{efeito-parcial-da-cultura}}

\hypertarget{ranking}{%
\section{Ranking}\label{ranking}}

\hypertarget{apend}{%
\section*{Apêndice}\label{apend}}
\addcontentsline{toc}{section}{Apêndice}

\hypertarget{script_ind}{%
\subsection*{Scripts}\label{script_ind}}
\addcontentsline{toc}{subsection}{Scripts}

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ pandas }\ImportTok{as}\NormalTok{ pd}
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}
\ImportTok{from}\NormalTok{ funcs }\ImportTok{import} \OperatorTok{*}
\ImportTok{from}\NormalTok{ functools }\ImportTok{import} \BuiltInTok{reduce}
\ImportTok{import}\NormalTok{ basedosdados }\ImportTok{as}\NormalTok{ bd}
\end{Highlighting}
\end{Shaded}

\hypertarget{amostra}{%
\subsubsection*{Amostra}\label{amostra}}
\addcontentsline{toc}{subsubsection}{Amostra}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Leitura da base}
\NormalTok{df }\OperatorTok{=}\NormalTok{ pd.read\_excel(}\StringTok{\textquotesingle{}POP2021\_20220711.xls\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Municípios\textquotesingle{}}\NormalTok{)}
\NormalTok{df }\OperatorTok{=}\NormalTok{ df.head(}\OperatorTok{{-}}\DecValTok{32}\NormalTok{)}
\NormalTok{df.columns }\OperatorTok{=}\NormalTok{ df.iloc[}\DecValTok{0}\NormalTok{]}
\NormalTok{df }\OperatorTok{=}\NormalTok{ df.drop(}\DecValTok{0}\NormalTok{)}
\NormalTok{df.index }\OperatorTok{=} \BuiltInTok{range}\NormalTok{(}\BuiltInTok{len}\NormalTok{(df))}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\BuiltInTok{len}\NormalTok{(df)):}
    \ControlFlowTok{if} \BuiltInTok{type}\NormalTok{(df.iloc[i][}\StringTok{\textquotesingle{}POPULAÇÃO ESTIMADA\textquotesingle{}}\NormalTok{]) }\OperatorTok{==} \BuiltInTok{str}\NormalTok{:}
\NormalTok{        pop }\OperatorTok{=} \BuiltInTok{int}\NormalTok{(df.iloc[i][}\StringTok{\textquotesingle{}POPULAÇÃO ESTIMADA\textquotesingle{}}\NormalTok{].split(}\StringTok{\textquotesingle{}(\textquotesingle{}}\NormalTok{)[}\DecValTok{0}\NormalTok{].replace(}\StringTok{\textquotesingle{}.\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}\textquotesingle{}}\NormalTok{))}
\NormalTok{        df.at[i, }\StringTok{\textquotesingle{}POPULAÇÃO ESTIMADA\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ pop}
\NormalTok{top100 }\OperatorTok{=}\NormalTok{ df.sort\_values(by}\OperatorTok{=}\NormalTok{[}\StringTok{\textquotesingle{}POPULAÇÃO ESTIMADA\textquotesingle{}}\NormalTok{], ascending}\OperatorTok{=}\VariableTok{False}\NormalTok{).head(}\DecValTok{101}\NormalTok{)}

\CommentTok{\# Tratando a base}
\NormalTok{am }\OperatorTok{=}\NormalTok{ pd.read\_excel(}\StringTok{\textquotesingle{}Amostra.xlsx\textquotesingle{}}\NormalTok{)}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\BuiltInTok{len}\NormalTok{(am)):}
\NormalTok{    name }\OperatorTok{=}\NormalTok{ am[}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{][i].split(}\StringTok{\textquotesingle{}{-}\textquotesingle{}}\NormalTok{)[}\DecValTok{0}\NormalTok{].strip()}
\NormalTok{    am.at[i,}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ name}

\KeywordTok{def}\NormalTok{ Union(lst1, lst2):}
\NormalTok{    final\_list }\OperatorTok{=} \BuiltInTok{list}\NormalTok{(}\BuiltInTok{set}\NormalTok{(lst1) }\OperatorTok{|} \BuiltInTok{set}\NormalTok{(lst2))}
    \ControlFlowTok{return}\NormalTok{ final\_list}

\NormalTok{final\_sample }\OperatorTok{=}\NormalTok{ Union(am[}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{],top100[}\StringTok{\textquotesingle{}NOME DO MUNICÍPIO\textquotesingle{}}\NormalTok{])}

\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in}\NormalTok{ am[}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{]:}
    \ControlFlowTok{if}\NormalTok{ i }\KeywordTok{not} \KeywordTok{in} \BuiltInTok{list}\NormalTok{(top100[}\StringTok{\textquotesingle{}NOME DO MUNICÍPIO\textquotesingle{}}\NormalTok{]):}
        \BuiltInTok{print}\NormalTok{(i)}

\CommentTok{\# Criando o arquivo}
\NormalTok{top100.to\_csv(}\StringTok{\textquotesingle{}100{-}municipios.csv\textquotesingle{}}\NormalTok{, index}\OperatorTok{=}\VariableTok{False}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{script_2.1}{%
\subsubsection*{Determinante Ambiente Regulatório}\label{script_2.1}}
\addcontentsline{toc}{subsubsection}{Determinante Ambiente Regulatório}

\begin{itemize}
\tightlist
\item
  Para retornar ao relatório do Determinante Ambiente Regulatório
  \protect\hyperlink{det_amb_regulatorio}{clique aqui}.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Criando o ambiente que criará o determinante}
\NormalTok{ambiente }\OperatorTok{=}\NormalTok{ \{\}}
\end{Highlighting}
\end{Shaded}

\hypertarget{script_2.1.1}{%
\paragraph*{Subdeterminante Tempo de Processos}\label{script_2.1.1}}
\addcontentsline{toc}{paragraph}{Subdeterminante Tempo de Processos}

\begin{itemize}
\tightlist
\item
  Para retornar ao relatório do Subdeterminante Tempo de Processos
  \protect\hyperlink{subdet_tempo_processo}{clique aqui}.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#\# Indicando o Subdeterminante}
\NormalTok{subdet }\OperatorTok{=} \StringTok{\textquotesingle{}Tempo de Processos\textquotesingle{}}

\CommentTok{\#\#\#\#\#\#\#\#\#\#\#\# Indicador Indicador Tempo de Viabilidade de Localização \#\#\#\#\#\#\#\#\#\#\#}

\CommentTok{\# Looping para ler os 12 meses da variável de tempo de abertura da REDESIM}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{list}\NormalTok{(}\BuiltInTok{range}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{13}\NormalTok{)):}
    \BuiltInTok{globals}\NormalTok{()[}\SpecialStringTok{f"indicador\_}\SpecialCharTok{\{}\NormalTok{i}\SpecialCharTok{\}}\SpecialStringTok{"}\NormalTok{] }\OperatorTok{=}\NormalTok{ pd.read\_excel(}\SpecialStringTok{f\textquotesingle{}DETERMINANTE AMBIENTE REGULATÓRIO/REDESIM/tempos{-}abertura{-}Brasil}\SpecialCharTok{\{}\NormalTok{i}\SpecialCharTok{\}}\SpecialStringTok{2021.xlsx\textquotesingle{}}\NormalTok{, }
\NormalTok{                                                    header}\OperatorTok{=}\DecValTok{1}\NormalTok{, usecols}\OperatorTok{=}\StringTok{"I,R,AA,AB"}\NormalTok{)}
\NormalTok{    pdList }\OperatorTok{=}\NormalTok{ []}
\NormalTok{    pdList.extend(value }\ControlFlowTok{for}\NormalTok{ name, value }\KeywordTok{in} \BuiltInTok{locals}\NormalTok{().items() }\ControlFlowTok{if}\NormalTok{ name.startswith(}\StringTok{"indicador"}\NormalTok{))}
\NormalTok{    indicador }\OperatorTok{=}\NormalTok{ pd.concat(pdList, axis }\OperatorTok{=} \DecValTok{0}\NormalTok{)}

\CommentTok{\# Tratando a base}
\NormalTok{indicador[}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ indicador[}\StringTok{\textquotesingle{}MUNICÍPIO\textquotesingle{}}\NormalTok{].}\BuiltInTok{str}\NormalTok{.upper().}\BuiltInTok{str}\NormalTok{.normalize(}\StringTok{\textquotesingle{}NFKD\textquotesingle{}}\NormalTok{).}\BuiltInTok{str}\NormalTok{.encode(}\StringTok{\textquotesingle{}ascii\textquotesingle{}}\NormalTok{, errors}\OperatorTok{=}\StringTok{\textquotesingle{}ignore\textquotesingle{}}\NormalTok{).}\BuiltInTok{str}\NormalTok{.decode(}\StringTok{\textquotesingle{}utf{-}8\textquotesingle{}}\NormalTok{)}
\NormalTok{indicador }\OperatorTok{=}\NormalTok{ database.merge(indicador, how}\OperatorTok{=}\StringTok{\textquotesingle{}left\textquotesingle{}}\NormalTok{, on}\OperatorTok{=}\NormalTok{[}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{])}
\NormalTok{indicador[}\StringTok{\textquotesingle{}Tempo de Viabilidade de Localização\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ indicador[}\StringTok{\textquotesingle{}QTDE.  HH VIABILIDADE END\textquotesingle{}}\NormalTok{]}

\CommentTok{\#\#\#\#\#\#\#\#\#\# Indicador Tempo de Registro, Cadastro e Viabilidade de Nome \#\#\#\#\#\#\#\#\#\#}

\NormalTok{indicador[}\StringTok{\textquotesingle{}Tempo de Registro, Cadastro e Viabilidade de Nome\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ indicador[}\StringTok{\textquotesingle{}QTDE. HH. LIBERAÇÃO DBE\textquotesingle{}}\NormalTok{]}
\NormalTok{indicador }\OperatorTok{=}\NormalTok{ indicador.groupby([}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{]).mean()}
\NormalTok{indicador }\OperatorTok{=}\NormalTok{ indicador.fillna(}\DecValTok{0}\NormalTok{)}

\KeywordTok{del}\NormalTok{ indicador[}\StringTok{\textquotesingle{}QTDE.  HH VIABILIDADE END\textquotesingle{}}\NormalTok{]}
\KeywordTok{del}\NormalTok{ indicador[}\StringTok{\textquotesingle{}QTDE. HH. LIBERAÇÃO DBE\textquotesingle{}}\NormalTok{]}

\CommentTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\# Indicador Taxa de Congestionamento em Tribunais \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}

\NormalTok{var }\OperatorTok{=}\NormalTok{ [}\StringTok{\textquotesingle{}novos\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}baixados\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}pendentes\textquotesingle{}}\NormalTok{]}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{list}\NormalTok{(}\BuiltInTok{range}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{3}\NormalTok{)):}
    \BuiltInTok{globals}\NormalTok{()[}\SpecialStringTok{f"indicador\_pro\_}\SpecialCharTok{\{}\NormalTok{i}\SpecialCharTok{\}}\SpecialStringTok{"}\NormalTok{] }\OperatorTok{=}\NormalTok{ pd.read\_excel(}\SpecialStringTok{f\textquotesingle{}DETERMINANTE AMBIENTE REGULATÓRIO/CNJ/}\SpecialCharTok{\{}\NormalTok{var[i]}\SpecialCharTok{\}}\SpecialStringTok{\_cnj.xlsx\textquotesingle{}}\NormalTok{)}
\NormalTok{    pd\_List }\OperatorTok{=}\NormalTok{ []}
\NormalTok{    pd\_List.extend(value }\ControlFlowTok{for}\NormalTok{ name, value }\KeywordTok{in} \BuiltInTok{locals}\NormalTok{().items() }\ControlFlowTok{if}\NormalTok{ name.startswith(}\StringTok{"indicador\_pro\_"}\NormalTok{))}
\NormalTok{    indicador\_pro }\OperatorTok{=}\NormalTok{ pd.concat(pd\_List, axis }\OperatorTok{=} \DecValTok{0}\NormalTok{)}

\NormalTok{indicador\_pro[}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ indicador\_pro[}\StringTok{\textquotesingle{}Tribunal município\textquotesingle{}}\NormalTok{].}\BuiltInTok{str}\NormalTok{.upper().}\BuiltInTok{str}\NormalTok{.normalize(}\StringTok{\textquotesingle{}NFKD\textquotesingle{}}\NormalTok{).}\BuiltInTok{str}\NormalTok{.encode(}\StringTok{\textquotesingle{}ascii\textquotesingle{}}\NormalTok{, errors}\OperatorTok{=}\StringTok{\textquotesingle{}ignore\textquotesingle{}}\NormalTok{).}\BuiltInTok{str}\NormalTok{.decode(}\StringTok{\textquotesingle{}utf{-}8\textquotesingle{}}\NormalTok{)}
\NormalTok{indicador\_pro }\OperatorTok{=}\NormalTok{ database.merge(indicador\_pro, how}\OperatorTok{=}\StringTok{\textquotesingle{}left\textquotesingle{}}\NormalTok{,on}\OperatorTok{=}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{)}
\NormalTok{indicador\_pro }\OperatorTok{=}\NormalTok{ indicador\_pro.pivot\_table(index}\OperatorTok{=}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{, columns}\OperatorTok{=}\StringTok{\textquotesingle{}Tipo variável\textquotesingle{}}\NormalTok{, values}\OperatorTok{=}\StringTok{\textquotesingle{}Indicador Valor\textquotesingle{}}\NormalTok{)}
\NormalTok{indicador\_pro[}\StringTok{\textquotesingle{}Taxa de Congestionamento em Tribunais\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ (}\DecValTok{1}\OperatorTok{{-}}\NormalTok{(indicador\_pro[}\StringTok{\textquotesingle{}BAIXADOS\textquotesingle{}}\NormalTok{]}\OperatorTok{/}\NormalTok{(indicador\_pro[}\StringTok{\textquotesingle{}NOVOS\textquotesingle{}}\NormalTok{]}\OperatorTok{+}\NormalTok{indicador\_pro[}\StringTok{\textquotesingle{}PENDENTES\textquotesingle{}}\NormalTok{])))}

\KeywordTok{del}\NormalTok{ indicador\_pro[}\StringTok{\textquotesingle{}BAIXADOS\textquotesingle{}}\NormalTok{]}
\KeywordTok{del}\NormalTok{ indicador\_pro[}\StringTok{\textquotesingle{}NOVOS\textquotesingle{}}\NormalTok{]}
\KeywordTok{del}\NormalTok{ indicador\_pro[}\StringTok{\textquotesingle{}PENDENTES\textquotesingle{}}\NormalTok{]}

\NormalTok{subdet\_tempo }\OperatorTok{=}\NormalTok{ indicador.reset\_index().merge(indicador\_pro, how}\OperatorTok{=}\StringTok{\textquotesingle{}inner\textquotesingle{}}\NormalTok{, on}\OperatorTok{=}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{).set\_index([}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{])}
\NormalTok{subdet\_tempo[}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ subdet\_tempo[}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{].astype(}\BuiltInTok{str}\NormalTok{).}\BuiltInTok{str}\NormalTok{[:}\DecValTok{7}\NormalTok{]}
\NormalTok{amostra[}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ amostra[}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{].astype(}\BuiltInTok{str}\NormalTok{)}
\NormalTok{subdet\_tempo }\OperatorTok{=}\NormalTok{ subdet\_tempo.merge(amostra, how}\OperatorTok{=}\StringTok{\textquotesingle{}right\textquotesingle{}}\NormalTok{, on}\OperatorTok{=}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{)}
\NormalTok{interesse }\OperatorTok{=}\NormalTok{ [}\StringTok{\textquotesingle{}NOME DO MUNICÍPIO\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Tempo de Viabilidade de Localização\textquotesingle{}}\NormalTok{,}
             \StringTok{\textquotesingle{}Tempo de Registro, Cadastro e Viabilidade de Nome\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Taxa de Congestionamento em Tribunais\textquotesingle{}}\NormalTok{]}
\NormalTok{subdet\_tempo }\OperatorTok{=}\NormalTok{ subdet\_tempo[interesse].rename(columns}\OperatorTok{=}\NormalTok{\{}\StringTok{\textquotesingle{}NOME DO MUNICÍPIO\textquotesingle{}}\NormalTok{:}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{\})}
\NormalTok{subdet\_tempo }\OperatorTok{=}\NormalTok{ subdet\_tempo.set\_index([}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{])}

\NormalTok{subdet\_tempo[}\StringTok{\textquotesingle{}Tempo de Viabilidade de Localização\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ negative(subdet\_tempo[}\StringTok{\textquotesingle{}Tempo de Viabilidade de Localização\textquotesingle{}}\NormalTok{])}
\NormalTok{subdet\_tempo[}\StringTok{\textquotesingle{}Tempo de Registro, Cadastro e Viabilidade de Nome\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ negative(subdet\_tempo[}\StringTok{\textquotesingle{}Tempo de Registro, Cadastro e Viabilidade de Nome\textquotesingle{}}\NormalTok{])}
\NormalTok{subdet\_tempo[}\StringTok{\textquotesingle{}Taxa de Congestionamento em Tribunais\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ negative(subdet\_tempo[}\StringTok{\textquotesingle{}Taxa de Congestionamento em Tribunais\textquotesingle{}}\NormalTok{])}

\CommentTok{\# Tratamentos de para os missing e outliers}
\NormalTok{missing\_data(subdet\_tempo)}
\NormalTok{extreme\_values(subdet\_tempo)}

\CommentTok{\# Criando o subdeterminante}
\NormalTok{create\_subindex(subdet\_tempo, subdet)}
\NormalTok{ambiente[subdet] }\OperatorTok{=}\NormalTok{ subdet\_tempo}
\end{Highlighting}
\end{Shaded}

\hypertarget{script_2.1.2}{%
\paragraph*{Subdeterminante Tributação}\label{script_2.1.2}}
\addcontentsline{toc}{paragraph}{Subdeterminante Tributação}

\begin{itemize}
\tightlist
\item
  Para retornar ao relatório do Subdeterminante Tributação
  \protect\hyperlink{subdet_tributacao}{clique aqui}.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Indicando o Subdeterminante}
\NormalTok{subdet }\OperatorTok{=} \StringTok{\textquotesingle{}Tributação\textquotesingle{}}

\CommentTok{\#\# Tratamento inicial com os dados do SINCONFI}
\NormalTok{sinconfi\_mun }\OperatorTok{=}\NormalTok{ pd.read\_csv(}\StringTok{"DETERMINANTE AMBIENTE REGULATÓRIO/Sinconfi/finbra\_mun.csv"}\NormalTok{,}
\NormalTok{                           encoding}\OperatorTok{=}\StringTok{\textquotesingle{}ISO{-}8859{-}1\textquotesingle{}}\NormalTok{, sep}\OperatorTok{=}\StringTok{\textquotesingle{};\textquotesingle{}}\NormalTok{, decimal}\OperatorTok{=}\StringTok{\textquotesingle{},\textquotesingle{}}\NormalTok{)}
\NormalTok{sinconfi\_uf }\OperatorTok{=}\NormalTok{ pd.read\_csv(}\StringTok{"DETERMINANTE AMBIENTE REGULATÓRIO/Sinconfi/finbra\_uf.csv"}\NormalTok{,}
\NormalTok{                          encoding}\OperatorTok{=}\StringTok{\textquotesingle{}ISO{-}8859{-}1\textquotesingle{}}\NormalTok{, sep}\OperatorTok{=}\StringTok{\textquotesingle{};\textquotesingle{}}\NormalTok{, decimal}\OperatorTok{=}\StringTok{\textquotesingle{},\textquotesingle{}}\NormalTok{)}
\NormalTok{base }\OperatorTok{=} \StringTok{\textquotesingle{}\textasciigrave{}basedosdados.br\_ibge\_pib.municipio\textasciigrave{}\textquotesingle{}}
\NormalTok{project\_id }\OperatorTok{=} \StringTok{\textquotesingle{}double{-}balm{-}306418\textquotesingle{}}
\NormalTok{var }\OperatorTok{=}\NormalTok{ (}\StringTok{\textquotesingle{}id\_municipio, pib\textquotesingle{}}\NormalTok{)}
\NormalTok{database }\OperatorTok{=}\NormalTok{ database.reset\_index()}
\NormalTok{cod\_ibge }\OperatorTok{=} \BuiltInTok{tuple}\NormalTok{(database[}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{].astype(}\BuiltInTok{str}\NormalTok{))}
\NormalTok{query }\OperatorTok{=} \SpecialStringTok{f\textquotesingle{}SELECT }\SpecialCharTok{\{}\NormalTok{var}\SpecialCharTok{\}}\SpecialStringTok{ FROM }\SpecialCharTok{\{}\NormalTok{base}\SpecialCharTok{\}}\SpecialStringTok{ WHERE ano = 2019 AND id\_municipio IN }\SpecialCharTok{\{}\NormalTok{cod\_ibge}\SpecialCharTok{\}}\SpecialStringTok{\textquotesingle{}}
\NormalTok{pib\_mun }\OperatorTok{=}\NormalTok{ bd.read\_sql(query}\OperatorTok{=}\NormalTok{query,billing\_project\_id}\OperatorTok{=}\NormalTok{project\_id)}

\CommentTok{\# Função para calcular os indicadores de alíquota}
\KeywordTok{def}\NormalTok{ sinconfi(df1,df2,pib,imposto,var):}
\NormalTok{    df\_mun }\OperatorTok{=}\NormalTok{ df1[df1[}\StringTok{\textquotesingle{}Conta\textquotesingle{}}\NormalTok{] }\OperatorTok{==}\NormalTok{ var]}
\NormalTok{    df\_mun }\OperatorTok{=}\NormalTok{ df\_mun[df\_mun[}\StringTok{\textquotesingle{}Coluna\textquotesingle{}}\NormalTok{] }\OperatorTok{==} \StringTok{\textquotesingle{}Receitas Brutas Realizadas\textquotesingle{}}\NormalTok{]}
\NormalTok{    df\_mun[}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ df\_mun[}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{].astype(np.int64)}
\NormalTok{    df\_mun }\OperatorTok{=}\NormalTok{ database.merge(df\_mun, how}\OperatorTok{=}\StringTok{\textquotesingle{}left\textquotesingle{}}\NormalTok{, on }\OperatorTok{=}\NormalTok{ [}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{])}
\NormalTok{    df\_mun }\OperatorTok{=}\NormalTok{ df\_mun[[}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Valor\textquotesingle{}}\NormalTok{]]}
\NormalTok{    df\_mun }\OperatorTok{=}\NormalTok{ df\_mun[(df\_mun[}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{] }\OperatorTok{!=} \StringTok{\textquotesingle{}BRASILIA\textquotesingle{}}\NormalTok{)]}
    
\NormalTok{    df\_uf }\OperatorTok{=}\NormalTok{ df2[df2[}\StringTok{\textquotesingle{}Conta\textquotesingle{}}\NormalTok{] }\OperatorTok{==}\NormalTok{ var]}
\NormalTok{    df\_uf }\OperatorTok{=}\NormalTok{ df\_uf[df\_uf[}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{] }\OperatorTok{==} \StringTok{\textquotesingle{}DF\textquotesingle{}}\NormalTok{]}
\NormalTok{    df\_uf }\OperatorTok{=}\NormalTok{ df\_uf[df\_uf[}\StringTok{\textquotesingle{}Coluna\textquotesingle{}}\NormalTok{] }\OperatorTok{==} \StringTok{\textquotesingle{}Receitas Brutas Realizadas\textquotesingle{}}\NormalTok{]}
\NormalTok{    df\_uf[}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ [}\StringTok{\textquotesingle{}BRASILIA\textquotesingle{}}\NormalTok{]}
\NormalTok{    df\_uf }\OperatorTok{=}\NormalTok{ df\_uf[[}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Valor\textquotesingle{}}\NormalTok{]]}
    
\NormalTok{    pib }\OperatorTok{=}\NormalTok{ pib.rename(columns}\OperatorTok{=}\NormalTok{\{}\StringTok{\textquotesingle{}id\_municipio\textquotesingle{}}\NormalTok{:}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{\}).astype(np.int64)}
\NormalTok{    pib }\OperatorTok{=}\NormalTok{ database.merge(pib, how}\OperatorTok{=}\StringTok{\textquotesingle{}left\textquotesingle{}}\NormalTok{, on}\OperatorTok{=}\NormalTok{[}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{]).set\_index([}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{])}
\NormalTok{    df }\OperatorTok{=}\NormalTok{ df\_mun.append(df\_uf).merge(pib, how}\OperatorTok{=}\StringTok{\textquotesingle{}left\textquotesingle{}}\NormalTok{,on}\OperatorTok{=}\NormalTok{[}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{]).reset\_index(drop}\OperatorTok{=}\VariableTok{True}\NormalTok{)}
\NormalTok{    df[}\SpecialStringTok{f\textquotesingle{}Alíquota Interna do }\SpecialCharTok{\{}\NormalTok{imposto}\SpecialCharTok{\}}\SpecialStringTok{\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ df[}\StringTok{\textquotesingle{}Valor\textquotesingle{}}\NormalTok{]}\OperatorTok{/}\NormalTok{df[}\StringTok{\textquotesingle{}pib\textquotesingle{}}\NormalTok{]}
    
    \BuiltInTok{globals}\NormalTok{()[}\SpecialStringTok{f\textquotesingle{}df\_}\SpecialCharTok{\{}\NormalTok{imposto}\SpecialCharTok{\}}\SpecialStringTok{\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ df.drop([}\StringTok{\textquotesingle{}Valor\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}pib\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{], axis}\OperatorTok{=}\DecValTok{1}\NormalTok{)}
    
\CommentTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\# Indicador Alíquota Interna do ICMS \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\NormalTok{sinconfi(sinconfi\_mun,sinconfi\_uf,pib\_mun,imposto}\OperatorTok{=}\StringTok{\textquotesingle{}ICMS\textquotesingle{}}\NormalTok{,var}\OperatorTok{=}\StringTok{\textquotesingle{}1.1.1.8.02.0.0 {-} Impostos sobre a Produção, Circulação de Mercadorias e Serviços\textquotesingle{}}\NormalTok{)}

\CommentTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\# Indicador Alíquota Interna do IPTU \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\NormalTok{sinconfi(sinconfi\_mun,sinconfi\_uf,pib\_mun,imposto}\OperatorTok{=}\StringTok{\textquotesingle{}IPTU\textquotesingle{}}\NormalTok{,var}\OperatorTok{=}\StringTok{\textquotesingle{}1.1.1.8.01.1.0 {-} Imposto sobre a Propriedade Predial e Territorial Urbana\textquotesingle{}}\NormalTok{)}

\CommentTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\# Indicador Alíquota Interna do ISS \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\NormalTok{sinconfi(sinconfi\_mun,sinconfi\_uf,pib\_mun,imposto}\OperatorTok{=}\StringTok{\textquotesingle{}ISS\textquotesingle{}}\NormalTok{,var}\OperatorTok{=}\StringTok{\textquotesingle{}1.1.1.8.02.3.0 {-} Imposto sobre Serviços de Qualquer Natureza\textquotesingle{}}\NormalTok{)}
\NormalTok{df\_ISS }\OperatorTok{=}\NormalTok{ df\_ISS.fillna(}\DecValTok{0}\NormalTok{)}

\CommentTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\# Indicador Qualidade de Gestão Fiscal \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\NormalTok{df\_firjan }\OperatorTok{=}\NormalTok{ pd.read\_excel(}\StringTok{"DETERMINANTE AMBIENTE REGULATÓRIO/Firjan/Firjan {-} Evolucao por Indicador 2013 a 2020 {-} IFGF 2021.xlsx"}\NormalTok{, usecols}\OperatorTok{=}\StringTok{"B:C,AA"}\NormalTok{)}
\NormalTok{df\_firjan[}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ df\_firjan[}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{].}\BuiltInTok{str}\NormalTok{.upper().}\BuiltInTok{str}\NormalTok{.normalize(}\StringTok{\textquotesingle{}NFKD\textquotesingle{}}\NormalTok{).}\BuiltInTok{str}\NormalTok{.encode(}\StringTok{\textquotesingle{}ascii\textquotesingle{}}\NormalTok{, errors}\OperatorTok{=}\StringTok{\textquotesingle{}ignore\textquotesingle{}}\NormalTok{).}\BuiltInTok{str}\NormalTok{.decode(}\StringTok{\textquotesingle{}utf{-}8\textquotesingle{}}\NormalTok{)}
\NormalTok{df\_firjan }\OperatorTok{=}\NormalTok{ database.merge(df\_firjan, how}\OperatorTok{=}\StringTok{\textquotesingle{}left\textquotesingle{}}\NormalTok{, on }\OperatorTok{=}\NormalTok{ [}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{]).fillna(}\DecValTok{0}\NormalTok{)}
\NormalTok{df\_firjan }\OperatorTok{=}\NormalTok{ df\_firjan.set\_index([}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{])}
\NormalTok{df\_firjan }\OperatorTok{=}\NormalTok{ df\_firjan[}\StringTok{\textquotesingle{}IFGF 2020\textquotesingle{}}\NormalTok{].to\_frame()}
\NormalTok{df\_firjan }\OperatorTok{=}\NormalTok{ df\_firjan.replace(to\_replace}\OperatorTok{=}\VerbatimStringTok{r\textquotesingle{}nd\textquotesingle{}}\NormalTok{,value}\OperatorTok{=}\DecValTok{0}\NormalTok{,regex}\OperatorTok{=}\VariableTok{True}\NormalTok{)}
\NormalTok{df\_firjan }\OperatorTok{=}\NormalTok{ df\_firjan.rename(columns}\OperatorTok{=}\NormalTok{\{}\StringTok{\textquotesingle{}IFGF 2020\textquotesingle{}}\NormalTok{:}\StringTok{\textquotesingle{}Qualidade de Gestão Fiscal\textquotesingle{}}\NormalTok{\})}

\NormalTok{dfs }\OperatorTok{=}\NormalTok{ [df\_ICMS,df\_IPTU,df\_ISS,df\_firjan]}

\NormalTok{subdet\_tri }\OperatorTok{=} \BuiltInTok{reduce}\NormalTok{(}\KeywordTok{lambda}\NormalTok{ left,right: pd.merge(left, right, on}\OperatorTok{=}\NormalTok{[}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{], }
\NormalTok{                                                how}\OperatorTok{=}\StringTok{\textquotesingle{}outer\textquotesingle{}}\NormalTok{), dfs)}
\NormalTok{subdet\_tri }\OperatorTok{=}\NormalTok{ subdet\_tri.merge(database, how}\OperatorTok{=}\StringTok{\textquotesingle{}right\textquotesingle{}}\NormalTok{,on}\OperatorTok{=}\NormalTok{[}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{])}
\NormalTok{subdet\_tri[}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ subdet\_tri[}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{].astype(}\BuiltInTok{str}\NormalTok{)}
\NormalTok{subdet\_tri }\OperatorTok{=}\NormalTok{ subdet\_tri.merge(amostra, how}\OperatorTok{=}\StringTok{\textquotesingle{}right\textquotesingle{}}\NormalTok{, on}\OperatorTok{=}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{)}
\NormalTok{interesse}\OperatorTok{=}\NormalTok{[}\StringTok{\textquotesingle{}NOME DO MUNICÍPIO\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\_x\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Alíquota Interna do ICMS\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Alíquota Interna do IPTU\textquotesingle{}}\NormalTok{,}
           \StringTok{\textquotesingle{}Alíquota Interna do ISS\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Qualidade de Gestão Fiscal\textquotesingle{}}\NormalTok{]}
\NormalTok{subdet\_tri }\OperatorTok{=}\NormalTok{ subdet\_tri[interesse]}
\NormalTok{subdet\_tri }\OperatorTok{=}\NormalTok{ subdet\_tri.rename(columns}\OperatorTok{=}\NormalTok{\{}\StringTok{\textquotesingle{}UF\_x\textquotesingle{}}\NormalTok{:}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}NOME DO MUNICÍPIO\textquotesingle{}}\NormalTok{:}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{\})}
\NormalTok{subdet\_tri }\OperatorTok{=}\NormalTok{ subdet\_tri.set\_index([}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{])}

\CommentTok{\# Tratamento para os indicadores com impacto negativo no índice}
\NormalTok{subdet\_tri.iloc[:,}\DecValTok{0}\NormalTok{] }\OperatorTok{=}\NormalTok{ negative(subdet\_tri.iloc[:,}\DecValTok{0}\NormalTok{])}
\NormalTok{subdet\_tri.iloc[:,}\DecValTok{1}\NormalTok{] }\OperatorTok{=}\NormalTok{ negative(subdet\_tri.iloc[:,}\DecValTok{1}\NormalTok{])}
\NormalTok{subdet\_tri.iloc[:,}\DecValTok{2}\NormalTok{] }\OperatorTok{=}\NormalTok{ negative(subdet\_tri.iloc[:,}\DecValTok{2}\NormalTok{])}

\CommentTok{\# Tratamentos de para os missing e outliers}
\NormalTok{missing\_data(subdet\_tri)}
\NormalTok{extreme\_values(subdet\_tri)}

\CommentTok{\# Criando o subdeterminante}
\NormalTok{create\_subindex(subdet\_tri, subdet)}
\NormalTok{ambiente[subdet] }\OperatorTok{=}\NormalTok{ subdet\_tri}
\end{Highlighting}
\end{Shaded}

\hypertarget{script_2.1.3}{%
\paragraph*{Subdeterminante Complexidade
Burocrática}\label{script_2.1.3}}
\addcontentsline{toc}{paragraph}{Subdeterminante Complexidade
Burocrática}

\begin{itemize}
\tightlist
\item
  Para retornar ao relatório do Subdeterminante Complexidade Burocrática
  \protect\hyperlink{subdet_complexidade}{clique aqui}.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Indicando o Subdeterminante}
\NormalTok{subdet }\OperatorTok{=} \StringTok{\textquotesingle{}Complexidade Burocrática\textquotesingle{}}

\CommentTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\# Indicador de Simplicidade Tributária \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\CommentTok{\#\#\# Sinconfi: selecionando tributos}
\NormalTok{tributos }\OperatorTok{=}\NormalTok{ [}\StringTok{\textquotesingle{}1.1.1.2.01.0.0 {-} Imposto sobre a Propriedade Territorial Rural\textquotesingle{}}\NormalTok{, }
            \StringTok{\textquotesingle{}1.1.1.3.00.0.0 {-} Impostos sobre a Renda e Proventos de Qualquer Natureza\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.1.1.3.03.1.0 {-} Imposto sobre a Renda {-} Retido na Fonte – Trabalho\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.1.1.3.03.2.0 {-} Imposto sobre a Renda {-} Retido na Fonte – Capital\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.1.1.3.03.3.0 {-} Imposto sobre a Renda {-} Retido na Fonte {-} Remessa ao Exterior\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.1.1.3.03.4.0 {-} Imposto sobre a Renda {-} Retido na Fonte {-} Outros Rendimentos\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.1.1.8.01.1.0 {-} Imposto sobre a Propriedade Predial e Territorial Urbana\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.1.1.8.01.4.0 {-} Imposto sobre Transmissão ¿Inter Vivos¿ de Bens Imóveis e de Direitos Reais sobre Imóveis\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.1.1.8.02.1.0 {-} Imposto sobre Operações Relativas à Circulação de Mercadorias e sobre Prestações de Serviços de Transporte Interestadual e Intermunicipal e de Comunicação\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.1.1.8.02.3.0 {-} Imposto sobre Serviços de Qualquer Natureza\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.1.1.8.02.4.0 {-} Adicional ISS {-} Fundo Municipal de Combate à Pobreza\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.1.1.8.02.5.0 {-} Imposto sobre Vendas a Varejo de Combustíveis Líquidos e Gasosos (IVVC)\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.1.2.1.00.0.0 {-} Taxas pelo Exercício do Poder de Polícia\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.1.2.1.01.0.0 {-} Taxas de Inspeção, Controle e Fiscalização\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.1.2.1.02.0.0 {-} Taxas de Fiscalização das Telecomunicações\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.1.2.1.03.0.0 {-} Taxa de Controle e Fiscalização de Produtos Químicos\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.1.2.1.04.0.0 {-} Taxa de Controle e Fiscalização Ambiental\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.1.2.1.05.0.0 {-} Taxa de Controle e Fiscalização da Pesca e Aquicultura\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.1.2.2.01.0.0 {-} Taxas pela Prestação de Serviços\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.1.2.2.02.0.0 {-} Emolumentos e Custas Judiciais\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.1.3.8.00.0.0 {-} Contribuição de Melhoria {-} Específica de Estados, DF e Municípios\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.2.1.0.01.0.0 {-} Contribuição para o Financiamento da Seguridade Social – COFINS\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.2.1.0.02.0.0 {-} Contribuição Social sobre o Lucro Líquido – CSLL\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.2.1.0.03.0.0 {-} Contribuições para o Regime Geral de Previdência Social – RGPS\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.2.1.0.04.1.0 {-} Contribuição Patronal de Servidor Ativo Civil para o RPPS\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.2.1.0.04.2.0 {-} Contribuição do Servidor Ativo Civil para o RPPS\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.2.1.0.04.3.0 {-} Contribuição do Servidor Inativo para o RPPS\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.2.1.0.04.4.0 {-} Contribuição do Pensionista para o RPPS\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.2.1.0.04.5.0 {-} Contribuição Patronal para o RPPS Oriunda de Sentenças Judiciais\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.2.1.0.04.6.0 {-} Contribuição do Servidor Ativo ao RPPS Oriunda de Sentenças Judiciais\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.2.1.0.04.7.0 {-} Contribuição do Servidor Inativo ao RPPS Oriunda de Sentenças Judiciais\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.2.1.0.04.8.0 {-} Contribuição do Pensionista ao RPPS Oriunda de Sentenças Judiciais\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.2.1.0.06.1.0 {-} Contribuição para os Fundos de Assistência Médica {-} Policiais Militares\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.2.1.0.06.2.0 {-} Contribuição para os Fundos de Assistência Médica dos Bombeiros Militares\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.2.1.0.06.3.0 {-} Contribuição para os Fundos de Assistência Médica dos Servidores Civis\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.2.1.0.06.9.0 {-} Contribuição para os Fundos de Assistência Médica de Outros Beneficiários\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.2.1.0.09.0.0 {-} Contribuição para os Programas de Integração Social e de Formação do Patrimônio do Servidor Público {-} PIS e PASEP\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.2.1.0.10.0.0 {-} Cota{-}Parte da Contribuição Sindical\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.2.1.0.11.0.0 {-} Contribuições Referentes ao Fundo de Garantia do Tempo de Serviço – FGTS\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.2.1.0.12.0.0 {-} Contribuição Social do Salário{-}Educação\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.2.1.0.99.0.0 {-} Outras Contribuições Sociais\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.2.1.8.01.1.0 {-} Contribuição Previdenciária para Amortização do Déficit Atuarial\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.2.1.8.01.2.0 {-} Contribuição Patronal dos Servidores Civis Inativos\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.2.1.8.01.3.0 {-} Contribuição Patronal dos Pensionistas Civis\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.2.1.8.02.2.0 {-} Contribuição do Militar Ativo\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.2.1.8.02.3.0 {-} Contribuição do Militar Inativo\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.2.2.8.00.0.0 {-} Contribuições Econômicas Específicas de EST/DF/MUN\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.2.3.0.00.0.0 {-} Contribuições para Entidades Privadas de Serviço Social e de Formação Profissional\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.2.4.0.00.0.0 {-} Contribuição para o Custeio do Serviço de Iluminação Pública\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.1.1.0.00.0.0 {-} Impostos\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.1.2.0.00.0.0 {-} Taxas\textquotesingle{}}\NormalTok{,}
            \StringTok{\textquotesingle{}1.2.0.0.00.0.0 {-} Contribuições\textquotesingle{}}\NormalTok{]}

\NormalTok{iv }\OperatorTok{=}\NormalTok{ [}\StringTok{\textquotesingle{}1.1.1.2.01.0.0 {-} Imposto sobre a Propriedade Territorial Rural\textquotesingle{}}\NormalTok{,}
      \StringTok{\textquotesingle{}1.1.1.3.03.0.0 {-} Imposto sobre a Renda {-} Retido na Fonte\textquotesingle{}}\NormalTok{,}
      \StringTok{\textquotesingle{}1.1.1.8.01.1.0 {-} Imposto sobre a Propriedade Predial e Territorial Urbana\textquotesingle{}}\NormalTok{,}
      \StringTok{\textquotesingle{}1.1.1.8.01.4.0 {-} Imposto sobre Transmissão ¿Inter Vivos¿ de Bens Imóveis e de Direitos Reais sobre Imóveis\textquotesingle{}}\NormalTok{,}
      \StringTok{\textquotesingle{}TOTAL DAS RECEITAS (III) = (I + II)\textquotesingle{}}\NormalTok{]}

\CommentTok{\# Função para criar o IHH com base nos tributos}
\KeywordTok{def}\NormalTok{ sinconfi\_ihh(df1,df2):}
\NormalTok{    df\_mun }\OperatorTok{=}\NormalTok{ df1.query(}\StringTok{\textquotesingle{}Conta in @tributos\textquotesingle{}}\NormalTok{)}
\NormalTok{    df\_mun[}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ df\_mun[}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{].astype(np.int64)}
\NormalTok{    df\_mun }\OperatorTok{=}\NormalTok{ database.merge(df\_mun, how}\OperatorTok{=}\StringTok{\textquotesingle{}left\textquotesingle{}}\NormalTok{, on }\OperatorTok{=}\NormalTok{ [}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{])}
\NormalTok{    df\_mun }\OperatorTok{=}\NormalTok{ df\_mun[[}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Conta\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Valor\textquotesingle{}}\NormalTok{]]}
    
\NormalTok{    df\_uf }\OperatorTok{=}\NormalTok{ df2.query(}\StringTok{\textquotesingle{}Conta in @tributos\textquotesingle{}}\NormalTok{)}
\NormalTok{    df\_uf }\OperatorTok{=}\NormalTok{ df\_uf[df\_uf[}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{] }\OperatorTok{==} \StringTok{\textquotesingle{}DF\textquotesingle{}}\NormalTok{]}
\NormalTok{    df\_uf[}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ [}\StringTok{\textquotesingle{}BRASILIA\textquotesingle{}}\NormalTok{] }\OperatorTok{*} \BuiltInTok{len}\NormalTok{(df\_uf)}
\NormalTok{    df\_uf }\OperatorTok{=}\NormalTok{ df\_uf[[}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Conta\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Valor\textquotesingle{}}\NormalTok{]]}
    
\NormalTok{    df\_ihh }\OperatorTok{=}\NormalTok{ df\_mun.append(df\_uf).reset\_index(drop}\OperatorTok{=}\VariableTok{True}\NormalTok{)}
\NormalTok{    df\_ihh }\OperatorTok{=}\NormalTok{ df\_ihh.pivot\_table(index}\OperatorTok{=}\NormalTok{[}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{], columns}\OperatorTok{=}\StringTok{\textquotesingle{}Conta\textquotesingle{}}\NormalTok{, values}\OperatorTok{=}\StringTok{\textquotesingle{}Valor\textquotesingle{}}\NormalTok{,}
\NormalTok{                                aggfunc}\OperatorTok{=}\NormalTok{np.}\BuiltInTok{sum}\NormalTok{,fill\_value}\OperatorTok{=}\DecValTok{0}\NormalTok{)}
    
\NormalTok{    df\_ihh[}\StringTok{\textquotesingle{}Total I + T + C\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ df\_ihh[}\StringTok{\textquotesingle{}1.1.1.0.00.0.0 {-} Impostos\textquotesingle{}}\NormalTok{] }\OperatorTok{+}\NormalTok{ df\_ihh[}\StringTok{\textquotesingle{}1.1.2.0.00.0.0 {-} Taxas\textquotesingle{}}\NormalTok{] }\OperatorTok{+}\NormalTok{ df\_ihh[}\StringTok{\textquotesingle{}1.2.0.0.00.0.0 {-} Contribuições\textquotesingle{}}\NormalTok{]}
    \KeywordTok{del}\NormalTok{ df\_ihh[}\StringTok{\textquotesingle{}1.1.1.0.00.0.0 {-} Impostos\textquotesingle{}}\NormalTok{]}
    \KeywordTok{del}\NormalTok{ df\_ihh[}\StringTok{\textquotesingle{}1.1.2.0.00.0.0 {-} Taxas\textquotesingle{}}\NormalTok{]}
    \KeywordTok{del}\NormalTok{ df\_ihh[}\StringTok{\textquotesingle{}1.2.0.0.00.0.0 {-} Contribuições\textquotesingle{}}\NormalTok{]}
\NormalTok{    df\_ihh }\OperatorTok{=}\NormalTok{ df\_ihh.}\BuiltInTok{apply}\NormalTok{(}\KeywordTok{lambda}\NormalTok{ x: x}\OperatorTok{/}\NormalTok{df\_ihh[}\StringTok{\textquotesingle{}Total I + T + C\textquotesingle{}}\NormalTok{])}
\NormalTok{    df\_ihh }\OperatorTok{=}\NormalTok{ df\_ihh.}\BuiltInTok{apply}\NormalTok{(np.square)}
    \KeywordTok{del}\NormalTok{ df\_ihh[}\StringTok{\textquotesingle{}Total I + T + C\textquotesingle{}}\NormalTok{]}
\NormalTok{    df\_ihh[}\StringTok{\textquotesingle{}IHH\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ df\_ihh.}\BuiltInTok{sum}\NormalTok{(axis}\OperatorTok{=}\DecValTok{1}\NormalTok{)}
      
    \BuiltInTok{globals}\NormalTok{()[}\StringTok{\textquotesingle{}df\_ihh\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ df\_ihh[}\StringTok{\textquotesingle{}IHH\textquotesingle{}}\NormalTok{].to\_frame()}
    
\NormalTok{sinconfi\_ihh(sinconfi\_mun, sinconfi\_uf)}

\CommentTok{\# Função para criar o iv com base nos tributos e receitas }
\KeywordTok{def}\NormalTok{ sinconfi\_iv(df1,df2):}
\NormalTok{    df1 }\OperatorTok{=}\NormalTok{ df1.query(}\StringTok{\textquotesingle{}Conta in @iv\textquotesingle{}}\NormalTok{)}
\NormalTok{    df1 }\OperatorTok{=}\NormalTok{ df1[df1[}\StringTok{\textquotesingle{}Coluna\textquotesingle{}}\NormalTok{] }\OperatorTok{==} \StringTok{\textquotesingle{}Receitas Brutas Realizadas\textquotesingle{}}\NormalTok{]}
\NormalTok{    df1[}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ df1[}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{].astype(np.int64)}
\NormalTok{    df1 }\OperatorTok{=}\NormalTok{ database.merge(df1, how}\OperatorTok{=}\StringTok{\textquotesingle{}left\textquotesingle{}}\NormalTok{, on }\OperatorTok{=}\NormalTok{ [}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{])}
\NormalTok{    df1 }\OperatorTok{=}\NormalTok{ df1[[}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Conta\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Valor\textquotesingle{}}\NormalTok{]].dropna()}

\NormalTok{    df2 }\OperatorTok{=}\NormalTok{ df2.query(}\StringTok{\textquotesingle{}Conta in @iv\textquotesingle{}}\NormalTok{)}
\NormalTok{    df2 }\OperatorTok{=}\NormalTok{ df2[df2[}\StringTok{\textquotesingle{}Coluna\textquotesingle{}}\NormalTok{] }\OperatorTok{==} \StringTok{\textquotesingle{}Receitas Brutas Realizadas\textquotesingle{}}\NormalTok{]}
\NormalTok{    df2 }\OperatorTok{=}\NormalTok{ df2[df2[}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{] }\OperatorTok{==} \StringTok{\textquotesingle{}DF\textquotesingle{}}\NormalTok{]}
\NormalTok{    df2[}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ [}\StringTok{\textquotesingle{}BRASILIA\textquotesingle{}}\NormalTok{] }\OperatorTok{*} \BuiltInTok{len}\NormalTok{(df2)}
\NormalTok{    df2 }\OperatorTok{=}\NormalTok{ df2[[}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Conta\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Valor\textquotesingle{}}\NormalTok{]]}

\NormalTok{    df3 }\OperatorTok{=}\NormalTok{ df1.append(df2).reset\_index(drop}\OperatorTok{=}\VariableTok{True}\NormalTok{)}
\NormalTok{    df3 }\OperatorTok{=}\NormalTok{ df3.pivot\_table(index}\OperatorTok{=}\NormalTok{[}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{], columns}\OperatorTok{=}\StringTok{\textquotesingle{}Conta\textquotesingle{}}\NormalTok{, values}\OperatorTok{=}\StringTok{\textquotesingle{}Valor\textquotesingle{}}\NormalTok{,}
\NormalTok{                          fill\_value}\OperatorTok{=}\DecValTok{0}\NormalTok{, aggfunc}\OperatorTok{=}\NormalTok{np.}\BuiltInTok{sum}\NormalTok{)}
\NormalTok{    df3[}\StringTok{\textquotesingle{}Total Impostos\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ df3[}\StringTok{\textquotesingle{}1.1.1.2.01.0.0 {-} Imposto sobre a Propriedade Territorial Rural\textquotesingle{}}\NormalTok{] }\OperatorTok{+}\NormalTok{ df3[}\StringTok{\textquotesingle{}1.1.1.3.03.0.0 {-} Imposto sobre a Renda {-} Retido na Fonte\textquotesingle{}}\NormalTok{] }\OperatorTok{+}\NormalTok{ df3[}\StringTok{\textquotesingle{}1.1.1.8.01.1.0 {-} Imposto sobre a Propriedade Predial e Territorial Urbana\textquotesingle{}}\NormalTok{] }\OperatorTok{+}\NormalTok{ df3[}\StringTok{\textquotesingle{}1.1.1.8.01.4.0 {-} Imposto sobre Transmissão ¿Inter Vivos¿ de Bens Imóveis e de Direitos Reais sobre Imóveis\textquotesingle{}}\NormalTok{]}
    \KeywordTok{del}\NormalTok{ df3[}\StringTok{\textquotesingle{}1.1.1.2.01.0.0 {-} Imposto sobre a Propriedade Territorial Rural\textquotesingle{}}\NormalTok{]}
    \KeywordTok{del}\NormalTok{ df3[}\StringTok{\textquotesingle{}1.1.1.3.03.0.0 {-} Imposto sobre a Renda {-} Retido na Fonte\textquotesingle{}}\NormalTok{]}
    \KeywordTok{del}\NormalTok{ df3[}\StringTok{\textquotesingle{}1.1.1.8.01.1.0 {-} Imposto sobre a Propriedade Predial e Territorial Urbana\textquotesingle{}}\NormalTok{] }
    \KeywordTok{del}\NormalTok{ df3[}\StringTok{\textquotesingle{}1.1.1.8.01.4.0 {-} Imposto sobre Transmissão ¿Inter Vivos¿ de Bens Imóveis e de Direitos Reais sobre Imóveis\textquotesingle{}}\NormalTok{]}
\NormalTok{    df3[}\StringTok{\textquotesingle{}Total\_receitas\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ df3[}\StringTok{\textquotesingle{}TOTAL DAS RECEITAS (III) = (I + II)\textquotesingle{}}\NormalTok{]}
\NormalTok{    df3[}\StringTok{\textquotesingle{}ind\_v\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ df3[}\StringTok{\textquotesingle{}Total Impostos\textquotesingle{}}\NormalTok{]}\OperatorTok{/}\NormalTok{df3[}\StringTok{\textquotesingle{}Total\_receitas\textquotesingle{}}\NormalTok{]}
    
    \BuiltInTok{globals}\NormalTok{()[}\StringTok{\textquotesingle{}df\_iv\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ df3[}\StringTok{\textquotesingle{}ind\_v\textquotesingle{}}\NormalTok{].to\_frame()}
    
\NormalTok{sinconfi\_iv(sinconfi\_mun, sinconfi\_uf)}

\NormalTok{ind\_simpli\_tri }\OperatorTok{=}\NormalTok{ df\_ihh.merge(df\_iv, how}\OperatorTok{=}\StringTok{\textquotesingle{}left\textquotesingle{}}\NormalTok{, on}\OperatorTok{=}\NormalTok{[}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{])}

\NormalTok{ind\_simpli\_tri[}\StringTok{\textquotesingle{}Simplicidade Tributária\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ ind\_simpli\_tri[}\StringTok{\textquotesingle{}IHH\textquotesingle{}}\NormalTok{]}\OperatorTok{*}\NormalTok{ind\_simpli\_tri[}\StringTok{\textquotesingle{}ind\_v\textquotesingle{}}\NormalTok{]}

\NormalTok{ind\_simpli\_tri }\OperatorTok{=}\NormalTok{ ind\_simpli\_tri.merge(database, how}\OperatorTok{=}\StringTok{\textquotesingle{}right\textquotesingle{}}\NormalTok{,on}\OperatorTok{=}\NormalTok{[}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{])}
\NormalTok{ind\_simpli\_tri[}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ ind\_simpli\_tri[}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{].astype(}\BuiltInTok{str}\NormalTok{)}
\NormalTok{subdet\_complexidade }\OperatorTok{=}\NormalTok{ ind\_simpli\_tri.merge(amostra, how}\OperatorTok{=}\StringTok{\textquotesingle{}right\textquotesingle{}}\NormalTok{, on}\OperatorTok{=}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{)}
\NormalTok{interesse}\OperatorTok{=}\NormalTok{[}\StringTok{\textquotesingle{}NOME DO MUNICÍPIO\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\_x\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Simplicidade Tributária\textquotesingle{}}\NormalTok{]}
\NormalTok{subdet\_complexidade }\OperatorTok{=}\NormalTok{ subdet\_complexidade[interesse]}
\NormalTok{subdet\_complexidade }\OperatorTok{=}\NormalTok{ subdet\_complexidade.rename(columns}\OperatorTok{=}\NormalTok{\{}\StringTok{\textquotesingle{}UF\_x\textquotesingle{}}\NormalTok{:}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{,}
                                                          \StringTok{\textquotesingle{}NOME DO MUNICÍPIO\textquotesingle{}}\NormalTok{:}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{\})}

\CommentTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\# Indicador CNDs Municipais \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\NormalTok{df\_cnd }\OperatorTok{=}\NormalTok{ pd.read\_excel(}\StringTok{\textquotesingle{}DETERMINANTE AMBIENTE REGULATÓRIO/cnds\_municipais.xlsx\textquotesingle{}}\NormalTok{,}
\NormalTok{                       usecols}\OperatorTok{=}\StringTok{\textquotesingle{}A:C\textquotesingle{}}\NormalTok{)}
\NormalTok{subdet\_complexidade }\OperatorTok{=}\NormalTok{ subdet\_complexidade.merge(df\_cnd, how}\OperatorTok{=}\StringTok{\textquotesingle{}right\textquotesingle{}}\NormalTok{, on}\OperatorTok{=}\NormalTok{[}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{])}

\CommentTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\# Indicador Atualização de Zoneamento \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\NormalTok{df\_zoneamento }\OperatorTok{=}\NormalTok{ pd.read\_excel(}\StringTok{\textquotesingle{}Arquivos ICE {-} 23/Ind\_Originais\_ICE\_2022.xlsx\textquotesingle{}}\NormalTok{, header}\OperatorTok{=}\DecValTok{5}\NormalTok{,}
\NormalTok{                        usecols}\OperatorTok{=}\StringTok{"B:C,O"}\NormalTok{)}

\NormalTok{df\_zoneamento }\OperatorTok{=}\NormalTok{ df\_zoneamento.rename(columns}\OperatorTok{=}\NormalTok{\{}\StringTok{\textquotesingle{}2018.1\textquotesingle{}}\NormalTok{:}\StringTok{\textquotesingle{}Atualização de Zoneamento\textquotesingle{}}\NormalTok{,}
                                              \StringTok{\textquotesingle{}Ano\textquotesingle{}}\NormalTok{:}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{\})}
\NormalTok{df\_zoneamento[}\StringTok{\textquotesingle{}Atualização de Zoneamento\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ df\_zoneamento[}\StringTok{\textquotesingle{}Atualização de Zoneamento\textquotesingle{}}\NormalTok{] }\OperatorTok{+} \DecValTok{1}
\NormalTok{df\_zoneamento[}\StringTok{\textquotesingle{}Atualização de Zoneamento\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ np.where(df\_zoneamento[}\StringTok{\textquotesingle{}Atualização de Zoneamento\textquotesingle{}}\NormalTok{]}\OperatorTok{==}\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, df\_zoneamento[}\StringTok{\textquotesingle{}Atualização de Zoneamento\textquotesingle{}}\NormalTok{]) }

\NormalTok{subdet\_complexidade }\OperatorTok{=}\NormalTok{ subdet\_complexidade.merge(df\_zoneamento, how}\OperatorTok{=}\StringTok{\textquotesingle{}right\textquotesingle{}}\NormalTok{, on}\OperatorTok{=}\NormalTok{[}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{])}
\NormalTok{subdet\_complexidade }\OperatorTok{=}\NormalTok{ subdet\_complexidade.set\_index([}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{])}
\KeywordTok{del}\NormalTok{ subdet\_complexidade[}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{]}

\CommentTok{\# Tratamento para os indicadores com impacto negativo no índice}
\NormalTok{subdet\_complexidade.iloc[:,}\DecValTok{2}\NormalTok{] }\OperatorTok{=}\NormalTok{ negative(subdet\_complexidade.iloc[:,}\DecValTok{2}\NormalTok{])}

\CommentTok{\# Tratamentos de para os missing e outliers}
\NormalTok{missing\_data(subdet\_complexidade)}
\NormalTok{extreme\_values(subdet\_complexidade)}

\CommentTok{\# Criando o subdeterminante}
\NormalTok{create\_subindex(subdet\_complexidade, subdet)}
\NormalTok{ambiente[subdet] }\OperatorTok{=}\NormalTok{ subdet\_complexidade}

\CommentTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\# Criando o determinante de Ambiente Regulatório \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\NormalTok{ambiente }\OperatorTok{=}\NormalTok{ pd.concat(ambiente, axis}\OperatorTok{=}\DecValTok{1}\NormalTok{)}
\NormalTok{create\_detindex(ambiente, }\StringTok{\textquotesingle{}Ambiente Regulatório\textquotesingle{}}\NormalTok{)}

\NormalTok{ambiente.to\_csv(}\StringTok{\textquotesingle{}DETERMINANTES/det{-}AMBIENTE REGULATÓRIO.csv\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{script_2.2}{%
\subsubsection*{Determinante Infraestrutura}\label{script_2.2}}
\addcontentsline{toc}{subsubsection}{Determinante Infraestrutura}

\hypertarget{script_2.3}{%
\subsubsection*{Determinante Mercado}\label{script_2.3}}
\addcontentsline{toc}{subsubsection}{Determinante Mercado}

\hypertarget{script_2.4}{%
\subsubsection*{Determinante Acesso a Capital}\label{script_2.4}}
\addcontentsline{toc}{subsubsection}{Determinante Acesso a Capital}

\begin{itemize}
\tightlist
\item
  Para retornar ao relatório do Determinante Acesso a Capital
  \protect\hyperlink{det_acesso_capital}{clique aqui}.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Criando o ambiente que criará o determinante}
\NormalTok{acesso\_capital }\OperatorTok{=}\NormalTok{ \{\}}
\end{Highlighting}
\end{Shaded}

\hypertarget{script_2.4.1}{%
\paragraph*{Subdeterminante Capital Disponível}\label{script_2.4.1}}
\addcontentsline{toc}{paragraph}{Subdeterminante Capital Disponível}

\begin{itemize}
\tightlist
\item
  Para retornar ao relatório do Subdeterminante Capital Disponível
  \protect\hyperlink{subdet_cap_disp}{clique aqui}.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Indicando o subdeterminante }
\NormalTok{subdet }\OperatorTok{=} \StringTok{\textquotesingle{}Capital Disponível\textquotesingle{}}

\CommentTok{\#\#\# 2.5.1. e 2.5.3.}

\NormalTok{base }\OperatorTok{=} \StringTok{\textquotesingle{}\textasciigrave{}basedosdados.br\_ibge\_pib.municipio\textasciigrave{}\textquotesingle{}}
\NormalTok{project\_id }\OperatorTok{=} \StringTok{\textquotesingle{}double{-}balm{-}306418\textquotesingle{}}
\NormalTok{var }\OperatorTok{=}\NormalTok{ (}\StringTok{\textquotesingle{}id\_municipio, pib\textquotesingle{}}\NormalTok{)}
\NormalTok{cod\_ibge }\OperatorTok{=} \BuiltInTok{tuple}\NormalTok{(database[}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{].astype(}\BuiltInTok{str}\NormalTok{))}
\NormalTok{query }\OperatorTok{=} \SpecialStringTok{f\textquotesingle{}SELECT }\SpecialCharTok{\{}\NormalTok{var}\SpecialCharTok{\}}\SpecialStringTok{ FROM }\SpecialCharTok{\{}\NormalTok{base}\SpecialCharTok{\}}\SpecialStringTok{ WHERE ano = 2019 AND id\_municipio IN }\SpecialCharTok{\{}\NormalTok{cod\_ibge}\SpecialCharTok{\}}\SpecialStringTok{\textquotesingle{}}
\NormalTok{pib\_mun }\OperatorTok{=}\NormalTok{ bd.read\_sql(query}\OperatorTok{=}\NormalTok{query,billing\_project\_id}\OperatorTok{=}\NormalTok{project\_id)}
\NormalTok{pib\_mun }\OperatorTok{=}\NormalTok{ pib\_mun.rename(columns}\OperatorTok{=}\NormalTok{\{}\StringTok{\textquotesingle{}id\_municipio\textquotesingle{}}\NormalTok{:}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{\})}

\CommentTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\# Indicador Operações de Crédito por Município \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\NormalTok{df\_bcb }\OperatorTok{=}\NormalTok{ pd.read\_excel(}\StringTok{\textquotesingle{}DETERMINANTE ACESSO A CAPITAL/202112\_ESTBAN.xlsx\textquotesingle{}}\NormalTok{, }
\NormalTok{                       header}\OperatorTok{=}\DecValTok{2}\NormalTok{, usecols}\OperatorTok{=}\StringTok{"B,D,V,AQ,AT"}\NormalTok{)}
\NormalTok{df\_bcb }\OperatorTok{=}\NormalTok{ df\_bcb.rename(columns}\OperatorTok{=}\NormalTok{\{}\StringTok{\textquotesingle{}MUNICIPIO\textquotesingle{}}\NormalTok{:}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{\})}
\NormalTok{df\_bcb }\OperatorTok{=}\NormalTok{ database.merge(df\_bcb, how}\OperatorTok{=}\StringTok{\textquotesingle{}left\textquotesingle{}}\NormalTok{,on}\OperatorTok{=}\NormalTok{[}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{])}
\NormalTok{df\_bcb }\OperatorTok{=}\NormalTok{ df\_bcb.groupby(by}\OperatorTok{=}\NormalTok{[}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}pop\_est\textquotesingle{}}\NormalTok{]).}\BuiltInTok{sum}\NormalTok{()}
\NormalTok{df\_bcb }\OperatorTok{=}\NormalTok{ df\_bcb.reset\_index().merge(pib\_mun, how}\OperatorTok{=}\StringTok{\textquotesingle{}left\textquotesingle{}}\NormalTok{, on}\OperatorTok{=}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{).set\_index([}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{])}
\NormalTok{df\_bcb[}\StringTok{\textquotesingle{}Operações de Crédito por Município\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ df\_bcb[}\StringTok{\textquotesingle{}VERBETE\_160\_OPERACOES\_DE\_CREDITO\textquotesingle{}}\NormalTok{]}\OperatorTok{/}\NormalTok{df\_bcb[}\StringTok{\textquotesingle{}pib\textquotesingle{}}\NormalTok{]}

\CommentTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\# Indicador Capital Poupado per capita \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\NormalTok{df\_bcb[}\StringTok{\textquotesingle{}420+432\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ df\_bcb[}\StringTok{\textquotesingle{}VERBETE\_420\_DEPOSITOS\_DE\_POUPANCA\textquotesingle{}}\NormalTok{] }\OperatorTok{+}\NormalTok{ df\_bcb[}\StringTok{\textquotesingle{}VERBETE\_432\_DEPOSITOS\_A\_PRAZO\textquotesingle{}}\NormalTok{]}
\NormalTok{df\_bcb[}\StringTok{\textquotesingle{}Capital Poupado per capita\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ df\_bcb[}\StringTok{\textquotesingle{}420+432\textquotesingle{}}\NormalTok{]}\OperatorTok{/}\NormalTok{df\_bcb[}\StringTok{\textquotesingle{}pop\_est\textquotesingle{}}\NormalTok{].astype(np.int64)}

\NormalTok{subdet\_capital\_disp }\OperatorTok{=}\NormalTok{ df\_bcb.iloc[:,[}\DecValTok{0}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{8}\NormalTok{]]}
\NormalTok{subdet\_capital\_disp }\OperatorTok{=}\NormalTok{ subdet\_capital\_disp.merge(amostra, how}\OperatorTok{=}\StringTok{\textquotesingle{}right\textquotesingle{}}\NormalTok{, on}\OperatorTok{=}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{).rename(columns}\OperatorTok{=}\NormalTok{\{}\StringTok{\textquotesingle{}NOME DO MUNICÍPIO\textquotesingle{}}\NormalTok{:}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{\})}
\NormalTok{interesse}\OperatorTok{=}\NormalTok{[}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Operações de Crédito por Município\textquotesingle{}}\NormalTok{,}
           \StringTok{\textquotesingle{}Capital Poupado per capita\textquotesingle{}}\NormalTok{]}
\NormalTok{subdet\_capital\_disp }\OperatorTok{=}\NormalTok{ subdet\_capital\_disp[interesse]}

\CommentTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\# Indicador Proporção Relativa de Capital de Risco \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\NormalTok{df\_crunchbase }\OperatorTok{=}\NormalTok{ pd.read\_excel(}\StringTok{\textquotesingle{}DETERMINANTE ACESSO A CAPITAL/crunchbase\_2021.xlsx\textquotesingle{}}\NormalTok{, usecols}\OperatorTok{=}\StringTok{"A:C"}\NormalTok{).fillna(}\DecValTok{0}\NormalTok{)}
\NormalTok{df\_crunchbase[}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ df\_crunchbase[}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{].}\BuiltInTok{str}\NormalTok{.upper().}\BuiltInTok{str}\NormalTok{.normalize(}\StringTok{\textquotesingle{}NFKD\textquotesingle{}}\NormalTok{).}\BuiltInTok{str}\NormalTok{.encode(}\StringTok{\textquotesingle{}ascii\textquotesingle{}}\NormalTok{, errors}\OperatorTok{=}\StringTok{\textquotesingle{}ignore\textquotesingle{}}\NormalTok{).}\BuiltInTok{str}\NormalTok{.decode(}\StringTok{\textquotesingle{}utf{-}8\textquotesingle{}}\NormalTok{)}
\NormalTok{df\_crunchbase }\OperatorTok{=}\NormalTok{ database.merge(df\_crunchbase, how}\OperatorTok{=}\StringTok{\textquotesingle{}left\textquotesingle{}}\NormalTok{, on}\OperatorTok{=}\NormalTok{[}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{]).merge(pib\_mun, how}\OperatorTok{=}\StringTok{\textquotesingle{}left\textquotesingle{}}\NormalTok{,on}\OperatorTok{=}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{)}
\NormalTok{df\_crunchbase[}\StringTok{\textquotesingle{}Proporção Relativa de Capital de Risco\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ (df\_crunchbase[}\StringTok{\textquotesingle{}Total funding amount\textquotesingle{}}\NormalTok{]}\OperatorTok{*}\NormalTok{(}\FloatTok{5.3950}\NormalTok{)}\OperatorTok{/}\NormalTok{df\_crunchbase[}\StringTok{\textquotesingle{}pib\textquotesingle{}}\NormalTok{])}\OperatorTok{*}\DecValTok{100}

\CommentTok{\# Organizando a ordem os indicadores para calcular o subdeterminante/determinante}
\NormalTok{subdet\_capital\_disp }\OperatorTok{=}\NormalTok{ subdet\_capital\_disp.merge(df\_crunchbase, how}\OperatorTok{=}\StringTok{\textquotesingle{}right\textquotesingle{}}\NormalTok{, on}\OperatorTok{=}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{)}
\NormalTok{interesse}\OperatorTok{=}\NormalTok{[}\StringTok{\textquotesingle{}Município\_x\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\_x\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Operações de Crédito por Município\textquotesingle{}}\NormalTok{,}
           \StringTok{\textquotesingle{}Proporção Relativa de Capital de Risco\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Capital Poupado per capita\textquotesingle{}}\NormalTok{]}
\NormalTok{subdet\_capital\_disp }\OperatorTok{=}\NormalTok{ subdet\_capital\_disp[interesse]}
\NormalTok{subdet\_capital\_disp }\OperatorTok{=}\NormalTok{ subdet\_capital\_disp.rename(columns}\OperatorTok{=}\NormalTok{\{}\StringTok{\textquotesingle{}Município\_x\textquotesingle{}}\NormalTok{:}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,}
                                                          \StringTok{\textquotesingle{}UF\_x\textquotesingle{}}\NormalTok{:}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{\})}
\NormalTok{subdet\_capital\_disp }\OperatorTok{=}\NormalTok{ subdet\_capital\_disp.set\_index([}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{])}

\CommentTok{\# Tratamentos de para os missing e outliers}
\NormalTok{missing\_data(subdet\_capital\_disp)}
\NormalTok{extreme\_values(subdet\_capital\_disp)}

\CommentTok{\# Criando o subdeterminante}
\NormalTok{create\_subindex(subdet\_capital\_disp, subdet)}
\NormalTok{acesso\_capital[subdet] }\OperatorTok{=}\NormalTok{ subdet\_capital\_disp}

\CommentTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\# Criando o Determinante Acesso a Capital \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\NormalTok{acesso\_capital }\OperatorTok{=}\NormalTok{ pd.concat(acesso\_capital, axis}\OperatorTok{=}\DecValTok{1}\NormalTok{)}
\NormalTok{create\_detindex(acesso\_capital, }\StringTok{\textquotesingle{}Acesso a Capital\textquotesingle{}}\NormalTok{)}

\NormalTok{acesso\_capital.to\_csv(}\StringTok{\textquotesingle{}DETERMINANTES/det{-}ACESSO A CAPITAL.csv\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{script_2.5}{%
\subsubsection*{Determinante Inovação}\label{script_2.5}}
\addcontentsline{toc}{subsubsection}{Determinante Inovação}

\begin{itemize}
\tightlist
\item
  Para retornar ao relatório do Determinante Inovação
  \protect\hyperlink{det_inovacao}{clique aqui}.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Criando o ambiente que criará o determinante}
\NormalTok{inovacao }\OperatorTok{=}\NormalTok{ \{\}}
\end{Highlighting}
\end{Shaded}

\hypertarget{script_2.5.1}{%
\paragraph{Subdeterminante Inputs}\label{script_2.5.1}}

\begin{itemize}
\tightlist
\item
  Para retornar ao relatório do Subdeterminante Inputs
  \protect\hyperlink{subdet_input}{clique aqui}.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Indicando o subdeterminante}
\NormalTok{subdet }\OperatorTok{=} \StringTok{\textquotesingle{}Inputs\textquotesingle{}}

\CommentTok{\#\#\#\#\#\#\#\#\#\# 2.6.1.1. Indicador Proporção de Mestres e Doutores em C\&T \#\#\#\#\#\#\#\#\#\#\#}
\NormalTok{variaveis }\OperatorTok{=}\NormalTok{ (}\StringTok{\textquotesingle{}COUNT(quantidade\_vinculos\_ativos), id\_municipio\textquotesingle{}}\NormalTok{)}
\NormalTok{base }\OperatorTok{=} \StringTok{\textquotesingle{}\textasciigrave{}basedosdados.br\_me\_rais.microdados\_estabelecimentos\textasciigrave{}\textquotesingle{}}
\NormalTok{project\_id }\OperatorTok{=} \StringTok{\textquotesingle{}double{-}balm{-}306418\textquotesingle{}}
\NormalTok{cod\_ibge }\OperatorTok{=} \BuiltInTok{tuple}\NormalTok{(database[}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{].astype(}\BuiltInTok{str}\NormalTok{))}
\NormalTok{query }\OperatorTok{=} \SpecialStringTok{f"SELECT }\SpecialCharTok{\{}\NormalTok{variaveis}\SpecialCharTok{\}}\SpecialStringTok{ FROM }\SpecialCharTok{\{}\NormalTok{base}\SpecialCharTok{\}}\SpecialStringTok{ WHERE ano = 2020 AND quantidade\_vinculos\_ativos \textgreater{} 0 GROUP BY id\_municipio"}

\CommentTok{\#\# Importando o data lake}
\NormalTok{df\_rais }\OperatorTok{=}\NormalTok{ bd.read\_sql(query}\OperatorTok{=}\NormalTok{query, billing\_project\_id}\OperatorTok{=}\NormalTok{project\_id)}
\NormalTok{df\_rais }\OperatorTok{=}\NormalTok{ df\_rais.rename(columns}\OperatorTok{=}\NormalTok{\{}\StringTok{\textquotesingle{}id\_municipio\textquotesingle{}}\NormalTok{:}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{\}).set\_index(}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{)}
\NormalTok{df\_rais }\OperatorTok{=}\NormalTok{ database.merge(df\_rais,how}\OperatorTok{=}\StringTok{\textquotesingle{}left\textquotesingle{}}\NormalTok{,on}\OperatorTok{=}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{)}
\NormalTok{df\_rais[}\StringTok{\textquotesingle{}mil\_emp\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ df\_rais[}\StringTok{\textquotesingle{}f0\_\textquotesingle{}}\NormalTok{]}\OperatorTok{/}\DecValTok{1000}
\CommentTok{\#\# }
\NormalTok{df\_capes }\OperatorTok{=}\NormalTok{ pd.read\_excel(}\StringTok{\textquotesingle{}DETERMINANTE INOVAÇÃO/br{-}capes{-}colsucup{-}discentes{-}2020{-}2021{-}11{-}10.xlsx\textquotesingle{}}\NormalTok{, usecols}\OperatorTok{=}\StringTok{\textquotesingle{}D,P,Q,AD\textquotesingle{}}\NormalTok{)}
\NormalTok{df\_capes[}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ df\_capes[}\StringTok{\textquotesingle{}NM\_MUNICIPIO\_PROGRAMA\_IES\textquotesingle{}}\NormalTok{].}\BuiltInTok{str}\NormalTok{.normalize(}\StringTok{\textquotesingle{}NFKD\textquotesingle{}}\NormalTok{).}\BuiltInTok{str}\NormalTok{.encode(}\StringTok{\textquotesingle{}ascii\textquotesingle{}}\NormalTok{, errors}\OperatorTok{=}\StringTok{\textquotesingle{}ignore\textquotesingle{}}\NormalTok{).}\BuiltInTok{str}\NormalTok{.decode(}\StringTok{\textquotesingle{}utf{-}8\textquotesingle{}}\NormalTok{)}
\NormalTok{df\_capes }\OperatorTok{=}\NormalTok{ database.merge(df\_capes, how}\OperatorTok{=}\StringTok{\textquotesingle{}left\textquotesingle{}}\NormalTok{,on}\OperatorTok{=}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{)}

\NormalTok{areas }\OperatorTok{=}\NormalTok{ [}\StringTok{\textquotesingle{}astronomia / física\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}biotecnologia\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}ciência da computação\textquotesingle{}}\NormalTok{, }
         \StringTok{\textquotesingle{}ciência de alimentos\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}ciências agrárias I\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}ciências ambientais\textquotesingle{}}\NormalTok{, }
         \StringTok{\textquotesingle{}ciências biológicas I\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}ciências biológicas II\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}ciências biológicas III\textquotesingle{}}\NormalTok{, }
         \StringTok{\textquotesingle{}engenharias I\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}engenharias II\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}engenharias III\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}engenharias IV\textquotesingle{}}\NormalTok{, }
         \StringTok{\textquotesingle{}farmácia\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}geociências\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}matemática / probabilidade\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}estatística\textquotesingle{}}\NormalTok{, }
         \StringTok{\textquotesingle{}materiais e química\textquotesingle{}}\NormalTok{]}
\NormalTok{areas }\OperatorTok{=}\NormalTok{ [x.upper() }\ControlFlowTok{for}\NormalTok{ x }\KeywordTok{in}\NormalTok{ areas]}

\NormalTok{df\_capes }\OperatorTok{=}\NormalTok{ df\_capes[df\_capes[}\StringTok{\textquotesingle{}NM\_SITUACAO\_DISCENTE\textquotesingle{}}\NormalTok{] }\OperatorTok{==} \StringTok{\textquotesingle{}TITULADO\textquotesingle{}}\NormalTok{]}
\NormalTok{df\_capes }\OperatorTok{=}\NormalTok{ df\_capes.query(}\StringTok{\textquotesingle{}NM\_AREA\_AVALIACAO in @areas\textquotesingle{}}\NormalTok{)}
\NormalTok{df\_capes }\OperatorTok{=}\NormalTok{ df\_capes.groupby([}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{]).count()}
\NormalTok{df\_capes }\OperatorTok{=}\NormalTok{ df\_rais.merge(df\_capes, how}\OperatorTok{=}\StringTok{\textquotesingle{}left\textquotesingle{}}\NormalTok{, on}\OperatorTok{=}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{).fillna(}\DecValTok{0}\NormalTok{)}
\NormalTok{df\_capes[}\StringTok{\textquotesingle{}Proporção de Mestres e Doutores em C\&T\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ df\_capes[}\StringTok{\textquotesingle{}NM\_AREA\_AVALIACAO\textquotesingle{}}\NormalTok{]}\OperatorTok{/}\NormalTok{df\_capes[}\StringTok{\textquotesingle{}mil\_emp\textquotesingle{}}\NormalTok{]}

\NormalTok{interesse }\OperatorTok{=}\NormalTok{ [}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Proporção de Mestres e Doutores em C\&T\textquotesingle{}}\NormalTok{]}
\NormalTok{subdet\_input }\OperatorTok{=}\NormalTok{ df\_capes[interesse]}

\CommentTok{\#\#\#\#\#\#\#\#\#\#\#\#\# 2.6.1.2. Indicador Proporção de Funcionários em C\&T \#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\NormalTok{cbo\_2002 }\OperatorTok{=} \BuiltInTok{tuple}\NormalTok{([}\StringTok{\textquotesingle{}201105\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}201110\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}201115\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}201205\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}201210\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}201215\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}201220\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}201225\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}202105\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}202110\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}202115\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}202120\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}203005\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}203010\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}203015\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}203020\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}203025\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}203105\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}203110\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}203115\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}203120\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}203125\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}203205\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}203210\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}203215\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}203220\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}203225\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}203230\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}203305\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}203310\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}203315\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}203320\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}203405\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}203410\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}203415\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}203420\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}203505\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}203510\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}203515\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}203520\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}203525\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}204105\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}211105\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}211110\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}211115\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}211120\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}211205\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}211210\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}211215\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}212205\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}212210\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}212215\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}212305\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}212310\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}212315\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}212320\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}212405\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}212410\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}212415\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}212420\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}212425\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}212430\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}213105\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}213110\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}213115\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}213120\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}213125\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}213130\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}213135\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}213140\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}213145\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}213150\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}213155\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}213160\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}213165\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}213170\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}213175\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}213205\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}213210\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}213215\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}213305\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}213310\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}213315\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}213405\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}213410\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}213415\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}213420\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}213425\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}213430\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}213435\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}213440\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}214005\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214010\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214105\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214110\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214115\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214120\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214125\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}214130\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214205\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214210\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214215\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214220\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214225\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214230\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}214235\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214240\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214245\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214250\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214255\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214260\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214265\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}214270\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214280\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214305\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214310\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214315\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214320\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214325\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}214330\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214335\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214340\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214345\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214350\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214360\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214365\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}214370\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214405\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214410\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214415\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214420\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214425\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214430\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}214435\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214505\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214510\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214515\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214520\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214525\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214530\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}214535\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214605\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214610\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214615\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214705\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214710\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214715\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}214720\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214725\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214730\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214735\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214740\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214745\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214750\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}214805\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214810\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214905\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214910\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214915\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214920\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214925\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}214930\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214935\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214940\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}214945\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}215105\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}215110\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}215115\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}215120\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}215125\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}215130\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}215135\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}215140\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}215145\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}215150\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}215205\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}215210\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}215215\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}215220\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}215305\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}215310\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}215315\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}300105\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}300110\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}300305\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}301105\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}301110\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}301115\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}301205\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}311105\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}311110\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}311115\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}311205\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}311305\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}311405\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}311410\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}311505\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}311510\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}311515\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}311520\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}311605\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}311610\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}311615\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}311620\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}311625\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}311705\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}311710\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}311715\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}311720\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}311725\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}312105\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}312205\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}312210\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}312305\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}312310\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}312315\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}312320\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}313105\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}313110\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}313115\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}313120\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}313125\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}313130\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}313205\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}313210\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}313215\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}313220\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}313305\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}313310\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}313315\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}313320\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}313405\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}313410\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}313415\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}313505\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}314105\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}314110\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}314115\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}314120\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}314125\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}314205\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}314210\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}314305\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}314310\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}314315\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}314405\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}314410\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}314610\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}314615\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}314620\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}314625\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}314705\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}314710\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}314715\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}314720\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}314725\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}314730\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}314805\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}314810\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}314815\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}314825\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}314830\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}314835\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}314840\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}314845\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}316105\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}316110\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}316115\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}316120\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}316305\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}316310\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}316315\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}316320\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}316325\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}316330\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}316335\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}316340\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}317105\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}317110\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}317115\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}317120\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}317205\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}317210\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}318005\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}318010\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}318015\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}318105\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}318110\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}318115\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}318120\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}318205\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}318210\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}318215\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}318305\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}318310\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}318405\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}318410\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}318415\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}318420\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}318425\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}318430\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}318505\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}318510\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}318605\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}318610\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}318705\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}318710\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}318805\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}318810\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}318815\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}319105\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}319110\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}319205\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}391105\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}391110\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}391115\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}391120\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}391125\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}391130\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}391135\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}391140\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}391145\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}391205\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}391210\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}391215\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}391220\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}391225\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}391230\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}395105\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}395110\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}720105\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}720110\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}720115\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}720120\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}720125\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}720130\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}720135\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}720140\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}720145\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}720150\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}720155\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}720160\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}720205\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}720210\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}720215\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}720220\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}721105\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}721110\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}721115\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}721205\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}721210\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}721215\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}721220\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}721225\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}721305\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}721310\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}721315\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}721320\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}721325\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}721405\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}721410\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}721415\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}721420\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}721425\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}721430\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}722105\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}722110\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}722115\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}722205\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}722210\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}722215\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}722220\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}722225\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}722230\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}722235\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}722305\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}722310\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}722315\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}722320\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}722325\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}722330\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}722405\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}722410\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}722415\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}723105\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}723110\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}723115\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}723120\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}723125\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}723205\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}723210\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}723215\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}723220\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}723225\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}723230\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}723235\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}723240\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}723305\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}723310\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}723315\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}723320\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}723325\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}723330\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}724105\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}724110\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}724115\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}724120\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}724125\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}724130\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}724135\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}724205\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}724210\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}724215\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}724220\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}724225\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}724230\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}724305\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}724310\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}724315\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}724320\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}724325\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}724405\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}724410\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}724415\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}724420\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}724425\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}724430\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}724435\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}724440\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}724505\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}724510\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}724515\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}724605\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}724610\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}725005\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}725010\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}725015\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}725020\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}725025\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}725105\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}725205\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}725210\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}725215\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}725220\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}725225\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}725305\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}725310\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}725315\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}725320\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}725405\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}725410\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}725415\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}725420\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}725505\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}725510\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}725605\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}725610\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}725705\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}730105\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}731105\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}731110\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}731115\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}731120\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}731125\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}731130\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}731135\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}731140\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}731145\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}731150\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}731155\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}731160\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}731165\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}731170\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}731175\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}731180\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}731205\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}731305\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}731310\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}731315\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}731320\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}731325\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}731330\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}732105\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}732110\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}732115\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}732120\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}732125\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}732130\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}732135\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}732140\textquotesingle{}}\NormalTok{])}

\NormalTok{variaveis }\OperatorTok{=}\NormalTok{ (}\StringTok{\textquotesingle{}id\_municipio, count(*)\textquotesingle{}}\NormalTok{)}
\NormalTok{base }\OperatorTok{=} \StringTok{\textquotesingle{}\textasciigrave{}basedosdados.br\_me\_rais.microdados\_vinculos\textasciigrave{}\textquotesingle{}}
\NormalTok{project\_id }\OperatorTok{=} \StringTok{\textquotesingle{}double{-}balm{-}306418\textquotesingle{}}
\NormalTok{cod\_ibge }\OperatorTok{=} \BuiltInTok{tuple}\NormalTok{(database[}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{].astype(}\BuiltInTok{str}\NormalTok{))}
\NormalTok{query\_1 }\OperatorTok{=}\NormalTok{ (}\SpecialStringTok{f\textquotesingle{}SELECT }\SpecialCharTok{\{}\NormalTok{variaveis}\SpecialCharTok{\}}\SpecialStringTok{ AS n\_cet FROM }\SpecialCharTok{\{}\NormalTok{base}\SpecialCharTok{\}}\SpecialStringTok{ WHERE ano = 2020 AND cbo\_2002 IN\textquotesingle{}} 
           \SpecialStringTok{f\textquotesingle{} }\SpecialCharTok{\{}\NormalTok{cbo\_2002}\SpecialCharTok{\}}\SpecialStringTok{ AND id\_municipio IN }\SpecialCharTok{\{}\NormalTok{cod\_ibge}\SpecialCharTok{\}}\SpecialStringTok{ GROUP BY id\_municipio\textquotesingle{}}\NormalTok{)}
\NormalTok{query\_2 }\OperatorTok{=}\NormalTok{ (}\SpecialStringTok{f\textquotesingle{}SELECT }\SpecialCharTok{\{}\NormalTok{variaveis}\SpecialCharTok{\}}\SpecialStringTok{ AS n\_trab FROM }\SpecialCharTok{\{}\NormalTok{base}\SpecialCharTok{\}}\SpecialStringTok{ WHERE ano = 2020 AND id\_municipio\textquotesingle{}} 
           \SpecialStringTok{f\textquotesingle{} IN }\SpecialCharTok{\{}\NormalTok{cod\_ibge}\SpecialCharTok{\}}\SpecialStringTok{ GROUP BY id\_municipio\textquotesingle{}}\NormalTok{)}
\CommentTok{\#\# Importando o data lake}
\NormalTok{df\_rais\_2\_1 }\OperatorTok{=}\NormalTok{ bd.read\_sql(query}\OperatorTok{=}\NormalTok{query\_1, billing\_project\_id}\OperatorTok{=}\NormalTok{project\_id)}
\NormalTok{df\_rais\_2\_2 }\OperatorTok{=}\NormalTok{ bd.read\_sql(query}\OperatorTok{=}\NormalTok{query\_2, billing\_project\_id}\OperatorTok{=}\NormalTok{project\_id)}
\NormalTok{df\_rais\_2 }\OperatorTok{=}\NormalTok{ df\_rais\_2\_1.merge(df\_rais\_2\_2, how}\OperatorTok{=}\StringTok{\textquotesingle{}left\textquotesingle{}}\NormalTok{,on}\OperatorTok{=}\StringTok{\textquotesingle{}id\_municipio\textquotesingle{}}\NormalTok{) }
\NormalTok{df\_rais\_2[}\StringTok{\textquotesingle{}Proporção de Funcionários em C\&T\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ df\_rais\_2[}\StringTok{\textquotesingle{}n\_cet\textquotesingle{}}\NormalTok{]}\OperatorTok{/}\NormalTok{df\_rais\_2[}\StringTok{\textquotesingle{}n\_trab\textquotesingle{}}\NormalTok{]}

\NormalTok{subdet\_input }\OperatorTok{=}\NormalTok{ subdet\_input.merge(df\_rais\_2, right\_on}\OperatorTok{=}\StringTok{\textquotesingle{}id\_municipio\textquotesingle{}}\NormalTok{, left\_on}\OperatorTok{=}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{)}
\NormalTok{interesse }\OperatorTok{=}\NormalTok{ [}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Proporção de Mestres e Doutores em C\&T\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Proporção de Funcionários em C\&T\textquotesingle{}}\NormalTok{]}
\NormalTok{subdet\_input }\OperatorTok{=}\NormalTok{ subdet\_input[interesse]}

\CommentTok{\#\#\#\#\#\#\#\# 2.6.1.3. Indicador Média de Investimentos do BNDES e da FINEP \#\#\#\#\#\#\#\#\#}
\CommentTok{\#\# Importando dados: BNDES}
\NormalTok{df\_bndes }\OperatorTok{=}\NormalTok{ pd.read\_excel(}\StringTok{\textquotesingle{}DETERMINANTE INOVAÇÃO/naoautomaticas.xlsx\textquotesingle{}}\NormalTok{, }
\NormalTok{                         usecols}\OperatorTok{=}\StringTok{\textquotesingle{}D:F,I\textquotesingle{}}\NormalTok{, header}\OperatorTok{=}\DecValTok{4}\NormalTok{)}
\NormalTok{df\_bndes }\OperatorTok{=}\NormalTok{ df\_bndes.rename(\{}\StringTok{\textquotesingle{}Município {-} código\textquotesingle{}}\NormalTok{:}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{\},axis}\OperatorTok{=}\DecValTok{1}\NormalTok{).astype(}\BuiltInTok{str}\NormalTok{)}
\NormalTok{df\_bndes }\OperatorTok{=}\NormalTok{ df\_bndes.merge(database, how}\OperatorTok{=}\StringTok{\textquotesingle{}right\textquotesingle{}}\NormalTok{, on}\OperatorTok{=}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{)}
\NormalTok{df\_bndes.iloc[:,}\DecValTok{3}\NormalTok{:}\DecValTok{4}\NormalTok{] }\OperatorTok{=}\NormalTok{ df\_bndes.iloc[:,}\DecValTok{3}\NormalTok{:}\DecValTok{4}\NormalTok{].}\BuiltInTok{apply}\NormalTok{(pd.to\_numeric)}
\NormalTok{df\_bndes }\OperatorTok{=}\NormalTok{ df\_bndes.groupby([}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{]).}\BuiltInTok{sum}\NormalTok{()}

\CommentTok{\#\# Importando dados: FINEP}
\NormalTok{df\_finep }\OperatorTok{=}\NormalTok{ pd.read\_excel(}\StringTok{\textquotesingle{}DETERMINANTE INOVAÇÃO/19\_08\_2022\_Contratacao.xls\textquotesingle{}}\NormalTok{, }
\NormalTok{                         usecols}\OperatorTok{=}\StringTok{\textquotesingle{}E,K:M\textquotesingle{}}\NormalTok{, header}\OperatorTok{=}\DecValTok{5}\NormalTok{).drop([}\DecValTok{4}\NormalTok{], axis}\OperatorTok{=}\DecValTok{0}\NormalTok{)}
\NormalTok{df\_finep[}\StringTok{\textquotesingle{}Data Assinatura\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ pd.to\_datetime(df\_finep[}\StringTok{\textquotesingle{}Data Assinatura\textquotesingle{}}\NormalTok{], }\BuiltInTok{format}\OperatorTok{=}\StringTok{\textquotesingle{}\%Y{-}\%m{-}}\SpecialCharTok{\%d}\StringTok{\textquotesingle{}}\NormalTok{)}
\NormalTok{df\_finep }\OperatorTok{=}\NormalTok{ df\_finep[(df\_finep[}\StringTok{\textquotesingle{}Data Assinatura\textquotesingle{}}\NormalTok{] }\OperatorTok{\textgreater{}=} \StringTok{\textquotesingle{}2021{-}01{-}01 00:00:00\textquotesingle{}}\NormalTok{) }
                     \OperatorTok{\&}\NormalTok{ (df\_finep[}\StringTok{\textquotesingle{}Data Assinatura\textquotesingle{}}\NormalTok{] }\OperatorTok{\textless{}=} \StringTok{\textquotesingle{}2021{-}12{-}31 00:00:00\textquotesingle{}}\NormalTok{)]}

\NormalTok{df\_finep[}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ df\_finep[}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{].}\BuiltInTok{str}\NormalTok{.upper().}\BuiltInTok{str}\NormalTok{.normalize(}\StringTok{\textquotesingle{}NFKD\textquotesingle{}}\NormalTok{).}\BuiltInTok{str}\NormalTok{.encode(}\StringTok{\textquotesingle{}ascii\textquotesingle{}}\NormalTok{, errors}\OperatorTok{=}\StringTok{\textquotesingle{}ignore\textquotesingle{}}\NormalTok{).}\BuiltInTok{str}\NormalTok{.decode(}\StringTok{\textquotesingle{}utf{-}8\textquotesingle{}}\NormalTok{)}
\NormalTok{df\_finep }\OperatorTok{=}\NormalTok{ df\_finep.groupby([}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{]).}\BuiltInTok{sum}\NormalTok{()}
\NormalTok{df\_finep }\OperatorTok{=}\NormalTok{ df\_finep.merge(database, how}\OperatorTok{=}\StringTok{\textquotesingle{}right\textquotesingle{}}\NormalTok{,on}\OperatorTok{=}\NormalTok{[}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{]).fillna(}\DecValTok{0}\NormalTok{)}

\NormalTok{df\_finep\_bndes }\OperatorTok{=}\NormalTok{ df\_finep.merge(df\_bndes, how}\OperatorTok{=}\StringTok{\textquotesingle{}left\textquotesingle{}}\NormalTok{,on}\OperatorTok{=}\NormalTok{[}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{]).fillna(}\DecValTok{0}\NormalTok{)}
\NormalTok{df\_finep\_bndes }\OperatorTok{=}\NormalTok{ df\_finep\_bndes.merge(df\_rais\_2\_1, left\_on}\OperatorTok{=}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{, right\_on}\OperatorTok{=}\StringTok{\textquotesingle{}id\_municipio\textquotesingle{}}\NormalTok{)}
\NormalTok{df\_finep\_bndes[}\StringTok{\textquotesingle{}Média de Investimentos do BNDES e FINEP\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ (df\_finep\_bndes[}\StringTok{\textquotesingle{}Valor Finep\textquotesingle{}}\NormalTok{] }\OperatorTok{+}\NormalTok{ df\_finep\_bndes[}\StringTok{\textquotesingle{}Valor contratado  R$\textquotesingle{}}\NormalTok{])}\OperatorTok{/}\NormalTok{df\_finep\_bndes[}\StringTok{\textquotesingle{}n\_cet\textquotesingle{}}\NormalTok{]}

\NormalTok{subdet\_input }\OperatorTok{=}\NormalTok{ subdet\_input.merge(df\_finep\_bndes, how}\OperatorTok{=}\StringTok{\textquotesingle{}right\textquotesingle{}}\NormalTok{, on}\OperatorTok{=}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{)}
\NormalTok{interesse}\OperatorTok{=}\NormalTok{[}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Proporção de Mestres e Doutores em C\&T\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Proporção de Funcionários em C\&T\textquotesingle{}}\NormalTok{,}
           \StringTok{\textquotesingle{}Média de Investimentos do BNDES e FINEP\textquotesingle{}}\NormalTok{]}
\NormalTok{subdet\_input}\OperatorTok{=}\NormalTok{subdet\_input[interesse]}

\CommentTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\# 2.6.1.4. Indicador Infraestrutura Tecnológica \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\NormalTok{df\_inpi\_contrato }\OperatorTok{=}\NormalTok{ pd.read\_excel(}\StringTok{\textquotesingle{}DETERMINANTE INOVAÇÃO/5 {-} Depósitos de Marcas por Cidade.xls\textquotesingle{}}\NormalTok{,}
\NormalTok{                                 usecols}\OperatorTok{=}\StringTok{\textquotesingle{}A,B,U,V\textquotesingle{}}\NormalTok{, header}\OperatorTok{=}\DecValTok{7}\NormalTok{).dropna()}

\NormalTok{df\_inpi\_contrato }\OperatorTok{=}\NormalTok{ df\_inpi\_contrato.rename(columns}\OperatorTok{=}\NormalTok{\{df\_inpi\_contrato.columns[}\DecValTok{0}\NormalTok{]:}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{,}
\NormalTok{                                                    df\_inpi\_contrato.columns[}\DecValTok{1}\NormalTok{]:}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{\})}

\NormalTok{df\_inpi\_contrato[}\StringTok{\textquotesingle{}2018+2019\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ df\_inpi\_contrato.iloc[:,}\DecValTok{2}\NormalTok{] }\OperatorTok{+}\NormalTok{ df\_inpi\_contrato.iloc[:,}\DecValTok{3}\NormalTok{]}
\NormalTok{df\_inpi\_contrato[}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ df\_inpi\_contrato[}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{].astype(}\BuiltInTok{str}\NormalTok{)}
\NormalTok{df\_inpi\_contrato }\OperatorTok{=}\NormalTok{ df\_inpi\_contrato.merge(database, how}\OperatorTok{=}\StringTok{\textquotesingle{}right\textquotesingle{}}\NormalTok{, on}\OperatorTok{=}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{)}
\NormalTok{df\_inpi\_contrato }\OperatorTok{=}\NormalTok{ df\_inpi\_contrato.merge(df\_rais, how}\OperatorTok{=}\StringTok{\textquotesingle{}right\textquotesingle{}}\NormalTok{, on}\OperatorTok{=}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{)}
\NormalTok{df\_inpi\_contrato[}\StringTok{\textquotesingle{}Contratos de Concessão\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ (df\_inpi\_contrato[}\StringTok{\textquotesingle{}2018+2019\textquotesingle{}}\NormalTok{])}\OperatorTok{/}\NormalTok{df\_inpi\_contrato[}\StringTok{\textquotesingle{}mil\_emp\textquotesingle{}}\NormalTok{]}

\NormalTok{subdet\_input }\OperatorTok{=}\NormalTok{ subdet\_input.merge(df\_inpi\_contrato, how}\OperatorTok{=}\StringTok{\textquotesingle{}right\textquotesingle{}}\NormalTok{, on}\OperatorTok{=}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{)}
\NormalTok{subdet\_input }\OperatorTok{=}\NormalTok{ subdet\_input.merge(amostra, how}\OperatorTok{=}\StringTok{\textquotesingle{}left\textquotesingle{}}\NormalTok{, on}\OperatorTok{=}\NormalTok{[}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{])}
\NormalTok{interesse}\OperatorTok{=}\NormalTok{[}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Proporção de Mestres e Doutores em C\&T\textquotesingle{}}\NormalTok{,}
           \StringTok{\textquotesingle{}Proporção de Funcionários em C\&T\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Média de Investimentos do BNDES e FINEP\textquotesingle{}}\NormalTok{,}
           \StringTok{\textquotesingle{}Contratos de Concessão\textquotesingle{}}\NormalTok{]}
\NormalTok{subdet\_input }\OperatorTok{=}\NormalTok{ subdet\_input[interesse].set\_index([}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{])}

\CommentTok{\# Tratamentos de para os missing e outliers}
\NormalTok{missing\_data(subdet\_input)}
\NormalTok{extreme\_values(subdet\_input)}

\CommentTok{\# Criando o subdeterminante}
\NormalTok{create\_subindex(subdet\_input, subdet)}
\NormalTok{inovacao[subdet] }\OperatorTok{=}\NormalTok{ subdet\_input}
\end{Highlighting}
\end{Shaded}

\hypertarget{script_2.5.2}{%
\paragraph{Subdeterminante Outputs}\label{script_2.5.2}}

\begin{itemize}
\tightlist
\item
  Para retornar ao relatório do Subdeterminante Outputs
  \protect\hyperlink{subdet_output}{clique aqui}.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Indicando o subdeterminante}
\NormalTok{subdet }\OperatorTok{=} \StringTok{\textquotesingle{}Output\textquotesingle{}}

\CommentTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\# Indicador Patentes \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\NormalTok{letras }\OperatorTok{=}\NormalTok{ [}\StringTok{\textquotesingle{}a\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}b\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}c\textquotesingle{}}\NormalTok{]}
\NormalTok{tipo }\OperatorTok{=}\NormalTok{ [}\StringTok{\textquotesingle{}PI\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}MU\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}CA\textquotesingle{}}\NormalTok{]}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{list}\NormalTok{(}\BuiltInTok{range}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{3}\NormalTok{)):}
    \BuiltInTok{globals}\NormalTok{()[}\SpecialStringTok{f\textquotesingle{}df\_inpi\_patente\_}\SpecialCharTok{\{}\NormalTok{i}\SpecialCharTok{\}}\SpecialStringTok{\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ pd.read\_excel(}\SpecialStringTok{f\textquotesingle{}DETERMINANTE INOVAÇÃO/5}\SpecialCharTok{\{}\NormalTok{letras[i]}\SpecialCharTok{\}}\SpecialStringTok{ {-} Depósitos de Patentes do Tipo }\SpecialCharTok{\{}\NormalTok{tipo[i]}\SpecialCharTok{\}}\SpecialStringTok{ por Cidade.xls\textquotesingle{}}\NormalTok{,}
\NormalTok{                                     usecols}\OperatorTok{=}\StringTok{\textquotesingle{}A,B,U,V\textquotesingle{}}\NormalTok{, header}\OperatorTok{=}\DecValTok{7}\NormalTok{).dropna().assign(tipo}\OperatorTok{=}\NormalTok{tipo[i])}
\NormalTok{    pdList }\OperatorTok{=}\NormalTok{ []}
\NormalTok{    pdList.extend(value }\ControlFlowTok{for}\NormalTok{ name, value }\KeywordTok{in} \BuiltInTok{locals}\NormalTok{().items() }\ControlFlowTok{if}\NormalTok{ name.startswith(}\StringTok{\textquotesingle{}df\_inpi\_patente\_\textquotesingle{}}\NormalTok{))}
\NormalTok{    indicador\_patente }\OperatorTok{=}\NormalTok{ pd.concat(pdList, axis}\OperatorTok{=}\DecValTok{0}\NormalTok{)}

\NormalTok{indicador\_patente }\OperatorTok{=}\NormalTok{ indicador\_patente.rename(columns}\OperatorTok{=}\NormalTok{\{indicador\_patente.columns[}\DecValTok{0}\NormalTok{]:}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{,}
\NormalTok{                                                      indicador\_patente.columns[}\DecValTok{1}\NormalTok{]:}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{\})}

\NormalTok{indicador\_patente[}\StringTok{\textquotesingle{}2018+2019\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ indicador\_patente.iloc[:,}\DecValTok{2}\NormalTok{] }\OperatorTok{+}\NormalTok{ indicador\_patente.iloc[:,}\DecValTok{3}\NormalTok{]}
\NormalTok{indicador\_patente[}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ indicador\_patente[}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{].astype(}\BuiltInTok{str}\NormalTok{)}
\NormalTok{indicador\_patente }\OperatorTok{=}\NormalTok{ indicador\_patente.pivot(index}\OperatorTok{=}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{, columns}\OperatorTok{=}\StringTok{\textquotesingle{}tipo\textquotesingle{}}\NormalTok{,values}\OperatorTok{=}\StringTok{\textquotesingle{}2018+2019\textquotesingle{}}\NormalTok{).fillna(}\DecValTok{0}\NormalTok{)}
\NormalTok{cols }\OperatorTok{=}\NormalTok{ indicador\_patente.columns[: indicador\_patente.shape[}\DecValTok{0}\NormalTok{]]}
\NormalTok{indicador\_patente[}\StringTok{\textquotesingle{}CA+MU+PI\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ indicador\_patente[cols].}\BuiltInTok{sum}\NormalTok{(axis}\OperatorTok{=}\DecValTok{1}\NormalTok{)}
\NormalTok{indicador\_patente }\OperatorTok{=}\NormalTok{ indicador\_patente.merge(database, how}\OperatorTok{=}\StringTok{\textquotesingle{}right\textquotesingle{}}\NormalTok{, on}\OperatorTok{=}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{)}
\NormalTok{indicador\_patente }\OperatorTok{=}\NormalTok{ indicador\_patente.merge(df\_rais, how}\OperatorTok{=}\StringTok{\textquotesingle{}right\textquotesingle{}}\NormalTok{, on}\OperatorTok{=}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{)}
\NormalTok{indicador\_patente[}\StringTok{\textquotesingle{}Patentes\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ (indicador\_patente[}\StringTok{\textquotesingle{}CA+MU+PI\textquotesingle{}}\NormalTok{])}\OperatorTok{/}\NormalTok{df\_inpi\_contrato[}\StringTok{\textquotesingle{}mil\_emp\textquotesingle{}}\NormalTok{]}

\NormalTok{subdet\_output }\OperatorTok{=}\NormalTok{ indicador\_patente[[}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Patentes\textquotesingle{}}\NormalTok{]]}
\NormalTok{subdet\_output }\OperatorTok{=}\NormalTok{ subdet\_output.merge(amostra, how}\OperatorTok{=}\StringTok{\textquotesingle{}right\textquotesingle{}}\NormalTok{, on}\OperatorTok{=}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{)}
\NormalTok{subdet\_output }\OperatorTok{=}\NormalTok{ subdet\_output[[}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}NOME DO MUNICÍPIO\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Patentes\textquotesingle{}}\NormalTok{]]}
\NormalTok{subdet\_output }\OperatorTok{=}\NormalTok{ subdet\_output.rename(columns}\OperatorTok{=}\NormalTok{\{}\StringTok{\textquotesingle{}NOME DO MUNICÍPIO\textquotesingle{}}\NormalTok{:}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{\})}

\CommentTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\# Indicador Tamanho da indústria Inovadora \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\NormalTok{list\_cnae }\OperatorTok{=} \BuiltInTok{tuple}\NormalTok{([}
    \StringTok{\textquotesingle{}Fabricação de cloro e álcalis\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Fabricação de intermediários para fertilizantes\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de adubos e fertilizantes\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Fabricação de gases industriais\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de produtos químicos inorgânicos não especificados anteriormente\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de produtos petroquímicos básicos\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Fabricação de intermediários para plastificantes, resinas e fibras\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de produtos químicos orgânicos não especificados anteriormente\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de resinas termoplásticas\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Fabricação de resinas termofixas\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de elastômeros\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Fabricação de fibras artificiais e sintéticas\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de defensivos agrícolas\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Fabricação de desinfestantes domissanitários\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de sabões e detergentes sintéticos\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Fabricação de produtos de limpeza e polimento\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de cosméticos, produtos de perfumaria e de higiene pessoal\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de tintas, vernizes, esmaltes e lacas\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Fabricação de tintas de impressão\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de impermeabilizantes, solventes e produtos afins\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de adesivos e selantes\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Fabricação de explosivos\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de aditivos de uso industrial\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Fabricação de catalisadores\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de produtos químicos não especificados anteriormente\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de produtos farmoquímicos\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Fabricação de medicamentos para uso humano\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de medicamentos para uso veterinário\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Fabricação de preparações farmacêuticas\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de aparelhos e equipamentos de medida, teste e controle\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Fabricação de cronômetros e relógios\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de aparelhos eletromédicos e eletroterapêuticos e equipamentos de irradiação\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de equipamentos e instrumentos ópticos, fotográficos e cinematográficos\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de geradores, transformadores e motores elétricos\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de pilhas, baterias e acumuladores elétricos, exceto para veículos automotores\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de baterias e acumuladores para veículos automotores\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de aparelhos e equipamentos para distribuição e controle de energia elétrica\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de material elétrico para instalações em circuito de consumo\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de fios, cabos e condutores elétricos isolados\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de lâmpadas e outros equipamentos de iluminação\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de fogões, refrigeradores e máquinas de lavar e secar para uso doméstico\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de aparelhos eletrodomésticos não especificados anteriormente\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de equipamentos e aparelhos elétricos não especificados anteriormente\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de motores e turbinas, exceto para aviões e veículos rodoviários\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de equipamentos hidráulicos e pneumáticos, exceto válvulas\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de válvulas, registros e dispositivos semelhantes\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Fabricação de compressores\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de equipamentos de transmissão para fins industriais\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de aparelhos e equipamentos para instalações térmicas\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de máquinas, equipamentos e aparelhos para transporte e elevação de cargas e pessoas\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de máquinas e aparelhos de refrigeração e ventilação para uso industrial e comercial\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de aparelhos e equipamentos de ar condicionado\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de máquinas e equipamentos para saneamento básico e ambiental\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de máquinas e equipamentos de uso geral não especificados anteriormente\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de tratores agrícolas\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Fabricação de equipamentos para irrigação agrícola\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de máquinas e equipamentos para a agricultura e pecuária, exceto para irrigação\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de máquinas{-}ferramenta\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Fabricação de máquinas e equipamentos para a prospecção e extração de petróleo\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de outras máquinas e equipamentos para uso na extração mineral, exceto na extração de petróleo\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de tratores, exceto agrícolas\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Fabricação de máquinas e equipamentos para terraplenagem, pavimentação e construção, exceto tratores\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de máquinas para a indústria metalúrgica, exceto máquinas{-}ferramenta\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de máquinas e equipamentos para as indústrias de alimentos, bebidas e fumo\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de máquinas e equipamentos para a indústria têxtil\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de máquinas e equipamentos para as indústrias do vestuário, do couro e de calçados\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de máquinas e equipamentos para as indústrias de celulose, papel e papelão e artefatos\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de máquinas e equipamentos para a indústria do plástico\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de máquinas e equipamentos para uso industrial específico não especificados anteriormente\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de automóveis, camionetas e utilitários\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Fabricação de caminhões e ônibus\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de cabines, carrocerias e reboques para veículos automotores\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de peças e acessórios para o sistema motor de veículos automotores\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de peças e acessórios para os sistemas de marcha e transmissão de veículos automotores\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de peças e acessórios para o sistema de freios de veículos automotores\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de peças e acessórios para o sistema de direção e suspensão de veículos automotores\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de material elétrico e eletrônico para veículos automotores, exceto baterias\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de peças e acessórios para veículos automotores não especificados anteriormente\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Recondicionamento e recuperação de motores para veículos automotores\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de locomotivas, vagões e outros materiais rodantes\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de peças e acessórios para veículos ferroviários\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Fabricação de aeronaves\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de turbinas, motores e outros componentes e peças para aeronaves\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de motocicletas\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Fabricação de bicicletas e triciclos não{-}motorizados\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de equipamentos de transporte não especificados anteriormente\textquotesingle{}}\NormalTok{])}

\NormalTok{variaveis }\OperatorTok{=}\NormalTok{ (}\StringTok{\textquotesingle{}cnae\_2, descricao\textquotesingle{}}\NormalTok{)}
\NormalTok{base }\OperatorTok{=} \StringTok{\textquotesingle{}\textasciigrave{}basedosdados.br\_bd\_diretorios\_brasil.cnae\_2\textasciigrave{}\textquotesingle{}}
\NormalTok{project\_id }\OperatorTok{=} \StringTok{\textquotesingle{}double{-}balm{-}306418\textquotesingle{}}
\NormalTok{query }\OperatorTok{=}\NormalTok{ (}\SpecialStringTok{f\textquotesingle{}SELECT }\SpecialCharTok{\{}\NormalTok{variaveis}\SpecialCharTok{\}}\SpecialStringTok{ FROM }\SpecialCharTok{\{}\NormalTok{base}\SpecialCharTok{\}}\SpecialStringTok{ WHERE descricao IN }\SpecialCharTok{\{}\NormalTok{list\_cnae}\SpecialCharTok{\}}\SpecialStringTok{\textquotesingle{}}\NormalTok{)}
\NormalTok{cnae\_2 }\OperatorTok{=}\NormalTok{ bd.read\_sql(query}\OperatorTok{=}\NormalTok{query, billing\_project\_id}\OperatorTok{=}\NormalTok{project\_id)}
\NormalTok{cnae\_2[}\StringTok{\textquotesingle{}cnae\_2\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ cnae\_2[}\StringTok{\textquotesingle{}cnae\_2\textquotesingle{}}\NormalTok{].}\BuiltInTok{str}\NormalTok{.replace(}\VerbatimStringTok{r"(\textbackslash{}d)\textbackslash{}."}\NormalTok{,}\VerbatimStringTok{r"\textbackslash{}1"}\NormalTok{).}\BuiltInTok{str}\NormalTok{.replace(}\VerbatimStringTok{r"(\textbackslash{}d)\textbackslash{}{-}"}\NormalTok{,}\VerbatimStringTok{r"\textbackslash{}1"}\NormalTok{)}
\NormalTok{cnae\_2 }\OperatorTok{=} \BuiltInTok{tuple}\NormalTok{(cnae\_2[}\StringTok{\textquotesingle{}cnae\_2\textquotesingle{}}\NormalTok{])}

\NormalTok{variaveis }\OperatorTok{=}\NormalTok{ (}\StringTok{\textquotesingle{}id\_municipio, count(*)\textquotesingle{}}\NormalTok{)}
\NormalTok{base }\OperatorTok{=} \StringTok{\textquotesingle{}\textasciigrave{}basedosdados.br\_me\_rais.microdados\_estabelecimentos\textasciigrave{}\textquotesingle{}}
\NormalTok{project\_id }\OperatorTok{=} \StringTok{\textquotesingle{}double{-}balm{-}306418\textquotesingle{}}
\NormalTok{cod\_ibge }\OperatorTok{=} \BuiltInTok{tuple}\NormalTok{(database[}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{].astype(}\BuiltInTok{str}\NormalTok{))}
\NormalTok{query }\OperatorTok{=}\NormalTok{ (}\SpecialStringTok{f\textquotesingle{}SELECT }\SpecialCharTok{\{}\NormalTok{variaveis}\SpecialCharTok{\}}\SpecialStringTok{ FROM }\SpecialCharTok{\{}\NormalTok{base}\SpecialCharTok{\}}\SpecialStringTok{ WHERE ano = 2020 AND id\_municipio\textquotesingle{}} 
         \SpecialStringTok{f\textquotesingle{} IN }\SpecialCharTok{\{}\NormalTok{cod\_ibge}\SpecialCharTok{\}}\SpecialStringTok{ AND cnae\_2 IN }\SpecialCharTok{\{}\NormalTok{cnae\_2}\SpecialCharTok{\}}\SpecialStringTok{ GROUP BY id\_municipio\textquotesingle{}}\NormalTok{)}
\NormalTok{df\_rais\_inova }\OperatorTok{=}\NormalTok{ bd.read\_sql(query}\OperatorTok{=}\NormalTok{query, billing\_project\_id}\OperatorTok{=}\NormalTok{project\_id)}
\NormalTok{df\_rais\_inova }\OperatorTok{=}\NormalTok{ df\_rais\_inova.merge(df\_rais, left\_on}\OperatorTok{=}\StringTok{\textquotesingle{}id\_municipio\textquotesingle{}}\NormalTok{, right\_on}\OperatorTok{=}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{)}
\NormalTok{df\_rais\_inova[}\StringTok{\textquotesingle{}Tamanho da Indústria Inovadora\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ df\_rais\_inova[}\StringTok{\textquotesingle{}f0\_\_x\textquotesingle{}}\NormalTok{]}\OperatorTok{/}\NormalTok{df\_rais\_inova[}\StringTok{\textquotesingle{}f0\_\_y\textquotesingle{}}\NormalTok{]}

\NormalTok{subdet\_output }\OperatorTok{=}\NormalTok{ subdet\_output.merge(df\_rais\_inova, how}\OperatorTok{=}\StringTok{\textquotesingle{}left\textquotesingle{}}\NormalTok{, on}\OperatorTok{=}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{)}
\NormalTok{interesse}\OperatorTok{=}\NormalTok{[}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Patentes\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Tamanho da Indústria Inovadora\textquotesingle{}}\NormalTok{]}
\NormalTok{subdet\_output}\OperatorTok{=}\NormalTok{subdet\_output[interesse]}

\CommentTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\# Indicador Tamanho da indústria Criativa \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\NormalTok{list\_cnae }\OperatorTok{=} \BuiltInTok{tuple}\NormalTok{([}
    \StringTok{\textquotesingle{}Lapidação de gemas e fabricação de artefatos de ourivesaria e joalheria\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de bijuterias e artefatos semelhantes\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Fabricação de instrumentos musicais\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Edição de livros\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Edição de jornais\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Edição de revistas\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Edição de Cadastros, Listas e de Outros Produtos Gráficos\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Edição integrada à impressão de livros\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Edição integrada à impressão de jornais\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Edição integrada à impressão de revistas\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Atividades de televisão aberta\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Edição integrada à impressão de cadastros, listas e de outros produtos gráficos\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Atividades de produção cinematográfica, de vídeos e de programas de televisão\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Atividades de pós{-}produção cinematográfica, de vídeos e de programas de televisão\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Distribuição cinematográfica, de vídeo e de programas de televisão\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Atividades de exibição cinematográfica\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Agências de notícias\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Atividades de gravação de som e de edição de música\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Atividades de rádio\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Programadoras e atividades relacionadas à televisão por assinatura\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Serviços de arquitetura\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Agências de publicidade\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Pesquisa e desenvolvimento experimental em ciências físicas e naturais\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Pesquisa e desenvolvimento experimental em ciências sociais e humanas\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Atividades de publicidade não especificadas anteriormente\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Design e decoração de interiores\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Atividades fotográficas e similares\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Aluguel de fitas de vídeo, DVDs e similares\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Ensino de arte e cultura\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Ensino de idiomas\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Artes cênicas, espetáculos e atividades complementares\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Criação artística\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Gestão de espaços para artes cênicas, espetáculos e outras atividades artísticas\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Atividades de bibliotecas e arquivos\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Atividades de museus e de exploração, restauração artística e conservação de lugares e prédios históricos e atrações similares\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Atividades de jardins botânicos, zoológicos, parques nacionais, reservas ecológicas e áreas de proteção ambiental\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Atividades de organizações associativas ligadas à cultura e à arte\textquotesingle{}}\NormalTok{])}

\NormalTok{variaveis }\OperatorTok{=}\NormalTok{ (}\StringTok{\textquotesingle{}cnae\_2, descricao\textquotesingle{}}\NormalTok{)}
\NormalTok{base }\OperatorTok{=} \StringTok{\textquotesingle{}\textasciigrave{}basedosdados.br\_bd\_diretorios\_brasil.cnae\_2\textasciigrave{}\textquotesingle{}}
\NormalTok{project\_id }\OperatorTok{=} \StringTok{\textquotesingle{}double{-}balm{-}306418\textquotesingle{}}
\NormalTok{query }\OperatorTok{=}\NormalTok{ (}\SpecialStringTok{f\textquotesingle{}SELECT }\SpecialCharTok{\{}\NormalTok{variaveis}\SpecialCharTok{\}}\SpecialStringTok{ FROM }\SpecialCharTok{\{}\NormalTok{base}\SpecialCharTok{\}}\SpecialStringTok{ WHERE descricao IN }\SpecialCharTok{\{}\NormalTok{list\_cnae}\SpecialCharTok{\}}\SpecialStringTok{\textquotesingle{}}\NormalTok{)}
\NormalTok{cnae\_2 }\OperatorTok{=}\NormalTok{ bd.read\_sql(query}\OperatorTok{=}\NormalTok{query, billing\_project\_id}\OperatorTok{=}\NormalTok{project\_id)}
\NormalTok{cnae\_2[}\StringTok{\textquotesingle{}cnae\_2\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ cnae\_2[}\StringTok{\textquotesingle{}cnae\_2\textquotesingle{}}\NormalTok{].}\BuiltInTok{str}\NormalTok{.replace(}\VerbatimStringTok{r"(\textbackslash{}d)\textbackslash{}."}\NormalTok{,}\VerbatimStringTok{r"\textbackslash{}1"}\NormalTok{).}\BuiltInTok{str}\NormalTok{.replace(}\VerbatimStringTok{r"(\textbackslash{}d)\textbackslash{}{-}"}\NormalTok{,}\VerbatimStringTok{r"\textbackslash{}1"}\NormalTok{)}
\NormalTok{cnae\_2 }\OperatorTok{=} \BuiltInTok{tuple}\NormalTok{(cnae\_2[}\StringTok{\textquotesingle{}cnae\_2\textquotesingle{}}\NormalTok{])}

\NormalTok{variaveis }\OperatorTok{=}\NormalTok{ (}\StringTok{\textquotesingle{}id\_municipio, count(*)\textquotesingle{}}\NormalTok{)}
\NormalTok{base }\OperatorTok{=} \StringTok{\textquotesingle{}\textasciigrave{}basedosdados.br\_me\_rais.microdados\_estabelecimentos\textasciigrave{}\textquotesingle{}}
\NormalTok{project\_id }\OperatorTok{=} \StringTok{\textquotesingle{}double{-}balm{-}306418\textquotesingle{}}
\NormalTok{cod\_ibge }\OperatorTok{=} \BuiltInTok{tuple}\NormalTok{(database[}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{].astype(}\BuiltInTok{str}\NormalTok{))}
\NormalTok{query }\OperatorTok{=}\NormalTok{ (}\SpecialStringTok{f\textquotesingle{}SELECT }\SpecialCharTok{\{}\NormalTok{variaveis}\SpecialCharTok{\}}\SpecialStringTok{ FROM }\SpecialCharTok{\{}\NormalTok{base}\SpecialCharTok{\}}\SpecialStringTok{ WHERE ano = 2020 AND id\_municipio\textquotesingle{}} 
         \SpecialStringTok{f\textquotesingle{} IN }\SpecialCharTok{\{}\NormalTok{cod\_ibge}\SpecialCharTok{\}}\SpecialStringTok{ AND cnae\_2 IN }\SpecialCharTok{\{}\NormalTok{cnae\_2}\SpecialCharTok{\}}\SpecialStringTok{ GROUP BY id\_municipio\textquotesingle{}}\NormalTok{)}
\NormalTok{df\_rais\_cria }\OperatorTok{=}\NormalTok{ bd.read\_sql(query}\OperatorTok{=}\NormalTok{query, billing\_project\_id}\OperatorTok{=}\NormalTok{project\_id)}
\NormalTok{df\_rais\_cria }\OperatorTok{=}\NormalTok{ df\_rais\_cria.merge(df\_rais, left\_on}\OperatorTok{=}\StringTok{\textquotesingle{}id\_municipio\textquotesingle{}}\NormalTok{, right\_on}\OperatorTok{=}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{)}
\NormalTok{df\_rais\_cria[}\StringTok{\textquotesingle{}Tamanho da Indústria Criativa\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ df\_rais\_cria[}\StringTok{\textquotesingle{}f0\_\_x\textquotesingle{}}\NormalTok{]}\OperatorTok{/}\NormalTok{df\_rais\_cria[}\StringTok{\textquotesingle{}f0\_\_y\textquotesingle{}}\NormalTok{]}

\NormalTok{subdet\_output }\OperatorTok{=}\NormalTok{ subdet\_output.merge(df\_rais\_cria, how}\OperatorTok{=}\StringTok{\textquotesingle{}left\textquotesingle{}}\NormalTok{, on}\OperatorTok{=}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{)}
\NormalTok{interesse}\OperatorTok{=}\NormalTok{[}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Patentes\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Tamanho da Indústria Inovadora\textquotesingle{}}\NormalTok{,}
           \StringTok{\textquotesingle{}Tamanho da Indústria Criativa\textquotesingle{}}\NormalTok{]}
\NormalTok{subdet\_output}\OperatorTok{=}\NormalTok{subdet\_output[interesse]}

\CommentTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\# Indicador Tamanho das Empresas TIC \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\NormalTok{list\_cnae }\OperatorTok{=} \BuiltInTok{tuple}\NormalTok{([}
    \StringTok{\textquotesingle{}Fabricação de componentes eletrônicos\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Fabricação de equipamentos de informática\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de periféricos para equipamentos de informática\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de equipamentos transmissores de comunicação\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de aparelhos telefônicos e de outros equipamentos de comunicação\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de aparelhos de recepção, reprodução, gravação e amplificação de áudio e vídeo\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Fabricação de mídias virgens, magnéticas e ópticas\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Comércio atacadista de computadores, periféricos e suprimentos de informática\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Comércio atacadista de componentes eletrônicos e equipamentos de telefonia e comunicação\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Telecomunicações sem fio\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Operadoras de televisão por assinatura por cabo\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Telecomunicações por satélite\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Operadoras de televisão por assinatura por microondas\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Operadoras de televisão por assinatura por satélite\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Outras atividades de telecomunicações\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Desenvolvimento de programas de computador sob encomenda\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Desenvolvimento e licenciamento de programas de computador customizáveis\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Desenvolvimento e licenciamento de programas de computador não{-}customizáveis\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Consultoria em tecnologia da informação\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Suporte técnico, manutenção e outros serviços em tecnologia da informação\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Tratamento de dados, provedores de serviços de aplicação e serviços de hospedagem na internet\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Portais, provedores de conteúdo e outros serviços de informação na internet\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Reparação e manutenção de computadores e de equipamentos periféricos\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Reparação e manutenção de equipamentos de comunicação\textquotesingle{}}\NormalTok{])}

\NormalTok{variaveis }\OperatorTok{=}\NormalTok{ (}\StringTok{\textquotesingle{}cnae\_2, descricao\textquotesingle{}}\NormalTok{)}
\NormalTok{base }\OperatorTok{=} \StringTok{\textquotesingle{}\textasciigrave{}basedosdados.br\_bd\_diretorios\_brasil.cnae\_2\textasciigrave{}\textquotesingle{}}
\NormalTok{project\_id }\OperatorTok{=} \StringTok{\textquotesingle{}double{-}balm{-}306418\textquotesingle{}}
\NormalTok{query }\OperatorTok{=}\NormalTok{ (}\SpecialStringTok{f\textquotesingle{}SELECT }\SpecialCharTok{\{}\NormalTok{variaveis}\SpecialCharTok{\}}\SpecialStringTok{ FROM }\SpecialCharTok{\{}\NormalTok{base}\SpecialCharTok{\}}\SpecialStringTok{ WHERE descricao IN }\SpecialCharTok{\{}\NormalTok{list\_cnae}\SpecialCharTok{\}}\SpecialStringTok{\textquotesingle{}}\NormalTok{)}
\NormalTok{cnae\_2 }\OperatorTok{=}\NormalTok{ bd.read\_sql(query}\OperatorTok{=}\NormalTok{query, billing\_project\_id}\OperatorTok{=}\NormalTok{project\_id)}
\NormalTok{cnae\_2[}\StringTok{\textquotesingle{}cnae\_2\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ cnae\_2[}\StringTok{\textquotesingle{}cnae\_2\textquotesingle{}}\NormalTok{].}\BuiltInTok{str}\NormalTok{.replace(}\VerbatimStringTok{r"(\textbackslash{}d)\textbackslash{}."}\NormalTok{,}\VerbatimStringTok{r"\textbackslash{}1"}\NormalTok{).}\BuiltInTok{str}\NormalTok{.replace(}\VerbatimStringTok{r"(\textbackslash{}d)\textbackslash{}{-}"}\NormalTok{,}\VerbatimStringTok{r"\textbackslash{}1"}\NormalTok{)}
\NormalTok{cnae\_2 }\OperatorTok{=} \BuiltInTok{tuple}\NormalTok{(cnae\_2[}\StringTok{\textquotesingle{}cnae\_2\textquotesingle{}}\NormalTok{])}

\NormalTok{variaveis }\OperatorTok{=}\NormalTok{ (}\StringTok{\textquotesingle{}id\_municipio, count(*)\textquotesingle{}}\NormalTok{)}
\NormalTok{base }\OperatorTok{=} \StringTok{\textquotesingle{}\textasciigrave{}basedosdados.br\_me\_rais.microdados\_estabelecimentos\textasciigrave{}\textquotesingle{}}
\NormalTok{project\_id }\OperatorTok{=} \StringTok{\textquotesingle{}double{-}balm{-}306418\textquotesingle{}}
\NormalTok{cod\_ibge }\OperatorTok{=} \BuiltInTok{tuple}\NormalTok{(database[}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{].astype(}\BuiltInTok{str}\NormalTok{))}
\NormalTok{query }\OperatorTok{=}\NormalTok{ (}\SpecialStringTok{f\textquotesingle{}SELECT }\SpecialCharTok{\{}\NormalTok{variaveis}\SpecialCharTok{\}}\SpecialStringTok{ FROM }\SpecialCharTok{\{}\NormalTok{base}\SpecialCharTok{\}}\SpecialStringTok{ WHERE ano = 2020 AND id\_municipio\textquotesingle{}} 
         \SpecialStringTok{f\textquotesingle{} IN }\SpecialCharTok{\{}\NormalTok{cod\_ibge}\SpecialCharTok{\}}\SpecialStringTok{ AND cnae\_2 IN }\SpecialCharTok{\{}\NormalTok{cnae\_2}\SpecialCharTok{\}}\SpecialStringTok{ GROUP BY id\_municipio\textquotesingle{}}\NormalTok{)}
\NormalTok{df\_rais\_tic }\OperatorTok{=}\NormalTok{ bd.read\_sql(query}\OperatorTok{=}\NormalTok{query, billing\_project\_id}\OperatorTok{=}\NormalTok{project\_id)}
\NormalTok{df\_rais\_tic }\OperatorTok{=}\NormalTok{ df\_rais\_tic.merge(df\_rais, left\_on}\OperatorTok{=}\StringTok{\textquotesingle{}id\_municipio\textquotesingle{}}\NormalTok{, right\_on}\OperatorTok{=}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{)}
\NormalTok{df\_rais\_tic[}\StringTok{\textquotesingle{}Tamanho das Empresas TIC\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ df\_rais\_tic[}\StringTok{\textquotesingle{}f0\_\_x\textquotesingle{}}\NormalTok{]}\OperatorTok{/}\NormalTok{df\_rais\_tic[}\StringTok{\textquotesingle{}f0\_\_y\textquotesingle{}}\NormalTok{]}

\NormalTok{subdet\_output }\OperatorTok{=}\NormalTok{ subdet\_output.merge(df\_rais\_tic, how}\OperatorTok{=}\StringTok{\textquotesingle{}left\textquotesingle{}}\NormalTok{, on}\OperatorTok{=}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{)}
\NormalTok{interesse}\OperatorTok{=}\NormalTok{[}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Patentes\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Tamanho da Indústria Inovadora\textquotesingle{}}\NormalTok{,}
           \StringTok{\textquotesingle{}Tamanho da Indústria Criativa\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Tamanho das Empresas TIC\textquotesingle{}}\NormalTok{]}
\NormalTok{subdet\_output}\OperatorTok{=}\NormalTok{subdet\_output[interesse].set\_index([}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{])}

\CommentTok{\# Tratamentos de para os missing e outliers}
\NormalTok{missing\_data(subdet\_output)}
\NormalTok{extreme\_values(subdet\_output)}

\CommentTok{\# Criando o subdeterminante}
\NormalTok{create\_subindex(subdet\_output, subdet)}
\NormalTok{inovacao[subdet] }\OperatorTok{=}\NormalTok{ subdet\_output}

\CommentTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\# Criando o Determinante Inovação \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\NormalTok{inovacao }\OperatorTok{=}\NormalTok{ pd.concat(inovacao, axis}\OperatorTok{=}\DecValTok{1}\NormalTok{)}
\NormalTok{create\_detindex(inovacao, }\StringTok{\textquotesingle{}Inovação\textquotesingle{}}\NormalTok{)}

\NormalTok{inovacao.to\_csv(}\StringTok{\textquotesingle{}DETERMINANTES/det{-}INOVACAO.csv\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{script_2.6}{%
\subsubsection*{Determinante Capital Humano}\label{script_2.6}}
\addcontentsline{toc}{subsubsection}{Determinante Capital Humano}

\begin{itemize}
\tightlist
\item
  Para retornar ao relatório do Determinante Capital Humano
  \protect\hyperlink{det_capital_humano}{clique aqui}.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Criando o ambiente que criará o determinante}
\NormalTok{capital\_humano }\OperatorTok{=}\NormalTok{ \{\}}
\end{Highlighting}
\end{Shaded}

\hypertarget{script_2.6.1}{%
\paragraph*{Subdeterminante Acesso e Qualidade da Mão de Obra
Básica}\label{script_2.6.1}}
\addcontentsline{toc}{paragraph}{Subdeterminante Acesso e Qualidade da
Mão de Obra Básica}

\begin{itemize}
\tightlist
\item
  Para retornar ao relatório do Subdeterminante Acesso e Qualidade da
  Mão de Obra Básica \protect\hypertarget{subdet_obra_basica}{}{clique
  aqui}
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Indicando o subdeterminante}
\NormalTok{subdet }\OperatorTok{=} \StringTok{\textquotesingle{}Acesso e Qualidade da Mão de Obra Básica\textquotesingle{}}

\CommentTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\# Indicador nota ideb \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\NormalTok{df\_ideb }\OperatorTok{=}\NormalTok{ pd.read\_excel(}\StringTok{\textquotesingle{}Arquivos ICE {-} 23/Ind\_Originais\_ICE\_2022.xlsx\textquotesingle{}}\NormalTok{, header}\OperatorTok{=}\DecValTok{5}\NormalTok{,}
\NormalTok{                        usecols}\OperatorTok{=}\StringTok{"B:C,BA"}\NormalTok{)}
\NormalTok{subdet\_acesso }\OperatorTok{=}\NormalTok{ df\_ideb.rename(columns}\OperatorTok{=}\NormalTok{\{df\_ideb.columns[}\DecValTok{1}\NormalTok{]:}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,}
\NormalTok{                                        df\_ideb.columns[}\DecValTok{2}\NormalTok{]:}\StringTok{\textquotesingle{}Nota do IDEB\textquotesingle{}}\NormalTok{\})}

\NormalTok{subdet\_acesso }\OperatorTok{=}\NormalTok{ subdet\_acesso.merge(amostra, how}\OperatorTok{=}\StringTok{\textquotesingle{}right\textquotesingle{}}\NormalTok{, left\_on}\OperatorTok{=}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,}
\NormalTok{                                    right\_on}\OperatorTok{=}\StringTok{\textquotesingle{}NOME DO MUNICÍPIO\textquotesingle{}}\NormalTok{)}
\NormalTok{subdet\_acesso }\OperatorTok{=}\NormalTok{ subdet\_acesso[[}\StringTok{\textquotesingle{}UF\_x\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Nota do IDEB\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{]]}
\NormalTok{subdet\_acesso }\OperatorTok{=}\NormalTok{ subdet\_acesso.rename(columns}\OperatorTok{=}\NormalTok{\{}\StringTok{\textquotesingle{}UF\_x\textquotesingle{}}\NormalTok{:}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{\})}

\CommentTok{\#\#\#\#\# Indicador proporção de adultos com pelo menos o ensino médio completo \#\#\#\#\#}
\NormalTok{df\_enem }\OperatorTok{=}\NormalTok{ pd.read\_csv(}\StringTok{\textquotesingle{}DETERMINANTE CAPITAL HUMANO/ENEM\_2021\_100mun.csv\textquotesingle{}}\NormalTok{)}
 
\NormalTok{alvo }\OperatorTok{=}\NormalTok{ [}\StringTok{\textquotesingle{}E\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}F\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}M\textquotesingle{}}\NormalTok{]}

\NormalTok{pai\_EM,mae\_EM,num\_inscritos }\OperatorTok{=}\NormalTok{ pd.DataFrame(),pd.DataFrame(),pd.DataFrame()}

\NormalTok{num\_inscritos[}\StringTok{\textquotesingle{}n\_inscritos\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ df\_enem.groupby(}\StringTok{\textquotesingle{}CO\_MUNICIPIO\_ESC\textquotesingle{}}\NormalTok{).size()}
\NormalTok{pai\_EM[}\StringTok{\textquotesingle{}pai\_EM\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ df\_enem[df\_enem[}\StringTok{\textquotesingle{}Q001\textquotesingle{}}\NormalTok{].isin(alvo)].groupby(}\StringTok{\textquotesingle{}CO\_MUNICIPIO\_ESC\textquotesingle{}}\NormalTok{).size()}
\NormalTok{mae\_EM[}\StringTok{\textquotesingle{}mae\_EM\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ df\_enem[df\_enem[}\StringTok{\textquotesingle{}Q002\textquotesingle{}}\NormalTok{].isin(alvo)].groupby(}\StringTok{\textquotesingle{}CO\_MUNICIPIO\_ESC\textquotesingle{}}\NormalTok{).size()}

\NormalTok{pai\_mae\_EM }\OperatorTok{=}\NormalTok{ pai\_EM.merge(mae\_EM, how}\OperatorTok{=}\StringTok{\textquotesingle{}inner\textquotesingle{}}\NormalTok{, on}\OperatorTok{=}\StringTok{\textquotesingle{}CO\_MUNICIPIO\_ESC\textquotesingle{}}\NormalTok{)}
\NormalTok{pai\_mae\_EM }\OperatorTok{=}\NormalTok{ pai\_mae\_EM.merge(num\_inscritos, how}\OperatorTok{=}\StringTok{\textquotesingle{}inner\textquotesingle{}}\NormalTok{, on}\OperatorTok{=}\StringTok{\textquotesingle{}CO\_MUNICIPIO\_ESC\textquotesingle{}}\NormalTok{)}

\NormalTok{pai\_mae\_EM[}\StringTok{\textquotesingle{}prop\_pai\_EM\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ pai\_mae\_EM[}\StringTok{\textquotesingle{}pai\_EM\textquotesingle{}}\NormalTok{]}\OperatorTok{/}\NormalTok{pai\_mae\_EM[}\StringTok{\textquotesingle{}n\_inscritos\textquotesingle{}}\NormalTok{]}
\NormalTok{pai\_mae\_EM[}\StringTok{\textquotesingle{}prop\_mae\_EM\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ pai\_mae\_EM[}\StringTok{\textquotesingle{}mae\_EM\textquotesingle{}}\NormalTok{]}\OperatorTok{/}\NormalTok{pai\_mae\_EM[}\StringTok{\textquotesingle{}n\_inscritos\textquotesingle{}}\NormalTok{]}
\NormalTok{pai\_mae\_EM[}\StringTok{\textquotesingle{}Proporção de Adultos com pelo menos o Ensino Médio Completo\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ (pai\_mae\_EM[}\StringTok{\textquotesingle{}prop\_pai\_EM\textquotesingle{}}\NormalTok{]}\OperatorTok{+}\NormalTok{pai\_mae\_EM[}\StringTok{\textquotesingle{}prop\_mae\_EM\textquotesingle{}}\NormalTok{])}\OperatorTok{/}\DecValTok{2}

\NormalTok{interesse }\OperatorTok{=}\NormalTok{ [}\StringTok{\textquotesingle{}Proporção de Adultos com pelo menos o Ensino Médio Completo\textquotesingle{}}\NormalTok{]}
\NormalTok{pai\_mae\_EM }\OperatorTok{=}\NormalTok{ pai\_mae\_EM[interesse].reset\_index()}
\NormalTok{pai\_mae\_EM[}\StringTok{\textquotesingle{}CO\_MUNICIPIO\_ESC\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ pai\_mae\_EM[}\StringTok{\textquotesingle{}CO\_MUNICIPIO\_ESC\textquotesingle{}}\NormalTok{].astype(}\BuiltInTok{str}\NormalTok{)}

\NormalTok{subdet\_acesso }\OperatorTok{=}\NormalTok{ subdet\_acesso.merge(pai\_mae\_EM, how}\OperatorTok{=}\StringTok{\textquotesingle{}right\textquotesingle{}}\NormalTok{, left\_on}\OperatorTok{=}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{,}
\NormalTok{                                    right\_on}\OperatorTok{=}\StringTok{\textquotesingle{}CO\_MUNICIPIO\_ESC\textquotesingle{}}\NormalTok{)}

\CommentTok{\#\#\#\#\#\#\#\#\#\#\#\#\# Indicador Taxa Líquida de Matrícula no Ensino Médio \#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\CommentTok{\#\#\#\# Pessoas entre 15 e 17 anos no município (população 2010)}
\NormalTok{variaveis }\OperatorTok{=} \StringTok{\textquotesingle{}id\_setor\_censitario, sigla\_uf, v049, v050, v051\textquotesingle{}}
\NormalTok{base }\OperatorTok{=} \StringTok{\textquotesingle{}\textasciigrave{}basedosdados.br\_ibge\_censo\_demografico.setor\_censitario\_idade\_total\_2010\textasciigrave{}\textquotesingle{}}
\NormalTok{project\_id }\OperatorTok{=} \StringTok{\textquotesingle{}double{-}balm{-}306418\textquotesingle{}}
\NormalTok{query }\OperatorTok{=}\NormalTok{ (}\SpecialStringTok{f\textquotesingle{}SELECT }\SpecialCharTok{\{}\NormalTok{variaveis}\SpecialCharTok{\}}\SpecialStringTok{ FROM }\SpecialCharTok{\{}\NormalTok{base}\SpecialCharTok{\}}\SpecialStringTok{\textquotesingle{}}\NormalTok{)}

\NormalTok{df\_censo\_15\_17 }\OperatorTok{=}\NormalTok{ bd.read\_sql(query}\OperatorTok{=}\NormalTok{query, billing\_project\_id}\OperatorTok{=}\NormalTok{project\_id)}
\NormalTok{df\_censo\_15\_17[}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ df\_censo\_15\_17[}\StringTok{\textquotesingle{}id\_setor\_censitario\textquotesingle{}}\NormalTok{].}\BuiltInTok{str}\NormalTok{[:}\DecValTok{7}\NormalTok{]}
\NormalTok{df\_censo\_15\_17[}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ df\_censo\_15\_17[}\StringTok{\textquotesingle{}sigla\_uf\textquotesingle{}}\NormalTok{].}\BuiltInTok{str}\NormalTok{[:}\DecValTok{2}\NormalTok{]}
\NormalTok{df\_censo\_15\_17 }\OperatorTok{=}\NormalTok{ df\_censo\_15\_17.merge(database, how}\OperatorTok{=}\StringTok{\textquotesingle{}right\textquotesingle{}}\NormalTok{, on}\OperatorTok{=}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{)}
\NormalTok{df\_censo\_15\_17 }\OperatorTok{=}\NormalTok{ df\_censo\_15\_17.dropna()}

\NormalTok{df\_censo\_15\_17 }\OperatorTok{=}\NormalTok{ df\_censo\_15\_17.iloc[:,}\DecValTok{2}\NormalTok{:}\DecValTok{7}\NormalTok{].set\_index([}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{])}
\NormalTok{df\_censo\_15\_17.iloc[:,}\DecValTok{0}\NormalTok{:}\DecValTok{3}\NormalTok{] }\OperatorTok{=}\NormalTok{ df\_censo\_15\_17.iloc[:,}\DecValTok{0}\NormalTok{:}\DecValTok{3}\NormalTok{].}\BuiltInTok{apply}\NormalTok{(pd.to\_numeric)}
\NormalTok{df\_censo\_15\_17 }\OperatorTok{=}\NormalTok{ df\_censo\_15\_17.groupby(}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{).}\BuiltInTok{sum}\NormalTok{()}
\NormalTok{df\_censo\_15\_17[}\StringTok{\textquotesingle{}pop\_15\_17\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ df\_censo\_15\_17.}\BuiltInTok{sum}\NormalTok{(axis}\OperatorTok{=}\DecValTok{1}\NormalTok{)}

\CommentTok{\#\#\#\# População 2010}
\NormalTok{variaveis }\OperatorTok{=} \StringTok{\textquotesingle{}id\_municipio, populacao\textquotesingle{}}
\NormalTok{base }\OperatorTok{=} \StringTok{\textquotesingle{}\textasciigrave{}basedosdados.br\_ibge\_populacao.municipio\textasciigrave{}\textquotesingle{}}
\NormalTok{project\_id }\OperatorTok{=} \StringTok{\textquotesingle{}double{-}balm{-}306418\textquotesingle{}}
\NormalTok{cod\_ibge }\OperatorTok{=} \BuiltInTok{tuple}\NormalTok{(database[}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{].astype(}\BuiltInTok{str}\NormalTok{))}
\NormalTok{query }\OperatorTok{=}\NormalTok{ (}\SpecialStringTok{f\textquotesingle{}SELECT }\SpecialCharTok{\{}\NormalTok{variaveis}\SpecialCharTok{\}}\SpecialStringTok{ FROM }\SpecialCharTok{\{}\NormalTok{base}\SpecialCharTok{\}}\SpecialStringTok{ WHERE ano = 2010 AND id\_municipio IN }\SpecialCharTok{\{}\NormalTok{cod\_ibge}\SpecialCharTok{\}}\SpecialStringTok{\textquotesingle{}}\NormalTok{)}

\NormalTok{pop\_2010 }\OperatorTok{=}\NormalTok{ bd.read\_sql(query}\OperatorTok{=}\NormalTok{query, billing\_project\_id}\OperatorTok{=}\NormalTok{project\_id)}
\NormalTok{populacao }\OperatorTok{=}\NormalTok{ pop\_2010.merge(amostra, left\_on}\OperatorTok{=}\StringTok{\textquotesingle{}id\_municipio\textquotesingle{}}\NormalTok{, right\_on}\OperatorTok{=}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{)}
\NormalTok{interesse }\OperatorTok{=}\NormalTok{ [}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}populacao\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}POPULAÇÃO ESTIMADA\textquotesingle{}}\NormalTok{]}
\NormalTok{populacao }\OperatorTok{=}\NormalTok{ populacao[interesse]}
\NormalTok{populacao[}\StringTok{\textquotesingle{}tx\_crecimento\textquotesingle{}}\NormalTok{] }\OperatorTok{=} \DecValTok{1} \OperatorTok{+}\NormalTok{ (populacao[}\StringTok{\textquotesingle{}POPULAÇÃO ESTIMADA\textquotesingle{}}\NormalTok{].astype(}\BuiltInTok{int}\NormalTok{)}\OperatorTok{{-}}\NormalTok{populacao[}\StringTok{\textquotesingle{}populacao\textquotesingle{}}\NormalTok{])}\OperatorTok{/}\NormalTok{populacao[}\StringTok{\textquotesingle{}populacao\textquotesingle{}}\NormalTok{]}

\NormalTok{df\_censo\_15\_17 }\OperatorTok{=}\NormalTok{ df\_censo\_15\_17.merge(populacao, how}\OperatorTok{=}\StringTok{\textquotesingle{}right\textquotesingle{}}\NormalTok{, on}\OperatorTok{=}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{)}
\NormalTok{df\_censo\_15\_17[}\StringTok{\textquotesingle{}pop\_15\_17\_atualizado\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ df\_censo\_15\_17[}\StringTok{\textquotesingle{}pop\_15\_17\textquotesingle{}}\NormalTok{]}\OperatorTok{*}\NormalTok{df\_censo\_15\_17[}\StringTok{\textquotesingle{}tx\_crecimento\textquotesingle{}}\NormalTok{]}

\NormalTok{interesse }\OperatorTok{=}\NormalTok{ [}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}pop\_15\_17\_atualizado\textquotesingle{}}\NormalTok{]}
\NormalTok{df\_censo\_15\_17 }\OperatorTok{=}\NormalTok{ df\_censo\_15\_17[interesse]}

\CommentTok{\#\#\#\# censo escolar população entre 15 e 17 anos}
\NormalTok{df\_ce\_2021 }\OperatorTok{=}\NormalTok{ pd.read\_csv(}\StringTok{\textquotesingle{}DETERMINANTE CAPITAL HUMANO/CE\_2021\_100mun.csv\textquotesingle{}}\NormalTok{,}
\NormalTok{                         sep}\OperatorTok{=}\StringTok{\textquotesingle{},\textquotesingle{}}\NormalTok{, encoding}\OperatorTok{=}\StringTok{\textquotesingle{}latin{-}1\textquotesingle{}}\NormalTok{)}
\NormalTok{df\_ce\_2021 }\OperatorTok{=}\NormalTok{ df\_ce\_2021[[}\StringTok{\textquotesingle{}CO\_MUNICIPIO\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}QT\_MAT\_MED\textquotesingle{}}\NormalTok{]].dropna()}
\NormalTok{df\_ce\_2021 }\OperatorTok{=}\NormalTok{ df\_ce\_2021.groupby(}\StringTok{\textquotesingle{}CO\_MUNICIPIO\textquotesingle{}}\NormalTok{).}\BuiltInTok{sum}\NormalTok{().reset\_index()}
\NormalTok{df\_ce\_2021[}\StringTok{\textquotesingle{}CO\_MUNICIPIO\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ df\_ce\_2021[}\StringTok{\textquotesingle{}CO\_MUNICIPIO\textquotesingle{}}\NormalTok{].astype(}\BuiltInTok{str}\NormalTok{)}

\NormalTok{df\_ce\_2021 }\OperatorTok{=}\NormalTok{ df\_ce\_2021.merge(df\_censo\_15\_17, left\_on}\OperatorTok{=}\StringTok{\textquotesingle{}CO\_MUNICIPIO\textquotesingle{}}\NormalTok{,}
\NormalTok{                              right\_on}\OperatorTok{=}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{)}

\NormalTok{df\_ce\_2021[}\StringTok{\textquotesingle{}Taxa Líquida de Matrícula no Ensino Médio\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ df\_ce\_2021[}\StringTok{\textquotesingle{}QT\_MAT\_MED\textquotesingle{}}\NormalTok{]}\OperatorTok{/}\NormalTok{df\_ce\_2021[}\StringTok{\textquotesingle{}pop\_15\_17\_atualizado\textquotesingle{}}\NormalTok{]}

\NormalTok{interesse }\OperatorTok{=}\NormalTok{ [}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Taxa Líquida de Matrícula no Ensino Médio\textquotesingle{}}\NormalTok{]}
\NormalTok{df\_ce\_2021 }\OperatorTok{=}\NormalTok{ df\_ce\_2021[interesse]}

\NormalTok{subdet\_acesso }\OperatorTok{=}\NormalTok{ subdet\_acesso.merge(df\_ce\_2021, how}\OperatorTok{=}\StringTok{\textquotesingle{}right\textquotesingle{}}\NormalTok{, on}\OperatorTok{=}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{)}

\CommentTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\# Indicador Nota Média no Enem \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\NormalTok{nota\_enem }\OperatorTok{=}\NormalTok{ df\_enem[[}\StringTok{\textquotesingle{}CO\_MUNICIPIO\_ESC\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}NU\_NOTA\_CH\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}NU\_NOTA\_CN\textquotesingle{}}\NormalTok{,}
                     \StringTok{\textquotesingle{}NU\_NOTA\_LC\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}NU\_NOTA\_MT\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}NU\_NOTA\_REDACAO\textquotesingle{}}\NormalTok{]].dropna()}
\NormalTok{nota\_enem }\OperatorTok{=}\NormalTok{ nota\_enem.groupby(}\StringTok{\textquotesingle{}CO\_MUNICIPIO\_ESC\textquotesingle{}}\NormalTok{).mean()}
\NormalTok{nota\_enem[}\StringTok{\textquotesingle{}Nota Média no ENEM\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ nota\_enem.mean(axis}\OperatorTok{=}\DecValTok{1}\NormalTok{)}
\NormalTok{nota\_enem }\OperatorTok{=}\NormalTok{ nota\_enem[}\StringTok{\textquotesingle{}Nota Média no ENEM\textquotesingle{}}\NormalTok{].reset\_index()}
\NormalTok{nota\_enem[}\StringTok{\textquotesingle{}CO\_MUNICIPIO\_ESC\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ nota\_enem[}\StringTok{\textquotesingle{}CO\_MUNICIPIO\_ESC\textquotesingle{}}\NormalTok{].astype(}\BuiltInTok{str}\NormalTok{)}

\NormalTok{subdet\_acesso }\OperatorTok{=}\NormalTok{ subdet\_acesso.merge(nota\_enem, left\_on}\OperatorTok{=}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{, }
\NormalTok{                                    right\_on}\OperatorTok{=}\StringTok{\textquotesingle{}CO\_MUNICIPIO\_ESC\textquotesingle{}}\NormalTok{)}

\CommentTok{\#\# Indicador Proporção de Matriculados no Ensino Técnico e Profissionalizante \#\#}
\CommentTok{\#\#\#\# População maior que 15 anos }
\NormalTok{base }\OperatorTok{=} \StringTok{\textquotesingle{}\textasciigrave{}basedosdados.br\_ibge\_censo\_demografico.setor\_censitario\_idade\_total\_2010\textasciigrave{}\textquotesingle{}}
\NormalTok{project\_id }\OperatorTok{=} \StringTok{\textquotesingle{}double{-}balm{-}306418\textquotesingle{}}
\NormalTok{query }\OperatorTok{=}\NormalTok{ (}\SpecialStringTok{f\textquotesingle{}SELECT * FROM }\SpecialCharTok{\{}\NormalTok{base}\SpecialCharTok{\}}\SpecialStringTok{\textquotesingle{}}\NormalTok{)}

\NormalTok{df\_censo\_15 }\OperatorTok{=}\NormalTok{ bd.read\_sql(query}\OperatorTok{=}\NormalTok{query, billing\_project\_id}\OperatorTok{=}\NormalTok{project\_id)}
\NormalTok{df\_censo\_15[}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ df\_censo\_15[}\StringTok{\textquotesingle{}id\_setor\_censitario\textquotesingle{}}\NormalTok{].}\BuiltInTok{str}\NormalTok{[:}\DecValTok{7}\NormalTok{]}
\NormalTok{df\_censo\_15[}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ df\_censo\_15[}\StringTok{\textquotesingle{}sigla\_uf\textquotesingle{}}\NormalTok{].}\BuiltInTok{str}\NormalTok{[:}\DecValTok{2}\NormalTok{]}
\NormalTok{df\_censo\_15 }\OperatorTok{=}\NormalTok{ df\_censo\_15.set\_index([}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{])}
\NormalTok{df\_censo\_15 }\OperatorTok{=}\NormalTok{ df\_censo\_15.iloc[:,}\DecValTok{50}\NormalTok{:}\DecValTok{137}\NormalTok{].reset\_index()}
\NormalTok{df\_censo\_15 }\OperatorTok{=}\NormalTok{ df\_censo\_15.merge(database, how}\OperatorTok{=}\StringTok{\textquotesingle{}right\textquotesingle{}}\NormalTok{, on}\OperatorTok{=}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{).dropna()}
\NormalTok{df\_censo\_15.iloc[:,}\DecValTok{2}\NormalTok{:}\DecValTok{89}\NormalTok{] }\OperatorTok{=}\NormalTok{ df\_censo\_15.iloc[:,}\DecValTok{2}\NormalTok{:}\DecValTok{89}\NormalTok{].}\BuiltInTok{apply}\NormalTok{(pd.to\_numeric)}
\NormalTok{df\_censo\_15 }\OperatorTok{=}\NormalTok{ df\_censo\_15.groupby(}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{).}\BuiltInTok{sum}\NormalTok{().reset\_index()}
\NormalTok{df\_censo\_15[}\StringTok{\textquotesingle{}pop\_maior\_15\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ df\_censo\_15.}\BuiltInTok{sum}\NormalTok{(axis}\OperatorTok{=}\DecValTok{1}\NormalTok{)}

\NormalTok{interesse}\OperatorTok{=}\NormalTok{[}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}pop\_maior\_15\textquotesingle{}}\NormalTok{]}
\NormalTok{df\_censo\_15 }\OperatorTok{=}\NormalTok{ df\_censo\_15[interesse].merge(populacao, how}\OperatorTok{=}\StringTok{\textquotesingle{}right\textquotesingle{}}\NormalTok{, on}\OperatorTok{=}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{)}
\NormalTok{df\_censo\_15[}\StringTok{\textquotesingle{}atualizada\_pop\_maior\_15\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ df\_censo\_15[}\StringTok{\textquotesingle{}pop\_maior\_15\textquotesingle{}}\NormalTok{]}\OperatorTok{*}\NormalTok{df\_censo\_15[}\StringTok{\textquotesingle{}tx\_crecimento\textquotesingle{}}\NormalTok{]}
\NormalTok{interesse}\OperatorTok{=}\NormalTok{[}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}atualizada\_pop\_maior\_15\textquotesingle{}}\NormalTok{]}
\NormalTok{df\_censo\_15}\OperatorTok{=}\NormalTok{df\_censo\_15[interesse]}

\CommentTok{\#\#\#\# Censo escolar}
\NormalTok{df\_ce\_tec }\OperatorTok{=}\NormalTok{ pd.read\_csv(}\StringTok{\textquotesingle{}DETERMINANTE CAPITAL HUMANO/CE\_2021\_100mun.csv\textquotesingle{}}\NormalTok{,}
\NormalTok{                         sep}\OperatorTok{=}\StringTok{\textquotesingle{},\textquotesingle{}}\NormalTok{, encoding}\OperatorTok{=}\StringTok{\textquotesingle{}latin{-}1\textquotesingle{}}\NormalTok{)}
\NormalTok{df\_ce\_tec }\OperatorTok{=}\NormalTok{ df\_ce\_tec[[}\StringTok{\textquotesingle{}CO\_MUNICIPIO\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}QT\_MAT\_PROF\_TEC\textquotesingle{}}\NormalTok{]].dropna()}
\NormalTok{df\_ce\_tec }\OperatorTok{=}\NormalTok{ df\_ce\_tec.groupby(}\StringTok{\textquotesingle{}CO\_MUNICIPIO\textquotesingle{}}\NormalTok{).}\BuiltInTok{sum}\NormalTok{().reset\_index()}
\NormalTok{df\_ce\_tec[}\StringTok{\textquotesingle{}CO\_MUNICIPIO\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ df\_ce\_tec[}\StringTok{\textquotesingle{}CO\_MUNICIPIO\textquotesingle{}}\NormalTok{].astype(}\BuiltInTok{str}\NormalTok{)}

\NormalTok{df\_ce\_tec }\OperatorTok{=}\NormalTok{ df\_ce\_tec.merge(df\_censo\_15, left\_on}\OperatorTok{=}\StringTok{\textquotesingle{}CO\_MUNICIPIO\textquotesingle{}}\NormalTok{,right\_on}\OperatorTok{=}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{)}

\NormalTok{df\_ce\_tec[}\StringTok{\textquotesingle{}Proporção de Matriculados no Ensino Técnico e Profissionalizante\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ df\_ce\_tec[}\StringTok{\textquotesingle{}QT\_MAT\_PROF\_TEC\textquotesingle{}}\NormalTok{]}\OperatorTok{/}\NormalTok{df\_ce\_tec[}\StringTok{\textquotesingle{}atualizada\_pop\_maior\_15\textquotesingle{}}\NormalTok{]}
\NormalTok{interesse }\OperatorTok{=}\NormalTok{ [}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Proporção de Matriculados no Ensino Técnico e Profissionalizante\textquotesingle{}}\NormalTok{]}
\NormalTok{df\_ce\_tec }\OperatorTok{=}\NormalTok{ df\_ce\_tec[interesse]}

\NormalTok{subdet\_acesso }\OperatorTok{=}\NormalTok{ subdet\_acesso.merge(df\_ce\_tec, how}\OperatorTok{=}\StringTok{\textquotesingle{}right\textquotesingle{}}\NormalTok{, on}\OperatorTok{=}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{)}
\NormalTok{subdet\_acesso }\OperatorTok{=}\NormalTok{ subdet\_acesso.set\_index([}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{])}
\KeywordTok{del}\NormalTok{ subdet\_acesso[}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{]}
\KeywordTok{del}\NormalTok{ subdet\_acesso[}\StringTok{\textquotesingle{}CO\_MUNICIPIO\_ESC\_x\textquotesingle{}}\NormalTok{]}
\KeywordTok{del}\NormalTok{ subdet\_acesso[}\StringTok{\textquotesingle{}CO\_MUNICIPIO\_ESC\_y\textquotesingle{}}\NormalTok{]}

\CommentTok{\# Tratamentos de para os missing e outliers}
\NormalTok{missing\_data(subdet\_acesso)}
\NormalTok{extreme\_values(subdet\_acesso)}

\CommentTok{\# Criando o subdeterminante}
\NormalTok{create\_subindex(subdet\_acesso, subdet)}
\NormalTok{capital\_humano[subdet] }\OperatorTok{=}\NormalTok{ subdet\_acesso}
\end{Highlighting}
\end{Shaded}

\hypertarget{script_2.6.2}{%
\paragraph*{Subdeterminante Acesso e Qualidade da Mão de Obra
Qualificada}\label{script_2.6.2}}
\addcontentsline{toc}{paragraph}{Subdeterminante Acesso e Qualidade da
Mão de Obra Qualificada}

\begin{itemize}
\tightlist
\item
  Para retornar ao relatório do Subdeterminante Acesso e Qualidade da
  Mão de Obra Qualificada
  \protect\hypertarget{subdet_obra_qualificada}{}{clique aqui}
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Indicando o subdeterminante}
\NormalTok{subdet }\OperatorTok{=} \StringTok{\textquotesingle{}Acesso e Qualidade da Mão de Obra Qualificada\textquotesingle{}}

\CommentTok{\#\#\# Indicador Proporção de Adultos com Pelo Menos o Ensino Superior Completo }\AlertTok{\#\#\#}
\NormalTok{alvo }\OperatorTok{=}\NormalTok{ [}\StringTok{\textquotesingle{}F\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}G\textquotesingle{}}\NormalTok{]}
\NormalTok{pai\_SUP,mae\_SUP }\OperatorTok{=}\NormalTok{ pd.DataFrame(),pd.DataFrame()}

\NormalTok{pai\_SUP[}\StringTok{\textquotesingle{}pai\_SUP\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ df\_enem[df\_enem[}\StringTok{\textquotesingle{}Q001\textquotesingle{}}\NormalTok{].isin(alvo)].groupby(}\StringTok{\textquotesingle{}CO\_MUNICIPIO\_ESC\textquotesingle{}}\NormalTok{).size()}
\NormalTok{mae\_SUP[}\StringTok{\textquotesingle{}mae\_SUP\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ df\_enem[df\_enem[}\StringTok{\textquotesingle{}Q002\textquotesingle{}}\NormalTok{].isin(alvo)].groupby(}\StringTok{\textquotesingle{}CO\_MUNICIPIO\_ESC\textquotesingle{}}\NormalTok{).size()}

\NormalTok{pai\_mae\_SUP }\OperatorTok{=}\NormalTok{ pai\_SUP.merge(mae\_SUP, how}\OperatorTok{=}\StringTok{\textquotesingle{}inner\textquotesingle{}}\NormalTok{, on}\OperatorTok{=}\StringTok{\textquotesingle{}CO\_MUNICIPIO\_ESC\textquotesingle{}}\NormalTok{)}
\NormalTok{subdet\_acesso\_quali }\OperatorTok{=}\NormalTok{ pai\_mae\_SUP.merge(num\_inscritos, how}\OperatorTok{=}\StringTok{\textquotesingle{}inner\textquotesingle{}}\NormalTok{, on}\OperatorTok{=}\StringTok{\textquotesingle{}CO\_MUNICIPIO\_ESC\textquotesingle{}}\NormalTok{)}

\NormalTok{subdet\_acesso\_quali[}\StringTok{\textquotesingle{}prop\_pai\_SUP\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ subdet\_acesso\_quali[}\StringTok{\textquotesingle{}pai\_SUP\textquotesingle{}}\NormalTok{]}\OperatorTok{/}\NormalTok{subdet\_acesso\_quali[}\StringTok{\textquotesingle{}n\_inscritos\textquotesingle{}}\NormalTok{]}
\NormalTok{subdet\_acesso\_quali[}\StringTok{\textquotesingle{}prop\_mae\_SUP\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ subdet\_acesso\_quali[}\StringTok{\textquotesingle{}mae\_SUP\textquotesingle{}}\NormalTok{]}\OperatorTok{/}\NormalTok{subdet\_acesso\_quali[}\StringTok{\textquotesingle{}n\_inscritos\textquotesingle{}}\NormalTok{]}
\NormalTok{subdet\_acesso\_quali[}\StringTok{\textquotesingle{}Proporção de Adultos com pelo menos os Ensino Superior Completo\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ (subdet\_acesso\_quali[}\StringTok{\textquotesingle{}prop\_pai\_SUP\textquotesingle{}}\NormalTok{]}\OperatorTok{+}\NormalTok{subdet\_acesso\_quali[}\StringTok{\textquotesingle{}prop\_mae\_SUP\textquotesingle{}}\NormalTok{])}\OperatorTok{/}\DecValTok{2}
\NormalTok{subdet\_acesso\_quali }\OperatorTok{=}\NormalTok{ subdet\_acesso\_quali[}\StringTok{\textquotesingle{}Proporção de Adultos com pelo menos os Ensino Superior Completo\textquotesingle{}}\NormalTok{].reset\_index()}

\CommentTok{\#\#\#\#\# Indicador Proporção de Alunos Concluintes em Cursos de Alta Qualidade \#\#\#\#\#}
\NormalTok{df\_enade }\OperatorTok{=}\NormalTok{ pd.read\_excel(}\StringTok{\textquotesingle{}Arquivos ICE {-} 23/Ind\_Originais\_ICE\_2022.xlsx\textquotesingle{}}\NormalTok{, header}\OperatorTok{=}\DecValTok{5}\NormalTok{,}
\NormalTok{                        usecols}\OperatorTok{=}\StringTok{"B:C,BH"}\NormalTok{)}
\NormalTok{df\_enade }\OperatorTok{=}\NormalTok{ df\_enade.rename(columns}\OperatorTok{=}\NormalTok{\{df\_enade.columns[}\DecValTok{2}\NormalTok{]:}\StringTok{\textquotesingle{}Proporção de Alunos Concluintes em Cursos de Alta Qualidade\textquotesingle{}}\NormalTok{\})}
\NormalTok{df\_enade }\OperatorTok{=}\NormalTok{ df\_enade.merge(amostra, how}\OperatorTok{=}\StringTok{\textquotesingle{}right\textquotesingle{}}\NormalTok{, left\_on}\OperatorTok{=}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,right\_on}\OperatorTok{=}\StringTok{\textquotesingle{}NOME DO MUNICÍPIO\textquotesingle{}}\NormalTok{)}
\NormalTok{df\_enade }\OperatorTok{=}\NormalTok{ df\_enade[[}\StringTok{\textquotesingle{}UF\_x\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Proporção de Alunos Concluintes em Cursos de Alta Qualidade\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{]]}
\NormalTok{df\_enade }\OperatorTok{=}\NormalTok{ df\_enade.rename(columns}\OperatorTok{=}\NormalTok{\{}\StringTok{\textquotesingle{}UF\_x\textquotesingle{}}\NormalTok{:}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{\})}

\NormalTok{subdet\_acesso\_quali[}\StringTok{\textquotesingle{}CO\_MUNICIPIO\_ESC\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ subdet\_acesso\_quali[}\StringTok{\textquotesingle{}CO\_MUNICIPIO\_ESC\textquotesingle{}}\NormalTok{].astype(}\BuiltInTok{str}\NormalTok{)}
\NormalTok{subdet\_acesso\_quali }\OperatorTok{=}\NormalTok{ subdet\_acesso\_quali.merge(df\_enade, right\_on}\OperatorTok{=}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{,}
\NormalTok{                                                left\_on}\OperatorTok{=}\StringTok{\textquotesingle{}CO\_MUNICIPIO\_ESC\textquotesingle{}}\NormalTok{)}
\NormalTok{order }\OperatorTok{=}\NormalTok{ [}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Proporção de Adultos com pelo menos os Ensino Superior Completo\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}Proporção de Alunos Concluintes em Cursos de Alta Qualidade\textquotesingle{}}\NormalTok{]}
\NormalTok{subdet\_acesso\_quali }\OperatorTok{=}\NormalTok{ subdet\_acesso\_quali[order]}

\CommentTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\# Indicador Custo Médio de Salários de Dirigentes \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\NormalTok{cbo\_2002 }\OperatorTok{=} \BuiltInTok{tuple}\NormalTok{([}\StringTok{\textquotesingle{}121005\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}121010\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}122105\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}122110\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}122115\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}122120\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}122205\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}122305\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}122405\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}122505\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}122510\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}122515\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}122520\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}122605\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}122610\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}122615\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}122620\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}122705\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}122710\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}122715\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}122720\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}122725\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}122730\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}122735\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}122740\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}122745\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}122750\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}122755\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}123105\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}123110\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}123115\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}123205\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}123210\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}123305\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}123310\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}123405\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}123410\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}123605\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}123705\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}123805\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}131105\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}131110\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}131115\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}131120\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}131205\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}131210\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}131215\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}131220\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}131225\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}131305\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}131310\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}131315\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}131320\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}141105\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}141110\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}141115\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}141120\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}141205\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}141305\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}141405\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}141410\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}141415\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}141420\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}141505\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}141510\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}141515\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}141520\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}141525\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}141605\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}141610\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}141615\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}141705\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}141710\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}141715\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}141720\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}141725\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}141730\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}141735\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}141805\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}141810\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}141815\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}141820\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}141825\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}141830\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}142105\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}142110\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}142115\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}142120\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}142125\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}142130\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}142205\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}142210\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}142305\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}142310\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}142315\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}142320\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}142325\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}142330\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}142335\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}142340\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}142345\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}142350\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}142405\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}142410\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}142415\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}142505\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}142510\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}142515\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}142520\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}142525\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}142530\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}142535\textquotesingle{}}\NormalTok{,}
                  \StringTok{\textquotesingle{}142605\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}142610\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}142705\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}142710\textquotesingle{}}\NormalTok{])}

\NormalTok{variaveis }\OperatorTok{=} \StringTok{\textquotesingle{}valor\_remuneracao\_media,id\_municipio\textquotesingle{}}
\NormalTok{base }\OperatorTok{=} \StringTok{\textquotesingle{}\textasciigrave{}basedosdados.br\_me\_rais.microdados\_vinculos\textasciigrave{}\textquotesingle{}}
\NormalTok{project\_id }\OperatorTok{=} \StringTok{\textquotesingle{}double{-}balm{-}306418\textquotesingle{}}
\NormalTok{cod\_ibge }\OperatorTok{=} \BuiltInTok{tuple}\NormalTok{(database[}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{].astype(}\BuiltInTok{str}\NormalTok{))}
\NormalTok{query }\OperatorTok{=}\NormalTok{ (}\SpecialStringTok{f\textquotesingle{}SELECT }\SpecialCharTok{\{}\NormalTok{variaveis}\SpecialCharTok{\}}\SpecialStringTok{ FROM }\SpecialCharTok{\{}\NormalTok{base}\SpecialCharTok{\}}\SpecialStringTok{ WHERE ano = 2019 AND cbo\_2002 IN }\SpecialCharTok{\{}\NormalTok{cbo\_2002}\SpecialCharTok{\}}\SpecialStringTok{\textquotesingle{}}
         \SpecialStringTok{f\textquotesingle{} AND id\_municipio IN }\SpecialCharTok{\{}\NormalTok{cod\_ibge}\SpecialCharTok{\}}\SpecialStringTok{\textquotesingle{}}\NormalTok{)}

\NormalTok{df\_rais }\OperatorTok{=}\NormalTok{ bd.read\_sql(query}\OperatorTok{=}\NormalTok{query, billing\_project\_id}\OperatorTok{=}\NormalTok{project\_id)}
\NormalTok{df\_rais }\OperatorTok{=}\NormalTok{ df\_rais.groupby(}\StringTok{\textquotesingle{}id\_municipio\textquotesingle{}}\NormalTok{).agg([}\StringTok{\textquotesingle{}count\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}sum\textquotesingle{}}\NormalTok{])}
\NormalTok{df\_rais[}\StringTok{\textquotesingle{}Custo Médio de Salários de Dirigentes\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ df\_rais.iloc[:,}\DecValTok{1}\NormalTok{]}\OperatorTok{/}\NormalTok{df\_rais.iloc[:,}\DecValTok{0}\NormalTok{] }
\NormalTok{interesse }\OperatorTok{=}\NormalTok{ [}\StringTok{\textquotesingle{}Custo Médio de Salários de Dirigentes\textquotesingle{}}\NormalTok{]}
\NormalTok{df\_rais }\OperatorTok{=}\NormalTok{ df\_rais[interesse].reset\_index().droplevel(level}\OperatorTok{=}\DecValTok{1}\NormalTok{, axis}\OperatorTok{=}\DecValTok{1}\NormalTok{)}
\NormalTok{df\_rais[}\StringTok{\textquotesingle{}Custo Médio de Salários de Dirigentes\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ negative(df\_rais[}\StringTok{\textquotesingle{}Custo Médio de Salários de Dirigentes\textquotesingle{}}\NormalTok{])}

\NormalTok{subdet\_acesso\_quali }\OperatorTok{=}\NormalTok{ subdet\_acesso\_quali.merge(df\_rais, right\_on}\OperatorTok{=}\StringTok{\textquotesingle{}id\_municipio\textquotesingle{}}\NormalTok{,}
\NormalTok{                                                left\_on}\OperatorTok{=}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{)}
\NormalTok{subdet\_acesso\_quali }\OperatorTok{=}\NormalTok{ subdet\_acesso\_quali.set\_index([}\StringTok{\textquotesingle{}Município\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}UF\textquotesingle{}}\NormalTok{])}
\KeywordTok{del}\NormalTok{ subdet\_acesso\_quali[}\StringTok{\textquotesingle{}Cod.IBGE\textquotesingle{}}\NormalTok{]}
\KeywordTok{del}\NormalTok{ subdet\_acesso\_quali[}\StringTok{\textquotesingle{}id\_municipio\textquotesingle{}}\NormalTok{]}

\CommentTok{\# Tratamentos de para os missing e outliers}
\NormalTok{missing\_data(subdet\_acesso\_quali)}
\NormalTok{extreme\_values(subdet\_acesso\_quali)}

\CommentTok{\# Criando o subdeterminante}
\NormalTok{create\_subindex(subdet\_acesso\_quali, subdet)}
\NormalTok{capital\_humano[subdet] }\OperatorTok{=}\NormalTok{ subdet\_acesso\_quali}

\CommentTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\# Criando o determinante de Ambiente Regulatório \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\NormalTok{capital\_humano }\OperatorTok{=}\NormalTok{ pd.concat(capital\_humano, axis}\OperatorTok{=}\DecValTok{1}\NormalTok{)}
\NormalTok{create\_detindex(capital\_humano, }\StringTok{\textquotesingle{}Capital Humano\textquotesingle{}}\NormalTok{)}

\NormalTok{capital\_humano.to\_csv(}\StringTok{\textquotesingle{}DETERMINANTES/det{-}CAPITAL HUMANO.csv\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{script_2.7}{%
\subsubsection*{Determinante Cultura}\label{script_2.7}}
\addcontentsline{toc}{subsubsection}{Determinante Cultura}

\end{document}
