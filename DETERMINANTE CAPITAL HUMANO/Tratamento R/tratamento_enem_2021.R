library(data.table)
library(tidyverse)

enem_2021 <- data.table::fread("C:/Users/cesar.albuquerque/Desktop/TCC/Aplicações no R/MICRODADOS_ENEM_2021.csv")

enem_2021_lim <- enem_2021 %>%
  select(NU_INSCRICAO, CO_MUNICIPIO_ESC, TP_ST_CONCLUSAO, TP_ENSINO, NU_NOTA_CH, 
         NU_NOTA_CN, NU_NOTA_LC, NU_NOTA_MT, NU_NOTA_REDACAO, Q001, Q002)

cod_100_mun <- c(
  "3550308","3304557","5300108","2927408","2304400","3106200","1302603","4106902",
  "2611606","5208707","1501402","4314902","3518800","3509502","2111300","3304904",
  "2704302","3301702","5002704","2408102","2211001","3548708","2507507","3303500",
  "3549904","3547809","3543402","2607901","3170206","3534401","3552205","3118601",
  "2800308","2910800","5103403","4209102","5201405","4113700","3136702","1100205",
  "1500800","3205002","4305108","1600303","3303302","4205407","3300456","3301009",
  "3205200","3529401","3305109","3549805","3530607","3106705","1400100","4115200",
  "3548500","3513801","3525904","1200401","3143302","2504009","3538709","3510609",
  "5201108","2609600","3201308","3506003","3523107","3551009","3205309","2604106",
  "2303709","4202404","2611101","4119905","3516200","4304606","4314407","2933307",
  "3154606","3170107","2610707","3541000","4104808","4125506","3518701","3554102",
  "1721000","3526902","2905701","1506807","3303906","2408003","3552502","3552809",
  "5108402","3552403","1504208","4309209","4316907"
  )

enem_2021_lim_100 <- enem_2021_lim %>%
  filter(CO_MUNICIPIO_ESC %in% cod_100_mun)
  

write.csv(enem_2021_lim_100, "ENEM_2021_100mun.csv")
